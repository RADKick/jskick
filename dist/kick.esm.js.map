{"version":3,"file":"kick.esm.js","sources":["../src/constants.js","../src/parsers.js","../src/kick.js","../src/observer.js","../src/bindings.js","../src/view.js","../src/adapter.js","../src/binders.js","../src/export.js"],"sourcesContent":["export const OPTIONS = [\n  //'prefix',\n  'templateDelimiters',\n  'rootInterface',\n  'preloadData',\n  'handler'\n]\n\nexport const EXTENSIONS = [\n  'binders',\n  'formatters',\n  'components',\n  'adapters'\n]","const PRIMITIVE = 0;\nconst KEYPATH = 1;\nconst TEXT = 0;\nconst BINDING = 1;\n\nconst QUOTED_STR = /^'.*'$|^\".*\"$/;\nconst WHITESPACES = ' \\n\\r\\t'.split('');\n\n// Parser and tokenizer for getting the type and value from a string.\nexport function parseType(string) {\n  let type = PRIMITIVE;\n  let value = string;\n\n  if (QUOTED_STR.test(string)) {\n    value = string.slice(1, -1);\n  } else if (string === \"true\") {\n    value = true;\n  } else if (string === \"false\") {\n    value = false;\n  } else if (string === \"null\") {\n    value = null;\n  } else if (string === \"undefined\") {\n    value = undefined;\n  } else if (!isNaN(string)) {\n    value = Number(string);\n  } else {\n    type = KEYPATH;\n  }\n\n  return { type: type, value: value };\n}\n\n// Template parser and tokenizer for mustache-style text content bindings.\n// Parses the template and returns a set of tokens, separating static portions\n// of text from binding declarations.\nexport function parseTemplate(template, delimiters) {\n  var tokens;\n  let length = template.length;\n  let index = 0;\n  let lastIndex = 0;\n  let open = delimiters[0],\n    close = delimiters[1];\n\n  while (lastIndex < length) {\n    index = template.indexOf(open, lastIndex);\n\n    if (index < 0) {\n      if (tokens) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex)\n        });\n      }\n\n      break;\n    } else {\n      tokens || (tokens = []);\n      if (index > 0 && lastIndex < index) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex, index)\n        });\n      }\n\n      lastIndex = index + open.length;\n      index = template.indexOf(close, lastIndex);\n\n      if (index < 0) {\n        let substring = template.slice(lastIndex - close.length);\n        let lastToken = tokens[tokens.length - 1];\n\n        if (lastToken && lastToken.type === TEXT) {\n          lastToken.value += substring;\n        } else {\n          tokens.push({\n            type: TEXT,\n            value: substring\n          });\n        }\n\n        break;\n      }\n\n      let value = template.slice(lastIndex, index).trim();\n\n      tokens.push({\n        type: BINDING,\n        value: value\n      });\n\n      lastIndex = index + close.length;\n    }\n  }\n\n  return tokens;\n}\n\nexport function parseFnExpr(expr) {\n  function jsNested(statement) {\n    var regex = new RegExp(\"([a-zA-Z0-9_$]+)\\\\((.*)\\\\)\", \"g\");\n    var root = { _: [] };\n\n    if (QUOTED_STR.test(statement)) {\n      root._.push({ k: statement, t: \"l\" });\n      return root;\n    }\n\n    var r = regex.exec(statement);\n    if (!r || r.length < 3) {\n      return root;\n    }\n    var parameters = args(r[2]);\n    var node = { _: [] };\n    parameters.forEach(function(p) {\n      if (p.e) {\n        if (p.e.indexOf(\"(\") == -1) {\n          node._.push({ k: p.e, t: \"p\" });\n        } else {\n          var wrappedNode = jsNested(p.e),\n            k;\n          for (k in wrappedNode) {\n            node._.push(wrappedNode[k][0]);\n          }\n        }\n      } else {\n        //node[p.s] = p.s;\n      }\n    });\n\n    // Assign node to the node's identifier\n    root._.push({ k: r[1], t: 'f', _: node._ });\n    //root._.push(r[1]:node);\n    return root;\n  }\n\n  function args(statement) {\n    statement += \",\"; // so I don't have to handle the \"last, leftover parameter\"\n    var results = [];\n    var chars = statement.split(\"\");\n    var level = 0; // levels of parenthesis, used to track how deep I am in ().\n    var index = 0; // determines which parameter am I currently on.\n    var temp = \"\", match = '', temp2 = '';\n    chars.forEach(function(char) {\n      switch (true) {\n        case char === \"'\":\n        case char === '\"':\n          if (match.length && match === char) {\n            temp += match + temp2 + match;\n            results[index] = { s: temp2 };\n            match = temp2 = '';\n            //level--;\n            //temp = '';\n            index++;\n          } else {\n            match = char;\n            //level++;\n          }\n          //level++;\n          break;\n        case !match.length && WHITESPACES.indexOf(char) !== -1:\n          break;\n        case !match.length && char === '(':\n          temp += char;\n          level++;\n          break;\n        case !match.length && char === ')':\n          temp += char;\n          level--;\n          break;\n        case !match.length && char === ',':\n          // if the comma is between a set of parenthesis, ignore.\n          if (level !== 0) {\n            temp += char;\n          }\n          // if the comma is external, split the string.\n          else {\n            results[index] = { e: temp };\n            temp = '';\n            index++;\n          }\n          break;\n        default:\n          if (match.length) {\n            temp2 += char;\n          } else {\n            temp += char;\n          }\n          break;\n      }\n    });\n    return results;\n  }\n\n  //return if we were able to parse functions otherwise it will be null\n  return jsNested(expr)._[0] || null;\n}\n","import {EXTENSIONS} from './constants'\nimport {parseTemplate, parseType} from './parsers'\n\nconst kick = {\n  // Global binders.\n  binders: {},\n\n  // Global formatters.\n  formatters: {},\n\n  // Global components.\n  components: {},\n\n  // Global sightglass adapters.\n  adapters: {},\n\n  /*\n  // Default attribute prefix.\n  _prefix: 'rv',\n\n  _fullPrefix: 'rv-',\n\n  /* get prefix () {\n    return this._prefix\n  },\n\n  set prefix (value) {\n    this._prefix = value\n    this._fullPrefix = value + '-'\n  }, */\n\n  parseTemplate: parseTemplate,\n\n  parseType: parseType,\n\n  // Default template delimiters.\n  templateDelimiters: ['{{', '}}'],\n\n  // Binder shortcuts - extend it if you want to have your own\n  // else if(nodeName === '?') {nodeName = 'if';}\n\n  binderMap: {\n    '^': '^click',\n    '^^': '^dblclick',\n    '^_': '^contextmenu',\n    '^@': '^change',\n    '^+': '^focus',\n    '^-': '^blur',\n    '@': '@value',\n    '@x': '@checked',\n    ':' : ':text',\n    '::' : ':html',\n    '$' : ':html',\n    '+': ':show',\n    '-': ':hide',\n    '~': ':disabled',\n    '~~': ':enabled'\n    },\n    // was starBinder in rivetsjs, in kickjs *(star) is used for binding so changing it to varBinder as an variable binder\n    varBinderMap: {\n      '.&': ':class-&',\n      '..&': ':style-&',\n      '::&': ':attr-&',\n    },\n  // Default sightglass root interface.\n  rootInterface: '.',\n\n  // Preload data by default.\n  preloadData: true,\n\n  // Default event handler.\n  handler: function(context, ev, binding) {\n    //changing the order of returns as well as passed arguments first then $event\n    //todo document this breakig change\n    const processedArgs = binding.parseFormatterArguments(binding.fnArgs, 0);\n    this.call(context, ...[...processedArgs, binding.view.models, ev])\n  },\n\n  // Sets the attribute on the element. If no binder above is matched it will fall\n  // back to using this binder.\n  fallbackBinder: function(el, value) {\n    if (value != null) {\n      el.setAttribute(this.type, value)\n    } else {\n      el.removeAttribute(this.type)\n    }\n  },\n\n  // Merges an object literal into the corresponding global options.\n  configure: function(options) {\n    if (!options) {\n      return\n    }\n    Object.keys(options).forEach(option => {\n      let value = options[option]\n\n      if (EXTENSIONS.indexOf(option) > -1) {\n        Object.keys(value).forEach(key => {\n          this[option][key] = value[key]\n        })\n      } else {\n        this[option] = value\n      }\n    })\n  },\n\n  router:{}\n}\n\nexport default kick\n","\n// Check if a value is an object than can be observed.\nfunction isObject(obj) {\n  return typeof obj === 'object' && obj !== null\n}\n\n// Error thrower.\nfunction error(message) {\n  throw new Error('[Observer] ' + message)\n}\n\nvar adapters\nvar interfaces\nvar rootInterface\n\n// Constructs a new keypath observer and kicks things off.\nfunction Observer(obj, keypath, callback) {\n  this.keypath = keypath\n  this.callback = callback\n  this.objectPath = []\n  this.parse()\n  this.obj = this.getRootObject(obj)\n\n  if (isObject(this.target = this.realize())) {\n    this.set(true, this.key, this.target, this.callback)\n  }\n}\n\nObserver.updateOptions = function(options) {\n  adapters = options.adapters\n  interfaces = Object.keys(adapters)\n  rootInterface = options.rootInterface\n}\n\n// Tokenizes the provided keypath string into interface + path tokens for the\n// observer to work with.\nObserver.tokenize = function(keypath, root) {\n  var tokens = []\n  var current = {i: root, path: ''}\n  var index, chr\n\n  for (index = 0; index < keypath.length; index++) {\n    chr = keypath.charAt(index)\n\n    if (!!~interfaces.indexOf(chr)) {\n      tokens.push(current)\n      current = {i: chr, path: ''}\n    } else {\n      current.path += chr\n    }\n  }\n\n  tokens.push(current)\n  return tokens\n}\n\n// Parses the keypath using the interfaces defined on the view. Sets variables\n// for the tokenized keypath as well as the end key.\nObserver.prototype.parse = function() {\n  var path, root\n\n  if (!interfaces.length) {\n    error('Must define at least one adapter interface.')\n  }\n\n  if (!!~interfaces.indexOf(this.keypath[0])) {\n    root = this.keypath[0]\n    path = this.keypath.substr(1)\n  } else {\n    root = rootInterface\n    path = this.keypath\n  }\n\n  this.tokens = Observer.tokenize(path, root)\n  this.key = this.tokens.pop()\n}\n\n// Realizes the full keypath, attaching observers for every key and correcting\n// old observers to any changed objects in the keypath.\nObserver.prototype.realize = function() {\n  var current = this.obj\n  var unreached = -1\n  var prev\n  var token\n\n  for (let index = 0; index < this.tokens.length; index++) {\n    token = this.tokens[index]\n    if (isObject(current)) {\n      if (typeof this.objectPath[index] !== 'undefined') {\n        if (current !== (prev = this.objectPath[index])) {\n          this.set(false, token, prev, this)\n          this.set(true, token, current, this)\n          this.objectPath[index] = current\n        }\n      } else {\n        this.set(true, token, current, this)\n        this.objectPath[index] = current\n      }\n\n      current = this.get(token, current)\n    } else {\n      if (unreached === -1) {\n        unreached = index\n      }\n\n      if (prev = this.objectPath[index]) {\n        this.set(false, token, prev, this)\n      }\n    }\n  }\n\n  if (unreached !== -1) {\n    this.objectPath.splice(unreached)\n  }\n\n  return current\n}\n\n// Updates the keypath. This is called when any intermediary key is changed.\nObserver.prototype.sync = function() {\n  var next, oldValue, newValue\n\n  if ((next = this.realize()) !== this.target) {\n    if (isObject(this.target)) {\n      this.set(false, this.key, this.target, this.callback)\n    }\n\n    if (isObject(next)) {\n      this.set(true, this.key, next, this.callback)\n    }\n\n    oldValue = this.value()\n    this.target = next\n    newValue = this.value()\n    if (newValue !== oldValue || newValue instanceof Function) this.callback.sync()\n  } else if (next instanceof Array) {\n    this.callback.sync()\n  }\n}\n\n// Reads the current end value of the observed keypath. Returns undefined if\n// the full keypath is unreachable.\nObserver.prototype.value = function() {\n  if (isObject(this.target)) {\n    return this.get(this.key, this.target)\n  }\n}\n\n// Sets the current end value of the observed keypath. Calling setValue when\n// the full keypath is unreachable is a no-op.\nObserver.prototype.setValue = function(value) {\n  if (isObject(this.target)) {\n    adapters[this.key.i].set(this.target, this.key.path, value)\n  }\n}\n\n// Gets the provided key on an object.\nObserver.prototype.get = function(key, obj) {\n  return adapters[key.i].get(obj, key.path)\n}\n\n// Observes or unobserves a callback on the object using the provided key.\nObserver.prototype.set = function(active, key, obj, callback) {\n  var action = active ? 'observe' : 'unobserve'\n  adapters[key.i][action](obj, key.path, callback)\n}\n\n\n// Unobserves the entire keypath.\nObserver.prototype.unobserve = function() {\n  var obj\n  var token\n\n  for (let index = 0; index < this.tokens.length; index++) {\n    token = this.tokens[index]\n    if (obj = this.objectPath[index]) {\n      this.set(false, token, obj, this)\n    }\n  }\n\n  if (isObject(this.target)) {\n    this.set(false, this.key, this.target, this.callback)\n  }\n}\n// traverse the scope chain to find the scope which has the root property\n// if the property is not found in chain, returns the root scope\nObserver.prototype.getRootObject = function (obj) {\n  var rootProp, current;\n  if (!obj.$parent) {\n    return obj;\n  }\n\n  if (this.tokens.length) {\n    rootProp = this.tokens[0].path\n  } else {\n    rootProp = this.key.path\n  }\n\n  current = obj;\n  while (current.$parent && (current[rootProp] === undefined)) {\n    current = current.$parent\n  }\n\n  return current;\n}\n\nexport default Observer\n","import { parseType, parseFnExpr } from \"./parsers\";\nimport Observer from \"./observer\";\nimport kick from './kick';\n\nfunction getInputValue(el) {\n  let results = [];\n  if (el.type === \"checkbox\") {\n    return el.checked;\n  } else if (el.type === \"select-multiple\") {\n    el.options.forEach(option => {\n      if (option.selected) {\n        results.push(option.value);\n      }\n    });\n\n    return results;\n  } else {\n    return el.value;\n  }\n}\n\nconst FORMATTER_ARGS = /[^\\s']+|'([^']|'[^\\s])*'|\"([^\"]|\"[^\\s])*\"/g;\nconst FORMATTER_SPLIT = /\\s+/;\nconst FN_CHECK = /\\(.*\\)/;\n\n// A single binding between a model attribute and a DOM element.\nexport class Binding {\n  // All information about the binding is passed into the constructor; the\n  // containing view, the DOM node, the type of binding, the model object and the\n  // keypath at which to listen for changes.\n  constructor(view, el, type, keypath, binder, arg, formatters) {\n    this.view = view;\n    this.el = el;\n    this.type = type;\n    this.keypath = keypath;\n    this.binder = binder;\n    this.arg = arg;\n    this.formatters = formatters;\n    this.formatterObservers = {};\n    this.model = undefined;\n\n    //new property in kick for fn args but not sure if this is the right way\n    this.fnArgs = [];\n    //new property in kick for subscribers to get notified if value is changing specifically for jquery plugins\n    this.subscribers = [];\n    //new property in kick for locking to avoid loops of updates, specifically for jquery plugins\n    this.locked = false;\n    // add object to hold listners so that they can be unbinded later\n    this.listeners = {};\n  }\n\n  // Observes the object keypath\n  observe(obj, keypath) {\n    return new Observer(obj, keypath, this);\n  }\n\n  parseTarget() {\n    if (this.keypath) {\n      let token = parseType(this.keypath);\n\n      if (token.type === 0) {\n        this.value = token.value;\n      } else {\n        if (FN_CHECK.test(this.keypath)) {\n          let fnExpr = parseFnExpr(this.keypath);\n          if (fnExpr) {\n            this.keypath = fnExpr.k;\n            this.fnArgs = fnExpr._.map(x => x.k);\n            //let fnArgs = fnExpr._.map(x => x.k)\n            //this.fnArgs = this.parseFormatterArguments(fnArgs, 0)\n          }\n        }\n        this.observer = this.observe(this.view.models, this.keypath);\n        this.model = this.observer.target;\n      }\n    } else {\n      this.value = undefined;\n    }\n  }\n\n  parseFormatterArguments(args, formatterIndex) {\n    return args.map(parseType).map(({ type, value }, ai) => {\n      if (type === 0) {\n        return value;\n      } else {\n        if (!this.formatterObservers[formatterIndex]) {\n          this.formatterObservers[formatterIndex] = {};\n        }\n\n        let observer = this.formatterObservers[formatterIndex][ai];\n\n        if (!observer) {\n          observer = this.observe(this.view.models, value);\n          this.formatterObservers[formatterIndex][ai] = observer;\n        }\n\n        return observer.value();\n      }\n    });\n  }\n\n  // Applies all the current formatters to the supplied value and returns the\n  // formatted value.\n  formattedValue(value) {\n    return this.formatters.reduce((result, declaration, index) => {\n      let args = declaration.match(FORMATTER_ARGS);\n      let id = args.shift();\n      let formatter = this.view.options.formatters[id];\n\n      const processedArgs = this.parseFormatterArguments(args, index);\n\n      if (formatter && formatter.read instanceof Function) {\n        result = formatter.read(result, ...processedArgs);\n      } else if (formatter instanceof Function) {\n        result = formatter(result, ...processedArgs);\n      }\n      return result;\n    }, value);\n  }\n\n  // Returns an event handler for the binding around the supplied function.\n  eventHandler(fn) {\n    let binding = this;\n    let handler = binding.view.options.handler;\n\n    return function(ev) {\n      handler.call(fn, this, ev, binding);\n    };\n  }\n\n  // Sets the value for the binding. This Basically just runs the binding routine\n  // with the supplied value formatted.\n  set(value) {\n    if (value instanceof Function && !this.binder.function) {\n      //todo update docs, probably a breaking change\n      const processedArgs = this.parseFormatterArguments(this.fnArgs, 0);\n      value = this.formattedValue(\n        value.call(this.model, ...[...processedArgs, this.view.models])\n      );\n      //value = this.formattedValue(value.call(this.model))\n    } else {\n      value = this.formattedValue(value);\n    }\n\n    let routineFn = this.binder.routine || this.binder;\n\n    if (routineFn instanceof Function) {\n      routineFn.call(this, this.el, value);\n      this.callSubscribers(value);\n    }\n  }\n\n  // Syncs up the view binding with the model.\n  sync() {\n    if (this.observer) {\n      this.model = this.observer.target;\n      this.set(this.observer.value());\n    } else {\n      this.set(this.value);\n    }\n  }\n\n  // Publishes the value currently set on the input element back to the model.\n  publish() {\n    if (this.observer) {\n      var value = this.formatters.reduceRight((result, declaration, index) => {\n        const args = declaration.split(FORMATTER_SPLIT);\n        const id = args.shift();\n        const formatter = this.view.options.formatters[id];\n        const processedArgs = this.parseFormatterArguments(args, index);\n\n        if (formatter && formatter.publish) {\n          result = formatter.publish(result, ...processedArgs);\n        }\n        return result;\n      }, this.getValue(this.el));\n\n      this.observer.setValue(value);\n    }\n  }\n\n  // Subscribes to the model for changes at the specified keypath. Bi-directional\n  // routines will also listen for changes on the element to propagate them back\n  // to the model.\n  bind() {\n    this.parseTarget();\n\n    if (this.binder.hasOwnProperty(\"bind\")) {\n      this.binder.bind.call(this, this.el);\n    }\n\n    if (this.view.options.preloadData) {\n      this.sync();\n    }\n  }\n\n  // Unsubscribes from the model and the element.\n  unbind() {\n    if (this.binder.unbind) {\n      this.binder.unbind.call(this, this.el);\n    }\n\n    if (this.observer) {\n      this.observer.unobserve();\n    }\n\n    Object.keys(this.formatterObservers).forEach(fi => {\n      let args = this.formatterObservers[fi];\n\n      Object.keys(args).forEach(ai => {\n        args[ai].unobserve();\n      });\n    });\n\n    this.formatterObservers = {};\n  }\n\n  // Updates the binding's model from what is currently set on the view. Unbinds\n  // the old model first and then re-binds with the new model.\n  update(models = {}) {\n    if (this.observer) {\n      this.model = this.observer.target;\n    }\n\n    if (this.binder.update) {\n      this.binder.update.call(this, models);\n    }\n  }\n\n  // Returns elements value\n  getValue(el) {\n    if (this.binder && this.binder.getValue) {\n      return this.binder.getValue.call(this, el);\n    } else {\n      return getInputValue(el);\n    }\n  }\n\n  // Subscribe to the value changes\n  subscribe(listener) {\n    var index = this.subscribers.push(listener) -1;\n\n    // Provide handle back for removal of listener\n    return {\n      remove: function() {\n        delete this.subscribers[index];\n      }\n    };\n  }\n\n  // Call the subscribers\n  callSubscribers(value){\n      // Cycle through subscribers queue, fire!\n      this.subscribers.forEach(function(item) {\n        item(value);\n    });      \n  }\n\n  // lock if not locked and returns false if already locked\n  lock(locking){\n    // return locked state if none provided\n    if(locking === undefined) {\n      return this.locked;\n    }  else if(this.locked === true && locking === true) {\n      // already locked asking again for same lock state\n      return false;\n    }\n\n    return this.locked = locking;\n  }\n\n  // Returns the next of kin bindings on the same element\n  kins(){\n    return this.view.bindings.filter((x)=> {return x.el === this.el});\n  }\n  // Returns the binding of a given type on the same element\n  kin(type){\n    let mappedType = kick.binderMap[type] || type;\n\n    return this.kins().find((x)=> {return x.type === mappedType;});\n  }\n}\n","import kick from './kick'\nimport {Binding} from './bindings'\nimport {parseTemplate} from './parsers'\n//import ComponentBinding from './components'\n\nconst textBinder = {\n  routine: (node, value) => {\n    node.data = (value != null) ? value : ''\n  }\n}\n\nconst DECLARATION_SPLIT = /((?:'[^']*')*(?:(?:[^\\|']*(?:'[^']*')+[^\\|']*)+|[^\\|]+))|^$/g\nconst ESCAPE_BINDER = /[.*+?^${}()|[\\]\\\\]/g\nconst ESCAPE_BINDER_WITH = '\\\\$&'\nconst binderPrefixes = '@:^.-+?!*#$~'.split('')\n\n\nconst parseNode = (view, node) => {\n  let block = false\n\n  if (node.nodeType === 3) {\n    let tokens = parseTemplate(node.data, kick.templateDelimiters)\n\n    if (tokens) {\n      for (let i = 0; i < tokens.length; i++) {\n        let token = tokens[i]\n        let text = document.createTextNode(token.value)\n        node.parentNode.insertBefore(text, node)\n\n        if (token.type === 1) {\n          view.buildBinding(text, null, token.value, textBinder, null)\n        }\n      }\n\n      node.parentNode.removeChild(node)\n    }\n    block = true\n  } else if (node.nodeType === 1) {\n    block = view.traverse(node)\n  }\n\n  if (!block) {\n    for (let i = 0; i < node.childNodes.length; i++) {\n      parseNode(view, node.childNodes[i]);\n    }\n  }\n}\n\nconst bindingComparator = (a, b) => {\n  let aPriority = a.binder ? (a.binder.priority || 0) : 0\n  let bPriority = b.binder ? (b.binder.priority || 0) : 0\n  return bPriority - aPriority\n}\n\nconst trimStr = (str) => {\n  return str.trim()\n}\n\n// A collection of bindings built from a set of parent nodes.\nexport default class View {\n  // The DOM elements and the model objects for binding are passed into the\n  // constructor along with any local options that should be used throughout the\n  // context of the view and it's bindings.\n  constructor(els, models, options) {\n    if (els.jquery || els instanceof Array) {\n      this.els = els\n    } else {\n      this.els = [els]\n    }\n\n    this.models = models\n    this.options = options\n\n    this.build()\n  }\n\n\n  buildBinding(node, type, declaration, binder, arg) {\n    let pipes = declaration.match(DECLARATION_SPLIT).map(trimStr)\n\n    let keypath = pipes.shift()\n\n    if(arg === '' && type === '*'){\n      //resolve for in expression, useful for case sensitive members e.g. myItem in items\n      const forRE = new RegExp(/^(.+)\\s+in\\s+(.[^|\\s]+)(.*)$/gm);\n      let forExp = forRE.exec(keypath);\n      // console.log(forExp)\n      if(forExp && forExp.length > 2){\n        arg = forExp[1] || arg\n        keypath = forExp[2] || keypath\n      }\n      // console.log(forExp[3].split('|'))\n    }\n\n    this.bindings.push(new Binding(this, node, type, keypath, binder, arg, pipes))\n  }\n\n  // Parses the DOM tree and builds `Binding` instances for every matched\n  // binding declaration.\n  build() {\n    this.bindings = []\n\n    let elements = this.els, i, len;\n    for (i = 0, len = elements.length; i < len; i++) {\n      parseNode(this, elements[i])\n    }\n\n    this.bindings.sort(bindingComparator)\n  }\n\n  traverse(node) {\n    // let bindingPrefix = kick._fullPrefix\n    let block = node.nodeName === 'SCRIPT' || node.nodeName === 'STYLE'\n    let attributes = node.attributes\n    let bindInfos = []\n    let varBinders = this.options.varBinders\n    let mappedBinder\n    var binderType, binder, identifier, arg\n\n    for (let i = 0, len = attributes.length; i < len; i++) {\n      let attribute = attributes[i]\n      // if (attribute.name.indexOf(bindingPrefix) === 0) {\n      if (this.startWithBinder(attribute.name)) {\n          // binderType = attribute.name.slice(bindingPrefix.length);\n          mappedBinder = kick.binderMap[attribute.name];\n          binderType = mappedBinder || attribute.name;\n\n        // type = attribute.name.slice(bindingPrefix.length)\n        binder = this.options.binders[binderType]\n        arg = undefined\n\n        if (!binder) {\n          for (let k = 0; k < varBinders.length; k++) {\n            identifier = varBinders[k]\n            if (binderType.slice(0, identifier.length - 1) === identifier.slice(0, -1)) {\n              binder = this.options.binders[identifier]\n              arg = binderType.slice(identifier.length - 1)\n              break\n            }\n          }\n        }\n\n        if (!binder) {\n          binder = kick.fallbackBinder\n        }\n\n        if (binder.block) {\n          this.buildBinding(node, binderType, attribute.value, binder, arg)\n          node.removeAttribute(attribute.name)\n          return true;\n        }\n\n        bindInfos.push({attr: attribute, binder: binder, type: binderType, arg: arg})\n      }\n    }\n\n    for (let i = 0; i < bindInfos.length; i++) {\n      let bindInfo = bindInfos[i]\n      this.buildBinding(node, bindInfo.type, bindInfo.attr.value, bindInfo.binder, bindInfo.arg)\n      node.removeAttribute(bindInfo.attr.name)\n    }\n\n    if (kick.components[binderType] && !node._bound) {\n       this.bindings.push(new ComponentBinding(this, node, binderType));\n       block = true;\n    }\n\n    return block\n  }\n\n  // Binds all of the current bindings for this view.\n  bind() {\n    this.bindings.forEach(binding => {\n      binding.bind()\n    })\n  }\n\n  // Unbinds all of the current bindings for this view.\n  unbind() {\n    this.bindings.forEach(binding => {\n      binding.unbind()\n    })\n  }\n\n  // Syncs up the view with the model by running the routines on all bindings.\n  sync() {\n    this.bindings.forEach(binding => {\n      binding.sync()\n    })\n  }\n\n  // Publishes the input values from the view back to the model (reverse sync).\n  publish() {\n    this.bindings.forEach(binding => {\n      if (binding.binder && binding.binder.publishes) {\n        binding.publish()\n      }\n    })\n  }\n\n  // Updates the view's models along with any affected bindings.\n  update(models = {}) {\n    Object.keys(models).forEach(key => {\n      this.models[key] = models[key]\n    })\n\n    this.bindings.forEach(binding => {\n      if (binding.update) {\n        binding.update(models)\n      }\n    })\n  }\n\n  // move it to utils\n  startWithBinder(name) {\n    const prefix = name.substr(0, 1)\n    return binderPrefixes.some((pre) => pre === prefix)\n  }\n}\n","// The default `.` adapter that comes with kick.js. Allows subscribing to\n// properties on plain objects, implemented in ES5 natives using\n// `Object.defineProperty`.\n\nconst ARRAY_METHODS = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'sort',\n  'reverse',\n  'splice'\n]\n\nconst adapter = {\n  counter: 0,\n  weakmap: {},\n\n  weakReference: function(obj) {\n    if (!obj.hasOwnProperty('__rv')) {\n      let id = this.counter++\n\n      Object.defineProperty(obj, '__rv', {\n        value: id\n      })\n    }\n\n    if (!this.weakmap[obj.__rv]) {\n      this.weakmap[obj.__rv] = {\n        callbacks: {}\n      }\n    }\n\n    return this.weakmap[obj.__rv]\n  },\n\n  cleanupWeakReference: function(ref, id) {\n    if (!Object.keys(ref.callbacks).length) {\n      if (!(ref.pointers && Object.keys(ref.pointers).length)) {\n        delete this.weakmap[id]\n      }\n    }\n  },\n\n  stubFunction: function(obj, fn) {\n    let original = obj[fn]\n    let map = this.weakReference(obj)\n    let weakmap = this.weakmap\n\n    obj[fn] = (...args) => {\n      let response = original.apply(obj, args)\n\n      Object.keys(map.pointers).forEach(r => {\n        let k = map.pointers[r]\n\n        if (weakmap[r]) {\n          if (weakmap[r].callbacks[k] instanceof Array) {\n            weakmap[r].callbacks[k].forEach(callback => {\n              callback.sync()\n            })\n          }\n        }\n      })\n\n      return response\n    }\n  },\n\n  observeMutations: function(obj, ref, keypath) {\n    if (obj instanceof Array) {\n      let map = this.weakReference(obj)\n\n      if (!map.pointers) {\n        map.pointers = {}\n\n        ARRAY_METHODS.forEach(fn => {\n          this.stubFunction(obj, fn)\n        })\n      }\n\n      if (!map.pointers[ref]) {\n        map.pointers[ref] = []\n      }\n\n      if (map.pointers[ref].indexOf(keypath) === -1) {\n        map.pointers[ref].push(keypath)\n      }\n    }\n  },\n\n  unobserveMutations: function(obj, ref, keypath) {\n    if ((obj instanceof Array) && (obj.__rv != null)) {\n      let map = this.weakmap[obj.__rv]\n\n      if (map) {\n        let pointers = map.pointers[ref]\n\n        if (pointers) {\n          let idx = pointers.indexOf(keypath)\n\n          if (idx > -1) {\n            pointers.splice(idx, 1)\n          }\n\n          if (!pointers.length) {\n            delete map.pointers[ref]\n          }\n\n          this.cleanupWeakReference(map, obj.__rv)\n        }\n      }\n    }\n  },\n\n  observe: function(obj, keypath, callback) {\n    var value;\n    let callbacks = this.weakReference(obj).callbacks\n\n    if (!callbacks[keypath]) {\n      callbacks[keypath] = []\n      let desc = Object.getOwnPropertyDescriptor(obj, keypath)\n\n      if (!desc || !(desc.get || desc.set || !desc.configurable)) {\n        value = obj[keypath]\n\n        Object.defineProperty(obj, keypath, {\n          enumerable: true,\n\n          get: () => {\n            return value\n          },\n\n          set: newValue => {\n            if (newValue !== value) {\n              this.unobserveMutations(value, obj.__rv, keypath)\n              value = newValue\n              let map = this.weakmap[obj.__rv]\n\n              if (map) {\n                let callbacks = map.callbacks[keypath]\n\n                if (callbacks) {\n                  callbacks.forEach(cb => {\n                      cb.sync()\n                  })\n                }\n\n                this.observeMutations(newValue, obj.__rv, keypath)\n              }\n            }\n          }\n        })\n      }\n    }\n\n    if (callbacks[keypath].indexOf(callback) === -1) {\n      callbacks[keypath].push(callback)\n    }\n\n    this.observeMutations(obj[keypath], obj.__rv, keypath)\n  },\n\n  unobserve: function(obj, keypath, callback) {\n    let map = this.weakmap[obj.__rv]\n\n    if (map) {\n      let callbacks = map.callbacks[keypath]\n\n      if (callbacks) {\n        let idx = callbacks.indexOf(callback)\n\n        if (idx > -1) {\n          callbacks.splice(idx, 1)\n\n          if (!callbacks.length) {\n            delete map.callbacks[keypath]\n            this.unobserveMutations(obj[keypath], obj.__rv, keypath)\n          }\n        }\n\n        this.cleanupWeakReference(map, obj.__rv)\n      }\n    }\n  },\n\n  get: function(obj, keypath) {\n    return obj[keypath]\n  },\n\n  set: (obj, keypath, value) => {\n    obj[keypath] = value\n  }\n}\n\nexport default adapter\n","import View from './view'\nimport kick from './kick';\n\nconst getString = (value) => {\n  return value != null ? value.toString() : undefined\n}\n\nconst times = (n, cb) => {\n  for (let i = 0; i < n; i++) cb()\n}\n\nfunction createView(binding, data, anchorEl) {\n  let template = binding.el.cloneNode(true)\n  let view = new View(template, data, binding.view.options)\n  view.bind()\n  binding.marker.parentNode.insertBefore(template, anchorEl)\n  return view\n}\n\nconst binders = {\n  // Binds an event handler on the element.\n  '^&': {\n    function: true,\n    priority: 1000,\n\n    unbind: function(el) {\n      if (this.handler) {\n        el.removeEventListener(this.arg, this.handler)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.handler) {\n        el.removeEventListener(this.arg, this.handler)\n      }\n\n      this.handler = this.eventHandler(value)\n      el.addEventListener(this.arg, this.handler)\n    }\n  },\n\n  // for $item Appends bound instances of the element in place for item in the array.\n  '*&': {\n    block: true,\n\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(` kick: ${this.type} `)\n        this.iterated = []\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else {\n        this.iterated.forEach(view => {\n          view.bind()\n        })\n      }\n    },\n\n    unbind: function(el) {\n      if (this.iterated) {\n        this.iterated.forEach(view => {\n          view.unbind()\n        })\n      }\n    },\n\n    routine: function(el, collection) {\n      let modelName = this.arg || '$item'\n      collection = collection || []\n      let indexProp = el.getAttribute('#index') || el.getAttribute('index-property') || '$index'\n\n      collection.forEach((model, index) => {\n        let data = {$parent: this.view.models}\n        data[indexProp] = index\n        data[modelName] = model\n        let view = this.iterated[index]\n\n        if (!view) {\n\n          let previous = this.marker\n\n          if (this.iterated.length) {\n            previous = this.iterated[this.iterated.length - 1].els[0]\n          }\n\n          view = createView(this, data, previous.nextSibling)\n          this.iterated.push(view)\n        } else {\n          if (view.models[modelName] !== model) {\n            // search for a view that matches the model\n            let matchIndex, nextView\n            for (let nextIndex = index + 1; nextIndex < this.iterated.length; nextIndex++) {\n              nextView = this.iterated[nextIndex]\n              if (nextView.models[modelName] === model) {\n                matchIndex = nextIndex\n                break\n              }\n            }\n            if (matchIndex !== undefined) {\n              // model is in other position\n              // todo: consider avoiding the splice here by setting a flag\n              // profile performance before implementing such change\n              this.iterated.splice(matchIndex, 1)\n              this.marker.parentNode.insertBefore(nextView.els[0], view.els[0])\n              nextView.models[indexProp] = index\n            } else {\n              //new model\n              nextView = createView(this, data, view.els[0])\n            }\n            this.iterated.splice(index, 0, nextView)\n          } else {\n            view.models[indexProp] = index\n          }\n        }\n      })\n\n      if (this.iterated.length > collection.length) {\n        times(this.iterated.length - collection.length, () => {\n          let view = this.iterated.pop()\n          view.unbind()\n          this.marker.parentNode.removeChild(view.els[0])\n        })\n      }\n\n      if (el.nodeName === 'OPTION') {\n        this.view.bindings.forEach(binding => {\n          if (binding.el === this.marker.parentNode && binding.type === 'value') {\n            binding.sync()\n          }\n        })\n      }\n    },\n\n    update: function(models) {\n      let data = {}\n\n      //todo: add test and fix if necessary\n\n      Object.keys(models).forEach(key => {\n        if (key !== this.arg) {\n          data[key] = models[key]\n        }\n      })\n\n      this.iterated.forEach(view => {\n        view.update(data)\n      })\n    }\n  },\n\n  // Order of ..& should be before .& otherwise match will trigger shorter length first\n  '..&': function(el, value) {\n    const propertyName = this.arg;\n    if (value) {\n      el.style[propertyName] = value;\n    } else {\n      el.style[propertyName] = '';\n    }\n  },\n\n  // Adds or removes the class from the element when value is true or false.\n  '.&': function(el, value) {\n    let elClass = ` ${el.className} `\n\n    if (!value === (elClass.indexOf(` ${this.arg} `) > -1)) {\n      if (value) {\n        el.className = `${el.className} ${this.arg}`\n      } else {\n        el.className = elClass.replace(` ${this.arg} `, ' ').trim()\n      }\n    }\n  },\n\n  // Sets the element's text value.\n  ':text': (el, value) => {\n    el.textContent = value != null ? value : ''\n  },\n\n  // Sets the element's HTML content.\n  ':html': (el, value) => {\n    el.innerHTML = value != null ? value : ''\n  },\n\n  // Shows the element when value is true.\n  ':show': (el, value) => {\n    el.style.display = value ? '' : 'none'\n  },\n\n  // Hides the element when value is true (negated version of `show` binder).\n  ':hide': (el, value) => {\n    el.style.display = value ? 'none' : ''\n  },\n\n  // Enables the element when value is true.\n  ':enabled': (el, value) => {\n    el.disabled = !value\n  },\n\n  // Disables the element when value is true (negated version of `enabled` binder).\n  ':disabled': (el, value) => {\n    el.disabled = !!value\n  },\n\n  // Checks a checkbox or radio input when the value is true. Also sets the model\n  // property when the input is checked or unchecked (two-way binder).\n  '@checked': {\n    publishes: true,\n    priority: 2000,\n\n    bind: function(el) {\n      var self = this;\n      if (!this.callback) {\n        this.callback = function () {\n          self.publish();\n        }\n      }\n      el.addEventListener('change', this.callback)\n    },\n\n    unbind: function(el) {\n      el.removeEventListener('change', this.callback)\n    },\n\n    routine: function(el, value) {\n      if (el.type === 'radio') {\n        el.checked = getString(el.value) === getString(value)\n      } else {\n        el.checked = !!value\n      }\n    }\n  },\n\n  // Sets the element's value. Also sets the model property when the input changes\n  // (two-way binder).\n  '@value': {\n    publishes: true,\n    priority: 3000,\n\n    bind: function(el) {\n      this.isRadio = el.tagName === 'INPUT' && el.type === 'radio';\n      if (!this.isRadio) {\n        this.event = el.getAttribute('event-name') || (el.tagName === 'SELECT' ? 'change' : 'input')\n\n        var self = this;\n        if (!this.callback) {\n          this.callback = function () {\n            self.publish();\n          }\n        }\n\n        el.addEventListener(this.event, this.callback)\n      }\n    },\n\n    unbind: function(el) {\n      if (!this.isRadio) {\n        el.removeEventListener(this.event, this.callback)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.isRadio) {\n        el.setAttribute('value', value)\n      } else {\n        if (el.type === 'select-multiple') {\n          if (value instanceof Array) {\n            for (let i = 0; i < el.length; i++) {\n              let option = el[i];\n              option.selected = value.indexOf(option.value) > -1\n            }\n          }\n        } else if (getString(value) !== getString(el.value)) {\n          el.value = value != null ? value : ''\n        }\n      }\n    }\n  },\n\n  // Inserts and binds the element and it's child nodes into the DOM when true.\n  '?': {\n    block: true,\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(' kick: ' + this.type + ' ' + this.keypath + ' ');\n        this.attached = false\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else if (this.bound === false && this.nested) {\n        this.nested.bind()\n      }\n      this.bound = true\n    },\n\n    unbind: function() {\n      if (this.nested) {\n        this.nested.unbind()\n        this.bound = false\n      }\n    },\n\n    routine: function(el, value) {\n      if (!!value !== this.attached) {\n        if (value) {\n\n          if (!this.nested) {\n            this.nested = new View(el, this.view.models, this.view.options)\n            this.nested.bind()\n          }\n\n          this.marker.parentNode.insertBefore(el, this.marker.nextSibling)\n          this.attached = true\n        } else {\n          el.parentNode.removeChild(el)\n          this.attached = false\n        }\n      }\n    },\n\n    update: function(models) {\n      if (this.nested) {\n        this.nested.update(models)\n      }\n    }\n  },\n  '::&': function(el, value) {\n    if (value != null) {\n      el.setAttribute(this.arg, value)\n    } else {\n      el.removeAttribute(this.arg)\n    }\n  }\n}\n\nexport default binders\n","import kick from './kick'\nimport View from './view'\nimport {OPTIONS, EXTENSIONS} from './constants'\nimport adapter from './adapter'\nimport binders from './binders'\nimport Observer from './observer'\n//import router from './router'\n//import components from './components'\n\n// Returns the public interface.\nkick.binders = binders\n//kick.components = components\nkick.adapters['.'] = adapter\n//kick.router = router\n\n// Binds some data to a template / element. Returns a kick.View instance.\nkick.bind = (elm, models, options) => {\n  // if element then return itself\n  elm = elm || '[kick-app]';\n  let el = (elm.nodeType && elm.nodeType > 0) ? elm : document.querySelector(elm);\n\n  let viewOptions = {}\n  models = models || {}\n  options = options || {}\n\n  EXTENSIONS.forEach(extensionType => {\n    viewOptions[extensionType] = Object.create(null)\n\n    if (options[extensionType]) {\n      Object.keys(options[extensionType]).forEach(key => {\n        viewOptions[extensionType][key] = options[extensionType][key]\n      })\n    }\n\n    Object.keys(kick[extensionType]).forEach(key => {\n      if (!viewOptions[extensionType][key]) {\n        viewOptions[extensionType][key] = kick[extensionType][key]\n      }\n    })\n  })\n\n  OPTIONS.forEach(option => {\n    let value = options[option]\n    viewOptions[option] = value != null ? value : kick[option]\n  })\n\n  viewOptions.varBinders = Object.keys(viewOptions.binders).filter(function (key) {\n    return key.indexOf('&') > 0\n  })\n\n  Observer.updateOptions(viewOptions)\n\n  let view = new View(el, models, viewOptions)\n  view.bind()\n  return view\n}\n\n// Initializes a new instance of a component on the specified element and\n// returns a View instance.\nkick.init = (component, el, data = {}) => {\n  if (el == null) { el = document.createElement('div'); }\n  component = kick.components[component];\n  let template = component.template.call(kick, el);\n  if (template instanceof HTMLElement) {\n    while (el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n    el.appendChild(template);\n  } else {\n    el.innerHTML = template;\n  }\n  const scope = component.initialize.call(kick, el, data);\n\n  let view = new View(el, scope)\n  view.bind()\n  return view\n}\n\n\nkick.formatters.negate = kick.formatters.not = (value) => {\n  return !value;\n};\n\nkick.formatters.call = (value, ...args) => {\n  if(!args.length) {return;}\n  let fn = args[0]\n  args = Array.prototype.slice.call(args, 1)\n  //value.call(...args)\n  return fn.call(value, ...args)\n  /* fix later if needs to be\n  return () => {\n      return fn.apply(null, value, ...args);\n  }\n  */\n}\n\nexport default kick\n"],"names":["OPTIONS","EXTENSIONS","PRIMITIVE","KEYPATH","TEXT","BINDING","QUOTED_STR","WHITESPACES","split","parseType","string","type","value","test","slice","undefined","isNaN","Number","parseTemplate","template","delimiters","tokens","length","index","lastIndex","open","close","indexOf","push","substring","lastToken","trim","parseFnExpr","expr","jsNested","statement","regex","RegExp","root","_","k","t","r","exec","parameters","args","node","forEach","p","e","wrappedNode","results","chars","level","temp","match","temp2","char","s","kick","context","ev","binding","processedArgs","parseFormatterArguments","fnArgs","call","view","models","el","setAttribute","removeAttribute","options","keys","option","key","isObject","obj","error","message","Error","adapters","interfaces","rootInterface","Observer","keypath","callback","objectPath","parse","getRootObject","target","realize","set","updateOptions","Object","tokenize","current","i","path","chr","charAt","prototype","substr","pop","unreached","prev","token","get","splice","sync","next","oldValue","newValue","Function","Array","setValue","active","action","unobserve","rootProp","$parent","getInputValue","checked","selected","FORMATTER_ARGS","FORMATTER_SPLIT","FN_CHECK","Binding","binder","arg","formatters","formatterObservers","model","subscribers","locked","listeners","observe","parseTarget","fnExpr","map","x","observer","formatterIndex","ai","formattedValue","reduce","result","declaration","id","shift","formatter","read","eventHandler","fn","handler","function","routineFn","routine","callSubscribers","publish","reduceRight","getValue","bind","hasOwnProperty","preloadData","unbind","fi","update","subscribe","listener","item","lock","locking","kins","bindings","filter","kin","mappedType","binderMap","find","textBinder","data","DECLARATION_SPLIT","binderPrefixes","parseNode","block","nodeType","templateDelimiters","text","document","createTextNode","parentNode","insertBefore","buildBinding","removeChild","traverse","childNodes","bindingComparator","a","b","aPriority","priority","bPriority","trimStr","str","View","els","jquery","build","pipes","forRE","forExp","elements","len","sort","nodeName","attributes","bindInfos","varBinders","mappedBinder","binderType","identifier","attribute","startWithBinder","name","binders","fallbackBinder","attr","bindInfo","components","_bound","ComponentBinding","publishes","prefix","some","pre","ARRAY_METHODS","adapter","counter","defineProperty","weakmap","__rv","ref","callbacks","pointers","original","weakReference","response","apply","stubFunction","idx","cleanupWeakReference","desc","getOwnPropertyDescriptor","configurable","unobserveMutations","observeMutations","getString","toString","times","n","cb","createView","anchorEl","cloneNode","marker","removeEventListener","addEventListener","createComment","iterated","collection","modelName","indexProp","getAttribute","previous","nextSibling","matchIndex","nextView","nextIndex","propertyName","style","elClass","className","replace","textContent","innerHTML","display","disabled","self","isRadio","tagName","event","attached","bound","nested","elm","querySelector","viewOptions","extensionType","create","init","component","createElement","HTMLElement","firstChild","appendChild","scope","initialize","negate","not"],"mappings":"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"}