{"version":3,"file":"kick.js","sources":["../src/constants.js","../src/parsers.js","../src/kick.js","../src/observer.js","../src/bindings.js","../src/view.js","../src/binders.js","../src/formatters.js","../src/adapter.js","../src/component.js","../src/export.js"],"sourcesContent":["export const OPTIONS = [\n  //'prefix',\n  'templateDelimiters',\n  'rootInterface',\n  'preloadData',\n  'handler'\n]\n\nexport const COMPS = 'components'\n\nexport const EXTENSIONS = [\n  'binders',\n  'formatters',\n  COMPS,\n  'adapters'\n]","const PRIMITIVE = 0;\nconst KEYPATH = 1;\nconst TEXT = 0;\nconst BINDING = 1;\n\nconst QUOTED_STR = /^'.*'$|^\".*\"$/;\nconst WHITESPACES = ' \\n\\r\\t'.split('');\n\n// Parser and tokenizer for getting the type and value from a string.\nexport function parseType(string) {\n  let type = PRIMITIVE;\n  let value = string;\n\n  if (QUOTED_STR.test(string)) {\n    value = string.slice(1, -1);\n  } else if (string === \"true\") {\n    value = true;\n  } else if (string === \"false\") {\n    value = false;\n  } else if (string === \"null\") {\n    value = null;\n  } else if (string === \"undefined\") {\n    value = undefined;\n  } else if (!isNaN(string)) {\n    value = Number(string);\n  } else {\n    type = KEYPATH;\n  }\n\n  return { type: type, value: value };\n}\n\n// Template parser and tokenizer for mustache-style text content bindings.\n// Parses the template and returns a set of tokens, separating static portions\n// of text from binding declarations.\nexport function parseTemplate(template, delimiters) {\n  var tokens;\n  let length = template.length;\n  let index = 0;\n  let lastIndex = 0;\n  let open = delimiters[0],\n    close = delimiters[1];\n\n  while (lastIndex < length) {\n    index = template.indexOf(open, lastIndex);\n\n    if (index < 0) {\n      if (tokens) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex)\n        });\n      }\n\n      break;\n    } else {\n      tokens || (tokens = []);\n      if (index > 0 && lastIndex < index) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex, index)\n        });\n      }\n\n      lastIndex = index + open.length;\n      index = template.indexOf(close, lastIndex);\n\n      if (index < 0) {\n        let substring = template.slice(lastIndex - close.length);\n        let lastToken = tokens[tokens.length - 1];\n\n        if (lastToken && lastToken.type === TEXT) {\n          lastToken.value += substring;\n        } else {\n          tokens.push({\n            type: TEXT,\n            value: substring\n          });\n        }\n\n        break;\n      }\n\n      let value = template.slice(lastIndex, index).trim();\n\n      tokens.push({\n        type: BINDING,\n        value: value\n      });\n\n      lastIndex = index + close.length;\n    }\n  }\n\n  return tokens;\n}\n\nexport function parseFnExpr(expr) {\n  function jsNested(statement) {\n    var regex = new RegExp(\"([a-zA-Z0-9_$]+)\\\\((.*)\\\\)\", \"g\");\n    var root = { _: [] };\n\n    if (QUOTED_STR.test(statement)) {\n      root._.push({ k: statement, t: \"l\" });\n      return root;\n    }\n\n    var r = regex.exec(statement);\n    if (!r || r.length < 3) {\n      return root;\n    }\n    var parameters = args(r[2]);\n    var node = { _: [] };\n    parameters.forEach(function(p) {\n      if (p.e) {\n        if (p.e.indexOf(\"(\") == -1) {\n          node._.push({ k: p.e, t: \"p\" });\n        } else {\n          var wrappedNode = jsNested(p.e),\n            k;\n          for (k in wrappedNode) {\n            node._.push(wrappedNode[k][0]);\n          }\n        }\n      } else {\n        //node[p.s] = p.s;\n      }\n    });\n\n    // Assign node to the node's identifier\n    root._.push({ k: r[1], t: 'f', _: node._ });\n    //root._.push(r[1]:node);\n    return root;\n  }\n\n  function args(statement) {\n    statement += \",\"; // so I don't have to handle the \"last, leftover parameter\"\n    var results = [];\n    var chars = statement.split(\"\");\n    var level = 0; // levels of parenthesis, used to track how deep I am in ().\n    var index = 0; // determines which parameter am I currently on.\n    var temp = \"\", match = '', temp2 = '';\n    chars.forEach(function(char) {\n      switch (true) {\n        case char === \"'\":\n        case char === '\"':\n          if (match.length && match === char) {\n            temp += match + temp2 + match;\n            results[index] = { s: temp2 };\n            match = temp2 = '';\n            //level--;\n            //temp = '';\n            index++;\n          } else {\n            match = char;\n            //level++;\n          }\n          //level++;\n          break;\n        case !match.length && WHITESPACES.indexOf(char) !== -1:\n          break;\n        case !match.length && char === '(':\n          temp += char;\n          level++;\n          break;\n        case !match.length && char === ')':\n          temp += char;\n          level--;\n          break;\n        case !match.length && char === ',':\n          // if the comma is between a set of parenthesis, ignore.\n          if (level !== 0) {\n            temp += char;\n          }\n          // if the comma is external, split the string.\n          else {\n            results[index] = { e: temp };\n            temp = '';\n            index++;\n          }\n          break;\n        default:\n          if (match.length) {\n            temp2 += char;\n          } else {\n            temp += char;\n          }\n          break;\n      }\n    });\n    return results;\n  } \n\n  //return if we were able to parse functions otherwise it will be null\n  return jsNested(expr)._[0] || null;\n}\n\n\n// Someone bored at http://jsfiddle.net/ryanwheale/e8aaa8ny/3/\nlet parseEngine = {\n  toSourceString: function(obj, recursion) {\n      let strout = \"\";\n      \n      recursion = recursion || 0;\n      for(let prop in obj) {\n          if (obj.hasOwnProperty(prop)) {\n              strout += recursion ? \"    \" + prop + \": \" : \"var \" + prop + \" = \";\n              switch (typeof obj[prop]) {\n                  case \"string\":\n                  case \"number\":\n                  case \"boolean\":\n                  case \"undefined\":\n                      strout += JSON.stringify(obj[prop]);\n                      break;\n                      \n                  case \"function\":\n                      // won't work in older browsers\n                      strout += obj[prop].toString();\n                      break;\n                      \n                  case \"object\":\n                      if (!obj[prop])\n                          strout += JSON.stringify(obj[prop]);\n                      else if (obj[prop] instanceof RegExp)\n                          strout += obj[prop].toString();\n                      else if (obj[prop] instanceof Date)\n                          strout += \"new Date(\" + JSON.stringify(obj[prop]) + \")\";\n                      else if (obj[prop] instanceof Array)\n                          strout += \"Array.prototype.slice.call({\\n \"\n                              + this.toSourceString(obj[prop], recursion + 1)\n                              + \"    length: \" + obj[prop].length\n                          + \"\\n })\";\n                      else\n                          strout += \"{\\n \"\n                              + this.toSourceString(obj[prop], recursion + 1).replace(/\\,\\s*$/, '')\n                          + \"\\n }\";\n                      break;\n              }\n              \n              strout += recursion ? \",\\n \" : \";\\n \";\n          }\n      }\n      return strout;\n  },\n  evaluate: function(strInput, obj) {\n      let str = this.toSourceString(obj);\n      console.log(str);\n      return (new Function(str + 'return ' + strInput))();\n  }\n};\n\n// Haven't tested yet just a fluke or placeholder\nexport function parseExpr(expr, ctx){\n  //console.log(engine.evaluate(strFn, context));\n  return parseEngine.evaluate(expr, ctx);\n}","import {EXTENSIONS} from './constants'\nimport {parseTemplate, parseType} from './parsers'\n\nconst kick = {\n  // Global binders.\n  binders: {},\n\n  // Global formatters.\n  formatters: {},\n\n  // Global components.\n  components: {},\n\n  // Global sightglass adapters.\n  adapters: {},\n\n  /*\n  // Default attribute prefix.\n  _prefix: 'rv',\n\n  _fullPrefix: 'rv-',\n\n  /* get prefix () {\n    return this._prefix\n  },\n\n  set prefix (value) {\n    this._prefix = value\n    this._fullPrefix = value + '-'\n  }, */\n\n  parseTemplate: parseTemplate,\n\n  parseType: parseType,\n\n  // Default template delimiters.\n  templateDelimiters: ['{{', '}}'],\n\n  // Binder shortcuts - extend it if you want to have your own\n  // else if(nodeName === '?') {nodeName = 'if';}\n\n  binderMap: {\n    '^': '^click',\n    '^^': '^dblclick',\n    '^_': '^contextmenu',\n    '^@': '^change',\n    '^+': '^focus',\n    '^-': '^blur',\n    '@': '@value',\n    '@x': '@checked',\n    '@-x': '@unchecked',\n    ':' : ':text',\n    '::' : ':html',\n    '$' : ':html',\n    '+': ':show',\n    '-': ':hide',\n    '~': ':disabled',\n    '~~': ':enabled',\n    '-~': ':enabled'\n    },\n    // was starBinder in rivetsjs, in kickjs *(star) is used for foreach binding so changing it to varBinder as an variable binder\n    varBinderMap: {\n      '.&': ':class-&',\n      '-.&': '-:class-&',\n      '..&': ':style-&',\n      '-..&': '-:style-&',\n      ':&': ':attr-&',\n      '-:&': '-:attr-&',\n    },\n  // Default sightglass root interface.\n  rootInterface: '.',\n\n  // Preload data by default.\n  preloadData: true,\n\n  // Default event handler.\n  handler: function(context, ev, binding) {\n    // changing the order of returns as well as passed arguments first then $event\n    // todo document this breakig change\n    const processedArgs = binding.parseFormatterArguments(binding.fnArgs, 0, ev, binding.view.models);\n    let fns = this.name.split(' ')\n    let fn = fns[fns.length - 1]\n    if(!fn || fn === ''){\n      //, binding.view.models, ev\n      this.call(context, ...[...processedArgs])\n    } else {\n      let ctx = binding.model\n      ctx[fn].call(ctx, ...[...processedArgs])\n    }\n  },\n\n  // Sets the attribute on the element. If no binder above is matched it will fall\n  // back to using this binder.\n  fallbackBinder: function(el, value) {\n    if (value != null) {\n      // is this a component?\n      let type = this.type;\n      let comp = customElements.get(el.localName)\n      if(type.substr(0,1) === ':'){ type = type.substr(1); }\n      if(comp && comp.properties && comp.properties[type] !== undefined){\n        let mapType = comp.properties[type]; \n        el[mapType] = value;\n      } else {\n        el.setAttribute(type, value)\n      }\n    } else {\n      el.removeAttribute(this.type)\n    }\n  },\n\n  // Merges an object literal into the corresponding global options.\n  configure: function(options) {\n    if (!options) {\n      return\n    }\n    Object.keys(options).forEach(option => {\n      let value = options[option]\n\n      if (EXTENSIONS.indexOf(option) > -1) {\n        Object.keys(value).forEach(key => {\n          this[option][key] = value[key]\n        })\n      } else {\n        this[option] = value\n      }\n    })\n  },\n\n  router:{}\n}\n\nexport default kick\n","\n// Check if a value is an object than can be observed.\nfunction isObject(obj) {\n  return typeof obj === 'object' && obj !== null\n}\n\n// Error thrower.\nfunction error(message) {\n  throw new Error('[Observer] ' + message)\n}\n\nvar adapters\nvar interfaces\nvar rootInterface\n\n// Constructs a new keypath observer and kicks things off.\nfunction Observer(obj, keypath, callback) {\n  this.keypath = keypath\n  this.callback = callback\n  this.objectPath = []\n  this.parse()\n  this.obj = this.getRootObject(obj)\n\n  if (isObject(this.target = this.realize())) {\n    this.set(true, this.key, this.target, this.callback)\n  }\n}\n\nObserver.updateOptions = function(options) {\n  adapters = options.adapters\n  interfaces = Object.keys(adapters)\n  rootInterface = options.rootInterface\n}\n\n// Tokenizes the provided keypath string into interface + path tokens for the\n// observer to work with.\nObserver.tokenize = function(keypath, root) {\n  var tokens = []\n  var current = {i: root, path: ''}\n  var index, chr\n\n  for (index = 0; index < keypath.length; index++) {\n    chr = keypath.charAt(index)\n\n    if (!!~interfaces.indexOf(chr)) {\n      tokens.push(current)\n      current = {i: chr, path: ''}\n    } else {\n      current.path += chr\n    }\n  }\n\n  tokens.push(current)\n  return tokens\n}\n\n// Parses the keypath using the interfaces defined on the view. Sets variables\n// for the tokenized keypath as well as the end key.\nObserver.prototype.parse = function() {\n  var path, root\n\n  if (!interfaces.length) {\n    error('Must define at least one adapter interface.')\n  }\n\n  if (!!~interfaces.indexOf(this.keypath[0])) {\n    root = this.keypath[0]\n    path = this.keypath.substr(1)\n  } else {\n    root = rootInterface\n    path = this.keypath\n  }\n\n  this.tokens = Observer.tokenize(path, root)\n  this.key = this.tokens.pop()\n}\n\n// Realizes the full keypath, attaching observers for every key and correcting\n// old observers to any changed objects in the keypath.\nObserver.prototype.realize = function() {\n  var current = this.obj\n  var unreached = -1\n  var prev\n  var token\n\n  for (let index = 0; index < this.tokens.length; index++) {\n    token = this.tokens[index]\n    if (isObject(current)) {\n      if (typeof this.objectPath[index] !== 'undefined') {\n        if (current !== (prev = this.objectPath[index])) {\n          this.set(false, token, prev, this)\n          this.set(true, token, current, this)\n          this.objectPath[index] = current\n        }\n      } else {\n        this.set(true, token, current, this)\n        this.objectPath[index] = current\n      }\n\n      current = this.get(token, current)\n    } else {\n      if (unreached === -1) {\n        unreached = index\n      }\n\n      if (prev = this.objectPath[index]) {\n        this.set(false, token, prev, this)\n      }\n    }\n  }\n\n  if (unreached !== -1) {\n    this.objectPath.splice(unreached)\n  }\n\n  return current\n}\n\n// Updates the keypath. This is called when any intermediary key is changed.\nObserver.prototype.sync = function() {\n  var next, oldValue, newValue\n\n  if ((next = this.realize()) !== this.target) {\n    if (isObject(this.target)) {\n      this.set(false, this.key, this.target, this.callback)\n    }\n\n    if (isObject(next)) {\n      this.set(true, this.key, next, this.callback)\n    }\n\n    oldValue = this.value()\n    this.target = next\n    newValue = this.value()\n    if (newValue !== oldValue || newValue instanceof Function) this.callback.sync()\n  } else if (next instanceof Array) {\n    this.callback.sync()\n  }\n}\n\n// Reads the current end value of the observed keypath. Returns undefined if\n// the full keypath is unreachable.\nObserver.prototype.value = function() {\n  if (isObject(this.target)) {\n    return this.get(this.key, this.target)\n  }\n}\n\n// Sets the current end value of the observed keypath. Calling setValue when\n// the full keypath is unreachable is a no-op.\nObserver.prototype.setValue = function(value) {\n  if (isObject(this.target)) {\n    adapters[this.key.i].set(this.target, this.key.path, value)\n  }\n}\n\n// Gets the provided key on an object.\nObserver.prototype.get = function(key, obj) {\n  return adapters[key.i].get(obj, key.path)\n}\n\n// Observes or unobserves a callback on the object using the provided key.\nObserver.prototype.set = function(active, key, obj, callback) {\n  var action = active ? 'observe' : 'unobserve'\n  adapters[key.i][action](obj, key.path, callback)\n}\n\n\n// Unobserves the entire keypath.\nObserver.prototype.unobserve = function() {\n  var obj\n  var token\n\n  for (let index = 0; index < this.tokens.length; index++) {\n    token = this.tokens[index]\n    if (obj = this.objectPath[index]) {\n      this.set(false, token, obj, this)\n    }\n  }\n\n  if (isObject(this.target)) {\n    this.set(false, this.key, this.target, this.callback)\n  }\n}\n// traverse the scope chain to find the scope which has the root property\n// if the property is not found in chain, returns the root scope\nObserver.prototype.getRootObject = function (obj) {\n  var rootProp, current;\n  if (!obj.$parent) {\n    return obj;\n  }\n\n  if (this.tokens.length) {\n    rootProp = this.tokens[0].path\n  } else {\n    rootProp = this.key.path\n  }\n\n  current = obj;\n  while (current.$parent && (current[rootProp] === undefined)) {\n    current = current.$parent\n  }\n\n  return current;\n}\n\nexport default Observer\n","import { parseType, parseFnExpr } from \"./parsers\";\nimport Observer from \"./observer\";\nimport kick from './kick';\n\nfunction getInputValue(el) {\n  let results = [];\n  if (el.type === \"checkbox\") {\n    return el.checked;\n  } else if (el.type === \"select-multiple\") {\n    el.options.forEach(option => {\n      if (option.selected) {\n        results.push(option.value);\n      }\n    });\n\n    return results;\n  } else {\n    return el.value;\n  }\n}\n\nconst FORMATTER_ARGS = /[^\\s']+|'([^']|'[^\\s])*'|\"([^\"]|\"[^\\s])*\"/g;\nconst FORMATTER_SPLIT = /\\s+/;\nconst FN_CHECK = /\\(.*\\)/;\n\n// A single binding between a model attribute and a DOM element.\nexport class Binding {\n  // All information about the binding is passed into the constructor; the\n  // containing view, the DOM node, the type of binding, the model object and the\n  // keypath at which to listen for changes.\n  constructor(view, el, type, keypath, binder, arg, formatters) {\n    this.view = view;\n    this.el = el;\n    this.type = type;\n    this.keypath = keypath;\n    this.binder = binder;\n    this.arg = arg;\n    this.formatters = formatters;\n    this.formatterObservers = {};\n    this.model = undefined;\n\n    //new property in kick for fn args but not sure if this is the right way\n    this.fnArgs = [];\n    //new property in kick for subscribers to get notified if value is changing specifically for jquery plugins\n    this.subscribers = [];\n    //new property in kick for locking to avoid loops of updates, specifically for jquery plugins\n    this.locked = false;\n    // add object to hold listners so that they can be unbinded later\n    this.listeners = {};\n  }\n\n  // Observes the object keypath\n  observe(obj, keypath) {\n    return new Observer(obj, keypath, this);\n  }\n\n  parseTarget() {\n    if (this.keypath) {\n      let token = parseType(this.keypath);\n\n      if (token.type === 0) {\n        this.value = token.value;\n      } else {\n        if (FN_CHECK.test(this.keypath)) {\n          let fnExpr = parseFnExpr(this.keypath);\n          if (fnExpr) {\n            this.keypath = fnExpr.k;\n            this.fnArgs = fnExpr._.map(x => x.k);\n            //let fnArgs = fnExpr._.map(x => x.k)\n            //this.fnArgs = this.parseFormatterArguments(fnArgs, 0)\n          }\n        }\n        this.observer = this.observe(this.view.models, this.keypath);\n        this.model = this.observer.target;\n      }\n    } else {\n      this.value = undefined;\n    }\n  }\n\n  parseFormatterArguments(args, formatterIndex, ev, vm) {\n    return args.map(parseType).map(({ type, value }, ai) => {\n      if (type === 0) {\n        return value;\n      } else if (value === '$ev') { //return event here\n          return ev;\n      } else if (value === '$vm') { //return model here\n          return vm;\n      } else if (value === '$el') { //return element here\n          return this.el;\n      } else {\n        if (!this.formatterObservers[formatterIndex]) {\n          this.formatterObservers[formatterIndex] = {};\n        }\n\n        let observer = this.formatterObservers[formatterIndex][ai];\n\n        if (!observer) {\n          observer = this.observe(this.view.models, value);\n          this.formatterObservers[formatterIndex][ai] = observer;\n        }\n\n        return observer.value();\n      }\n    });\n  }\n\n  // Applies all the current formatters to the supplied value and returns the\n  // formatted value.\n  formattedValue(value) {\n    return this.formatters.reduce((result, declaration, index) => {\n      let args = declaration.match(FORMATTER_ARGS);\n      let id = args.shift();\n      let formatter = this.view.options.formatters[id];\n\n      const processedArgs = this.parseFormatterArguments(args, index, null, this.view.models);\n\n      if (formatter && formatter.read instanceof Function) {\n        result = formatter.read(result, ...processedArgs);\n      } else if (formatter instanceof Function) {\n        result = formatter(result, ...processedArgs);\n      }\n      return result;\n    }, value);\n  }\n\n  // Returns an event handler for the binding around the supplied function.\n  eventHandler(fn) {\n    let binding = this;    \n    let handler = binding.view.options.handler;\n    let lfn = fn;\n\n    let type = this.type;\n    let el = this.el; \n    if(type.substr(0,1) === '^'){ type = type.substr(1); }\n    if(el.constructor && el.constructor.properties && el.constructor.properties[type] !== undefined){\n      let mapType = el.constructor.properties[type]; \n      el[mapType] = lfn;\n    } else {      \n      return function(ev) {\n        lfn && handler.call(lfn, this, ev, binding);\n      };\n    }\n  }\n\n  // Sets the value for the binding. This Basically just runs the binding routine\n  // with the supplied value formatted.\n  set(value) {\n    if (value instanceof Function && !this.binder.function) {\n      //todo update docs, probably a breaking change\n      const processedArgs = this.parseFormatterArguments(this.fnArgs, 0, null, this.view.models);\n      value = this.formattedValue(\n        value.call(this.model, ...[...processedArgs])\n      );\n      //value = this.formattedValue(value.call(this.model))\n    } else {\n      value = this.formattedValue(value);\n    }\n\n    let routineFn = this.binder.routine || this.binder;\n\n    if (routineFn instanceof Function) {\n      routineFn.call(this, this.el, value);\n      this.callSubscribers(value);\n    }\n  }\n\n  // Syncs up the view binding with the model.\n  sync() {\n    if (this.observer) {\n      this.model = this.observer.target;\n      this.set(this.observer.value());\n    } else {\n      this.set(this.value);\n    }\n  }\n\n  // Publishes the value currently set on the input element back to the model.\n  publish() {\n    if (this.observer) {\n      var value = this.formatters.reduceRight((result, declaration, index) => {\n        const args = declaration.split(FORMATTER_SPLIT);\n        const id = args.shift();\n        const formatter = this.view.options.formatters[id];\n        const processedArgs = this.parseFormatterArguments(args, index, null, this.view.models);\n\n        if (formatter && formatter.publish) {\n          result = formatter.publish(result, ...processedArgs);\n        }\n        return result;\n      }, this.getValue(this.el));\n\n      this.observer.setValue(value);\n    }\n  }\n\n  // Subscribes to the model for changes at the specified keypath. Bi-directional\n  // routines will also listen for changes on the element to propagate them back\n  // to the model.\n  bind() {\n    this.parseTarget();\n\n    if (this.binder.hasOwnProperty(\"bind\")) {\n      this.binder.bind.call(this, this.el);\n    }\n\n    if (this.view.options.preloadData) {\n      this.sync();\n    }\n  }\n\n  // Unsubscribes from the model and the element.\n  unbind() {\n    if (this.binder.unbind) {\n      this.binder.unbind.call(this, this.el);\n    }\n\n    if (this.observer) {\n      this.observer.unobserve();\n    }\n\n    Object.keys(this.formatterObservers).forEach(fi => {\n      let args = this.formatterObservers[fi];\n\n      Object.keys(args).forEach(ai => {\n        args[ai].unobserve();\n      });\n    });\n\n    this.formatterObservers = {};\n  }\n\n  // Updates the binding's model from what is currently set on the view. Unbinds\n  // the old model first and then re-binds with the new model.\n  update(models = {}) {\n    if (this.observer) {\n      this.model = this.observer.target;\n    }\n\n    if (this.binder.update) {\n      this.binder.update.call(this, models);\n    }\n  }\n\n  // Returns elements value\n  getValue(el) {\n    if (this.binder && this.binder.getValue) {\n      return this.binder.getValue.call(this, el);\n    } else {\n      return getInputValue(el);\n    }\n  }\n\n  // Subscribe to the value changes\n  subscribe(listener) {\n    var index = this.subscribers.push(listener) -1;\n\n    // Provide handle back for removal of listener\n    return {\n      remove: function() {\n        delete this.subscribers[index];\n      }\n    };\n  }\n\n  // Call the subscribers\n  callSubscribers(value){\n      // Cycle through subscribers queue, fire!\n      this.subscribers.forEach(function(item) {\n        item(value);\n    });      \n  }\n\n  // lock if not locked and returns false if already locked\n  lock(locking){\n    // return locked state if none provided\n    if(locking === undefined) {\n      return this.locked;\n    }  else if(this.locked === true && locking === true) {\n      // already locked asking again for same lock state\n      return false;\n    }\n\n    return this.locked = locking;\n  }\n\n  // Returns the next of kin bindings on the same element\n  kins(){\n    return this.view.bindings.filter((x)=> {return x.el === this.el});\n  }\n  // Returns the binding of a given type on the same element\n  kin(type){\n    let mappedType = kick.binderMap[type] || type;\n\n    return this.kins().find((x)=> {return x.type === mappedType;});\n  }\n}\n","import kick from './kick'\nimport {Binding} from './bindings'\nimport {parseTemplate} from './parsers'\n//import ComponentBinding from './components'\n\nconst textBinder = {\n  routine: (node, value) => {\n    node.data = (value != null) ? value : ''\n  }\n}\n\nconst DECLARATION_SPLIT = /((?:'[^']*')*(?:(?:[^\\|']*(?:'[^']*')+[^\\|']*)+|[^\\|]+))|^$/g\nconst ESCAPE_BINDER = /[.*+?^${}()|[\\]\\\\]/g\nconst ESCAPE_BINDER_WITH = '\\\\$&'\nconst binderPrefixes = '@:^.-+?!*#$~'.split('')\n\n\nconst parseNode = (view, node) => {\n  let block = false\n\n  if (node.nodeType === 3) {\n    let tokens = parseTemplate(node.data, kick.templateDelimiters)\n\n    if (tokens) {\n      for (let i = 0; i < tokens.length; i++) {\n        let token = tokens[i]\n        let text = document.createTextNode(token.value)\n        node.parentNode.insertBefore(text, node)\n\n        if (token.type === 1) {\n          view.buildBinding(text, null, token.value, textBinder, null)\n        }\n      }\n\n      node.parentNode.removeChild(node)\n    }\n    block = true\n  } else if (node.nodeType === 1) {\n    block = view.traverse(node)\n  }\n\n  if (!block) {\n    for (let i = 0; i < node.childNodes.length; i++) {\n      parseNode(view, node.childNodes[i]);\n    }\n  }\n}\n\nconst bindingComparator = (a, b) => {\n  let aPriority = a.binder ? (a.binder.priority || 0) : 0\n  let bPriority = b.binder ? (b.binder.priority || 0) : 0\n  return bPriority - aPriority\n}\n\nconst trimStr = (str) => {\n  return str.trim()\n}\n\n// A collection of bindings built from a set of parent nodes.\nexport default class View {\n  // The DOM elements and the model objects for binding are passed into the\n  // constructor along with any local options that should be used throughout the\n  // context of the view and it's bindings.\n  constructor(els, models, options) {\n    if (els.jquery || els instanceof Array) {\n      this.els = els\n    } else {\n      this.els = [els]\n    }\n\n    this.models = models\n    this.options = options\n\n    this.build()\n  }\n\n\n  buildBinding(node, type, declaration, binder, arg) {\n    let pipes = declaration.match(DECLARATION_SPLIT).map(trimStr)\n\n    let keypath = pipes.shift()\n\n    if(arg === '' && type === '*'){\n      // resolve for in expression, useful for case sensitive members e.g. myItem in items\n      const forRE = new RegExp(/^(.+)\\s+in\\s+(.[^|\\s]+)(.*)$/gm);\n      let forExp = forRE.exec(keypath);\n      // console.log(forExp)\n      if(forExp && forExp.length > 2){\n        arg = forExp[1] || arg\n        keypath = forExp[2] || keypath\n      }\n      // console.log(forExp[3].split('|'))\n    }\n\n    this.bindings.push(new Binding(this, node, type, keypath, binder, arg, pipes))\n  }\n\n  // Parses the DOM tree and builds `Binding` instances for every matched\n  // binding declaration.\n  build() {\n    this.bindings = []\n\n    let elements = this.els, i, len;\n    for (i = 0, len = elements.length; i < len; i++) {\n      parseNode(this, elements[i])\n    }\n\n    this.bindings.sort(bindingComparator)\n  }\n\n  traverse(node) {\n    // let bindingPrefix = kick._fullPrefix\n    let block = node.nodeName === 'SCRIPT' || node.nodeName === 'STYLE'\n    let attributes = node.attributes\n    let bindInfos = []\n    let varBinders = this.options.varBinders\n    let mappedBinder\n    var binderType, binder, identifier, arg\n\n    for (let i = 0, len = attributes.length; i < len; i++) {\n      let attribute = attributes[i]\n      // if (attribute.name.indexOf(bindingPrefix) === 0) {\n      if (this.startWithBinder(attribute.name)) {\n          // binderType = attribute.name.slice(bindingPrefix.length);\n          mappedBinder = kick.binderMap[attribute.name];\n          binderType = mappedBinder || attribute.name;\n\n        // type = attribute.name.slice(bindingPrefix.length)\n        binder = this.options.binders[binderType]\n        arg = undefined\n\n        if (!binder) {\n          for (let k = 0; k < varBinders.length; k++) {\n            identifier = varBinders[k]\n            if (binderType.slice(0, identifier.length - 1) === identifier.slice(0, -1)) {\n              binder = this.options.binders[identifier]\n              arg = binderType.slice(identifier.length - 1)\n              break\n            }\n          }\n        }\n\n        if (!binder) {\n          binder = kick.fallbackBinder\n        }\n\n        if (binder.block) {\n          this.buildBinding(node, binderType, attribute.value, binder, arg)\n          node.removeAttribute(attribute.name)\n          return true;\n        }\n\n        bindInfos.push({attr: attribute, binder: binder, type: binderType, arg: arg})\n      }\n    }\n\n    for (let i = 0; i < bindInfos.length; i++) {\n      let bindInfo = bindInfos[i]\n      this.buildBinding(node, bindInfo.type, bindInfo.attr.value, bindInfo.binder, bindInfo.arg)\n      node.removeAttribute(bindInfo.attr.name)\n    }\n\n    if (kick.components[binderType] && !node._bound) {\n       this.bindings.push(new ComponentBinding(this, node, binderType));\n       block = true;\n    }\n\n    return block\n  }\n\n  // Binds all of the current bindings for this view.\n  bind() {\n    this.bindings.forEach(binding => {\n      binding.bind()\n    })\n  }\n\n  // Unbinds all of the current bindings for this view.\n  unbind() {\n    this.bindings.forEach(binding => {\n      binding.unbind()\n    })\n  }\n\n  // Syncs up the view with the model by running the routines on all bindings.\n  sync() {\n    this.bindings.forEach(binding => {\n      binding.sync()\n    })\n  }\n\n  // Publishes the input values from the view back to the model (reverse sync).\n  publish() {\n    this.bindings.forEach(binding => {\n      if (binding.binder && binding.binder.publishes) {\n        binding.publish()\n      }\n    })\n  }\n\n  // Updates the view's models along with any affected bindings.\n  update(models = {}) {\n    Object.keys(models).forEach(key => {\n      this.models[key] = models[key]\n    })\n\n    this.bindings.forEach(binding => {\n      if (binding.update) {\n        binding.update(models)\n      }\n    })\n  }\n\n  // move it to utils\n  startWithBinder(name) {\n    const prefix = name.substr(0, 1)\n    return binderPrefixes.some((pre) => pre === prefix)\n  }\n}\n","import View from './view'\nimport kick from './kick';\n\n// adding jQuery support to handle bootstrap and common vast plugin support\nconst has$ = (window.jQuery ? true : false)\nconst on = (el, arg, handler) => {has$ ? $(el).on(arg, handler) : el.addEventListener(arg, handler)}\nconst off = (el, arg, handler) => {has$ ? $(el).off(arg, handler) : el.removeEventListener(arg, handler)}\n\nconst getString = (value) => {\n  return value != null ? value.toString() : undefined\n}\n\nconst times = (n, cb) => {\n  for (let i = 0; i < n; i++) cb()\n}\n\nfunction createView(binding, data, anchorEl) {\n  let template = binding.el.cloneNode(true)\n  let view = new View(template, data, binding.view.options)\n  view.bind()\n  binding.marker.parentNode.insertBefore(template, anchorEl)\n  return view\n}\n\nconst binders = {\n  // Binds an event handler on the element.\n  '^&': {\n    function: true,\n    priority: 1000,\n\n    unbind: function(el) {\n      if (this.handler) {\n        off(el, this.arg, this.handler)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.handler) {\n        off(el, this.arg, this.handler)\n      }\n\n      this.handler = this.eventHandler(value)\n      on(el, this.arg, this.handler)\n    }\n  },\n\n  // for $item Appends bound instances of the element in place for item in the array.\n  '*&': {\n    block: true,\n\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(` kick: ${this.type} `)\n        this.iterated = []\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else {\n        this.iterated.forEach(view => {\n          view.bind()\n        })\n      }\n    },\n\n    unbind: function(el) {\n      if (this.iterated) {\n        this.iterated.forEach(view => {\n          view.unbind()\n        })\n      }\n    },\n\n    routine: function(el, collection) {\n      let modelName = this.arg || '$item'\n      collection = collection || []\n      let indexProp = el.getAttribute('#index') || el.getAttribute('index-property') || '$index'\n\n      collection.forEach((model, index) => {\n        let data = {$parent: this.view.models}\n        data[indexProp] = index\n        data[modelName] = model\n        let view = this.iterated[index]\n\n        if (!view) {\n\n          let previous = this.marker\n\n          if (this.iterated.length) {\n            previous = this.iterated[this.iterated.length - 1].els[0]\n          }\n\n          view = createView(this, data, previous.nextSibling)\n          this.iterated.push(view)\n        } else {\n          if (view.models[modelName] !== model) {\n            // search for a view that matches the model\n            let matchIndex, nextView\n            for (let nextIndex = index + 1; nextIndex < this.iterated.length; nextIndex++) {\n              nextView = this.iterated[nextIndex]\n              if (nextView.models[modelName] === model) {\n                matchIndex = nextIndex\n                break\n              }\n            }\n            if (matchIndex !== undefined) {\n              // model is in other position\n              // todo: consider avoiding the splice here by setting a flag\n              // profile performance before implementing such change\n              this.iterated.splice(matchIndex, 1)\n              this.marker.parentNode.insertBefore(nextView.els[0], view.els[0])\n              nextView.models[indexProp] = index\n            } else {\n              //new model\n              nextView = createView(this, data, view.els[0])\n            }\n            this.iterated.splice(index, 0, nextView)\n          } else {\n            view.models[indexProp] = index\n          }\n        }\n      })\n\n      if (this.iterated.length > collection.length) {\n        times(this.iterated.length - collection.length, () => {\n          let view = this.iterated.pop()\n          view.unbind()\n          this.marker.parentNode.removeChild(view.els[0])\n        })\n      }\n\n      if (el.nodeName === 'OPTION') {\n        this.view.bindings.forEach(binding => {\n          if (binding.el === this.marker.parentNode && binding.type === 'value') {\n            binding.sync()\n          }\n        })\n      }\n    },\n\n    update: function(models) {\n      let data = {}\n\n      //todo: add test and fix if necessary\n      Object.keys(models).forEach(key => {\n        if (key !== this.arg) {\n          data[key] = models[key]\n        }\n      })\n\n      this.iterated.forEach(view => {\n        view.update(data)\n      })\n    }\n  },\n\n  // Order of ..& should be before .& otherwise match will trigger shorter length first\n  // removes the style from the element when there is value\n  '-..&': function(el, value) {\n    const propertyName = this.arg;\n    if (value) {\n      el.style[propertyName] = '';\n    } else {\n      // do nothing\n      //el.style[propertyName] = value;\n    }\n  },\n\n  // Order of ..& should be before .& otherwise match will trigger shorter length first\n  // Adds or removes the style from the element when there is value\n  '..&': function(el, value) {\n    const propertyName = this.arg;\n    if (value) {\n      el.style[propertyName] = value;\n    } else {\n      el.style[propertyName] = '';\n    }\n  },\n\n  // Adds or removes the class from the element when value is false or true.\n  '-.&': function(el, value) {\n    let elClass = ` ${el.className} `\n\n    if (value === (elClass.indexOf(` ${this.arg} `) > -1)) {\n      if (value) {\n        el.className = elClass.replace(` ${this.arg} `, ' ').trim()\n      } else {\n        el.className = `${el.className} ${this.arg}`\n      }\n    }\n  },\n\n  // Adds or removes the class from the element when value is true or false.\n  '.&': function(el, value) {\n    let elClass = ` ${el.className} `\n\n    if (!value === (elClass.indexOf(` ${this.arg} `) > -1)) {\n      if (value) {\n        el.className = `${el.className} ${this.arg}`\n      } else {\n        el.className = elClass.replace(` ${this.arg} `, ' ').trim()\n      }\n    }\n  },\n\n  // Sets the element's text value.\n  ':text': (el, value) => {\n    el.textContent = value != null ? value : ''\n  },\n\n  // Sets the element's HTML content.\n  ':html': (el, value) => {\n    el.innerHTML = value != null ? value : ''\n  },\n  \n  // Shows the element when value is true.\n  ':show': (el, value) => {\n    el.style.display = value ? '' : 'none'\n  },\n\n  // Hides the element when value is true (negated version of `show` binder).\n  ':hide': (el, value) => {\n    el.style.display = value ? 'none' : ''\n  },\n\n  // Enables the element when value is true.\n  ':enabled': (el, value) => {\n    el.disabled = !value\n  },\n\n  // Disables the element when value is true (negated version of `enabled` binder).\n  ':disabled': (el, value) => {\n    el.disabled = !!value\n  },\n\n  // Checks a checkbox or radio input when the value is true. Also sets the model\n  // property when the input is checked or unchecked (two-way binder).\n  // also \"@x\"\n  '@checked': {\n    publishes: true,\n    priority: 2000,\n\n    bind: function(el) {\n      var self = this;\n      if (!this.callback) {\n        this.callback = function () {\n          self.publish();\n        }\n      }\n      el.addEventListener('change', this.callback)\n    },\n\n    unbind: function(el) {\n      el.removeEventListener('change', this.callback)\n    },\n\n    routine: function(el, value) {\n      if (el.type === 'radio') {\n        el.checked = getString(el.value) === getString(value)\n      } else {\n        el.checked = !!value\n      }\n    }\n  },\n  // Unchecks a checkbox or radio input when the value is true. Also sets the model\n  // property when the input is checked or unchecked (two-way binder).\n  // also \"@-x\"\n  '@unchecked': {\n    publishes: true,\n    priority: 2000,\n\n    bind: function(el) {\n      var self = this;\n      if (!this.callback) {\n        this.callback = function () {\n          self.publish();\n        }\n      }\n      el.addEventListener('change', this.callback)\n    },\n\n    unbind: function(el) {\n      el.removeEventListener('change', this.callback)\n    },\n\n    routine: function(el, value) {\n      if (el.type === 'radio') {\n        el.checked = !(getString(el.value) === getString(value))\n      } else {\n        el.checked = !(!!value)\n      }\n    }\n  },\n\n  // Sets the element's value. Also sets the model property when the input changes\n  // (two-way binder).\n  '@value': {\n    publishes: true,\n    priority: 3000,\n\n    bind: function(el) {\n      this.isRadio = el.tagName === 'INPUT' && el.type === 'radio';\n      if (!this.isRadio) {\n        this.event = el.getAttribute('event-name') || (el.tagName === 'SELECT' ? 'change' : 'input')\n\n        var self = this;\n        if (!this.callback) {\n          this.callback = function () {\n            self.publish();\n          }\n        }\n\n        el.addEventListener(this.event, this.callback)\n      }\n    },\n\n    unbind: function(el) {\n      if (!this.isRadio) {\n        el.removeEventListener(this.event, this.callback)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.isRadio) {\n        el.setAttribute('value', value)\n      } else {\n        if (el.type === 'select-multiple') {\n          if (value instanceof Array) {\n            for (let i = 0; i < el.length; i++) {\n              let option = el[i];\n              option.selected = value.indexOf(option.value) > -1\n            }\n          }\n        } else if (getString(value) !== getString(el.value)) {\n          el.value = value != null ? value : ''\n        }\n      }\n    }\n  },\n\n  // Inserts and binds the element and it's child nodes into the DOM when true.\n  '?': {\n    block: true,\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(' kick: ' + this.type + ' ' + this.keypath + ' ');\n        this.attached = false\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else if (this.bound === false && this.nested) {\n        this.nested.bind()\n      }\n      this.bound = true\n    },\n\n    unbind: function() {\n      if (this.nested) {\n        this.nested.unbind()\n        this.bound = false\n      }\n    },\n\n    routine: function(el, value) {\n      if (!!value !== this.attached) {\n        if (value) {\n\n          if (!this.nested) {\n            this.nested = new View(el, this.view.models, this.view.options)\n            this.nested.bind()\n          }\n\n          this.marker.parentNode.insertBefore(el, this.marker.nextSibling)\n          this.attached = true\n        } else {\n          el.parentNode.removeChild(el)\n          this.attached = false\n        }\n      }\n    },\n\n    update: function(models) {\n      if (this.nested) {\n        this.nested.update(models)\n      }\n    }\n  },\n\n  // Inserts and binds the element and it's child nodes into the DOM when false.\n  '-?': {\n    block: true,\n    priority: 4001,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(' kick: ' + this.type + ' ' + this.keypath + ' ');\n        this.attached = false\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else if (this.bound === false && this.nested) {\n        this.nested.bind()\n      }\n      this.bound = true\n    },\n\n    unbind: function() {\n      if (this.nested) {\n        this.nested.unbind()\n        this.bound = false\n      }\n    },\n\n    routine: function(el, value) {\n      if (!!value === this.attached) {\n        if (!value) {\n\n          if (!this.nested) {\n            this.nested = new View(el, this.view.models, this.view.options)\n            this.nested.bind()\n          }\n\n          this.marker.parentNode.insertBefore(el, this.marker.nextSibling)\n          this.attached = true\n        } else {\n          el.parentNode.removeChild(el)\n          this.attached = false\n        }\n      }\n    },\n\n    update: function(models) {\n      if (this.nested) {\n        this.nested.update(models)\n      }\n    }\n  },\n\n\n  ':&': function(el, value) {\n    if (value != null) {\n      el.setAttribute(this.arg, value)\n    } else {\n      el.removeAttribute(this.arg)\n    }\n  },\n  '-:&': function(el, value) {\n    if (value != null) {\n      el.removeAttribute(this.arg)\n    } else {\n      // take no action and keep the attribute if it is there\n      // el.setAttribute(this.arg, value)\n    }\n  }  \n}\n\nexport default binders\n","const formatters = {\r\n    watch: function(value) {\r\n      return value;\r\n    },\r\n  \r\n    not: function(value) {\r\n      return !value;\r\n    },\r\n  \r\n    negate: function(value) {\r\n      return !value;\r\n    }\r\n  }\r\n  \r\nexport default formatters","// The default `.` adapter that comes with kick.js. Allows subscribing to\n// properties on plain objects, implemented in ES5 natives using\n// `Object.defineProperty`.\n\nconst ARRAY_METHODS = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'sort',\n  'reverse',\n  'splice'\n]\n\nconst adapter = {\n  counter: 0,\n  weakmap: {},\n\n  weakReference: function(obj) {\n    if (!obj.hasOwnProperty('__rv')) {\n      let id = this.counter++\n\n      Object.defineProperty(obj, '__rv', {\n        value: id\n      })\n    }\n\n    if (!this.weakmap[obj.__rv]) {\n      this.weakmap[obj.__rv] = {\n        callbacks: {}\n      }\n    }\n\n    return this.weakmap[obj.__rv]\n  },\n\n  cleanupWeakReference: function(ref, id) {\n    if (!Object.keys(ref.callbacks).length) {\n      if (!(ref.pointers && Object.keys(ref.pointers).length)) {\n        delete this.weakmap[id]\n      }\n    }\n  },\n\n  stubFunction: function(obj, fn) {\n    let original = obj[fn]\n    let map = this.weakReference(obj)\n    let weakmap = this.weakmap\n\n    obj[fn] = (...args) => {\n      let response = original.apply(obj, args)\n\n      Object.keys(map.pointers).forEach(r => {\n        let k = map.pointers[r]\n\n        if (weakmap[r]) {\n          if (weakmap[r].callbacks[k] instanceof Array) {\n            weakmap[r].callbacks[k].forEach(callback => {\n              callback.sync()\n            })\n          }\n        }\n      })\n\n      return response\n    }\n  },\n\n  observeMutations: function(obj, ref, keypath) {\n    if (obj instanceof Array) {\n      let map = this.weakReference(obj)\n\n      if (!map.pointers) {\n        map.pointers = {}\n\n        ARRAY_METHODS.forEach(fn => {\n          this.stubFunction(obj, fn)\n        })\n      }\n\n      if (!map.pointers[ref]) {\n        map.pointers[ref] = []\n      }\n\n      if (map.pointers[ref].indexOf(keypath) === -1) {\n        map.pointers[ref].push(keypath)\n      }\n    }\n  },\n\n  unobserveMutations: function(obj, ref, keypath) {\n    if ((obj instanceof Array) && (obj.__rv != null)) {\n      let map = this.weakmap[obj.__rv]\n\n      if (map) {\n        let pointers = map.pointers[ref]\n\n        if (pointers) {\n          let idx = pointers.indexOf(keypath)\n\n          if (idx > -1) {\n            pointers.splice(idx, 1)\n          }\n\n          if (!pointers.length) {\n            delete map.pointers[ref]\n          }\n\n          this.cleanupWeakReference(map, obj.__rv)\n        }\n      }\n    }\n  },\n\n  observe: function(obj, keypath, callback) {\n    var value;\n    let callbacks = this.weakReference(obj).callbacks\n\n    if (!callbacks[keypath]) {\n      callbacks[keypath] = []\n      let desc = Object.getOwnPropertyDescriptor(obj, keypath)\n\n      if (!desc || !(desc.get || desc.set || !desc.configurable)) {\n        value = obj[keypath]\n\n        Object.defineProperty(obj, keypath, {\n          enumerable: true,\n\n          get: () => {\n            return value\n          },\n\n          set: newValue => {\n            if (newValue !== value) {\n              this.unobserveMutations(value, obj.__rv, keypath)\n              value = newValue\n              let map = this.weakmap[obj.__rv]\n\n              if (map) {\n                let callbacks = map.callbacks[keypath]\n\n                if (callbacks) {\n                  callbacks.forEach(cb => {\n                      cb.sync()\n                  })\n                }\n\n                this.observeMutations(newValue, obj.__rv, keypath)\n              }\n            }\n          }\n        })\n      }\n    }\n\n    if (callbacks[keypath].indexOf(callback) === -1) {\n      callbacks[keypath].push(callback)\n    }\n\n    this.observeMutations(obj[keypath], obj.__rv, keypath)\n  },\n\n  unobserve: function(obj, keypath, callback) {\n    let map = this.weakmap[obj.__rv]\n\n    if (map) {\n      let callbacks = map.callbacks[keypath]\n\n      if (callbacks) {\n        let idx = callbacks.indexOf(callback)\n\n        if (idx > -1) {\n          callbacks.splice(idx, 1)\n\n          if (!callbacks.length) {\n            delete map.callbacks[keypath]\n            this.unobserveMutations(obj[keypath], obj.__rv, keypath)\n          }\n        }\n\n        this.cleanupWeakReference(map, obj.__rv)\n      }\n    }\n  },\n\n  get: function(obj, keypath) {\n    return obj[keypath]\n  },\n\n  set: (obj, keypath, value) => {\n    obj[keypath] = value\n  }\n}\n\nexport default adapter\n","import kick from './kick'\r\n\r\nclass Component extends HTMLElement {\r\n  static setObservedAttributes(_comp) {\r\n    const template = _comp.template\r\n    const tag = _comp.tag\r\n    if (!template || !tag) {\r\n      throw new Error(`No template or tag declared for ${this.name}`)\r\n    }\r\n    \r\n    _comp.__templateEl = document.createElement('template')\r\n    _comp.__templateEl.innerHTML = template\r\n    \r\n    const propAttributeMap = _comp.__propAttributeMap = {}\r\n    const attributes = []\r\n    const properties = _comp.properties\r\n    \r\n    if (properties) {\r\n      Object.keys(properties).forEach(propName => {\r\n        const propConfig = properties[propName]\r\n        const attrName = typeof propConfig === 'string' ? propConfig : propName\r\n        propAttributeMap[attrName] = propName        \r\n        attributes.push(attrName)\r\n        \r\n        // this.vm[propName] = propConfig\r\n      })\r\n    }    \r\n    return attributes\r\n  }\r\n  static get observedAttributes() {\r\n    return this.setObservedAttributes(this)\r\n  }\r\n\r\n\r\n  connectedCallback() {        \r\n    const nodes = this.constructor.__templateEl.content.cloneNode(true)\r\n    this.__kickView = kick.bind(nodes, this)\r\n    while (this.firstChild) {\r\n      this.removeChild(this.firstChild);\r\n    }\r\n    this.__kickView.sync()\r\n    this.appendChild(nodes)\r\n    this.__kickView.sync()\r\n    this.afterInit()\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.beforeExit()\r\n    this.__kickView.unbind()    \r\n  }\r\n\r\n  attributeChangedCallback(name, old, value) {\r\n    if (old !== value) {      \r\n      const propName = this.constructor.__propAttributeMap[name]\r\n      this[propName] = value\r\n    }\r\n  }\r\n  constructor(...args){\r\n    const self = super(...args)\r\n    // !this.properties && this.setObservedAttributes(this)\r\n    // this.__templateEl = document.createElement('template')\r\n    // this.__templateEl.innerHTML = this.template\r\n\r\n    //let templateContent = template.content\r\n\r\n\r\n    this.onInit()\r\n    return self\r\n  }\r\n  onInit(){}\r\n  afterInit(){}\r\n  beforeExit(){}\r\n  \r\n}\r\n\r\nexport default Component","import kick from './kick'\nimport View from './view'\nimport {OPTIONS, EXTENSIONS, COMPS} from './constants'\nimport binders from './binders'\nimport formatters from './formatters'\nimport adapter from './adapter'\nimport Observer from './observer'\n//import router from './router'\nimport Component from './component'\n\n// Returns the public interface.\nkick.binders = binders\nkick.formatters = formatters\nkick.adapters['.'] = adapter\nkick.Component = Component\n//kick.router = router\n\n// Binds some data to a template / element. Returns a kick.View instance.\nkick.bind = (elm, models, options, ) => {\n  // if element then return itself\n  elm = elm || '[kick-app]';\n  let el = (elm.nodeType && elm.nodeType > 0) ? elm : document.querySelector(elm);\n  kick.includeFile(el);\n\n  // refresh the el again after loading files\n  el = (elm.nodeType && elm.nodeType > 0) ? elm : document.querySelector(elm);\n\n  \n  let viewOptions = {}\n  models = models || {}\n  options = options || {}\n\n  EXTENSIONS.forEach(extensionType => {\n    viewOptions[extensionType] = Object.create(null)\n\n    if (options[extensionType]) {\n      Object.keys(options[extensionType]).forEach(key => {\n        viewOptions[extensionType][key] = options[extensionType][key]\n      })\n    }\n\n    Object.keys(kick[extensionType]).forEach(key => {\n      if (!viewOptions[extensionType][key]) {\n        viewOptions[extensionType][key] = kick[extensionType][key]\n      }\n    })\n  })\n\n  if(viewOptions[COMPS]){\n    Object.keys(viewOptions[COMPS]).forEach(key => {\n      let comp = viewOptions[COMPS][key]\n      //kick.components[comp.tag] = comp;\n      if(comp.tag && !customElements.get(comp.tag)){\n        customElements.define(comp.tag, comp)\n      }\n    })\n  }\n\n  OPTIONS.forEach(option => {\n    let value = options[option]\n    viewOptions[option] = value != null ? value : kick[option]\n  })\n\n  viewOptions.varBinders = Object.keys(viewOptions.binders).filter(function (key) {\n    return key.indexOf('&') > 0\n  })\n\n  Observer.updateOptions(viewOptions)\n\n  let view = new View(el, models, viewOptions)\n  view.bind()\n  return view\n}\n\n// Initializes a new instance of a component on the specified element and\n// returns a View instance.\nkick.init = (component, el, data = {}) => {\n  if (el == null) { el = document.createElement('div'); }\n  component = kick.components[component];\n  let template = component.template.call(kick, el);\n  if (template instanceof HTMLElement) {\n    while (el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n    el.appendChild(template);\n  } else {\n    el.innerHTML = template;\n  }\n  const scope = component.initialize.call(kick, el, data);\n\n  let view = new View(el, scope)\n  view.bind()\n  return view\n}\n\n\nkick.formatters.negate = kick.formatters.not = (value) => {\n  return !value;\n};\n\nkick.formatters.call = (value, ...args) => {\n  if(!args.length) {return;}\n  let fn = args[0]\n  args = Array.prototype.slice.call(args, 1)\n  //value.call(...args)\n  return fn.call(value, ...args)\n  /* fix later if needs to be\n  return () => {\n      return fn.apply(null, value, ...args);\n  }\n  */\n}\n\nkick.loadFile = (el, file) => {\n  /* Make an HTTP request using the attribute value as the file name: */\n  try {\n    let xhttp = new XMLHttpRequest();\n    xhttp.onreadystatechange = function() {\n      if (this.readyState == 4) {\n        if (this.status == 200) {\n          /* Remove the attribute, and call this function once more: */\n          if(el.tagName === 'KICKER'){\n            // replace el with new html\n            el.outerHTML = this.responseText;\n            // not sure about the below yet \n            // kick.includeFile(el.parent);\n          } else {\n            el.removeAttribute(\":file\");\n            el.innerHTML = this.responseText;\n            kick.includeFile(el);\n          }\n        }\n        else if (this.status == 404) {el.innerHTML = '<!-- ' + this.responseURL + ' not found. -->';}\n        else {el.innerHTML = '<!-- ' + this.responseText + ' -->';}\n      }\n    } \n    xhttp.open(\"GET\", file, false);\n    xhttp.send();\n  } catch (e) {\n    el.innerHTML = '<!-- Unable to connect to server -->';\n  }\n}\n\n// Sets the element's HTML content from file.\nkick.includeFile = (el) => {\n  let z, i, elmnt, file;\n  if(!el.getElementsByTagName){\n    if(el.children.length){\n      z = el.children;\n    } else {\n      return;\n    }\n  } else{\n    /* Loop through a collection of all HTML elements: */\n    z =  el.getElementsByTagName(\"*\");\n  } \n\n  for (i = 0; i < z.length; i++) {\n    elmnt = z[i];\n    /*search for elements with a certain atrribute:*/\n    file = elmnt.getAttribute(\":file\");\n    if (file) {\n      kick.loadFile(elmnt, file);\n    }\n  }\n}\n\nexport default kick\n"],"names":["OPTIONS","COMPS","EXTENSIONS","PRIMITIVE","KEYPATH","TEXT","BINDING","QUOTED_STR","WHITESPACES","split","parseType","string","type","value","test","slice","undefined","isNaN","Number","parseTemplate","template","delimiters","tokens","length","index","lastIndex","open","close","indexOf","push","substring","lastToken","trim","parseFnExpr","expr","jsNested","statement","regex","RegExp","root","_","k","t","r","exec","parameters","args","node","forEach","p","e","wrappedNode","results","chars","level","temp","match","temp2","char","s","kick","binders","formatters","components","adapters","templateDelimiters","binderMap","varBinderMap","rootInterface","preloadData","handler","context","ev","binding","processedArgs","parseFormatterArguments","fnArgs","view","models","fns","name","fn","call","ctx","model","fallbackBinder","el","comp","customElements","get","localName","substr","properties","mapType","setAttribute","removeAttribute","configure","options","Object","keys","option","key","router","isObject","obj","error","message","Error","interfaces","Observer","keypath","callback","objectPath","parse","getRootObject","target","realize","set","updateOptions","tokenize","current","i","path","chr","charAt","prototype","pop","unreached","prev","token","splice","sync","next","oldValue","newValue","Function","Array","setValue","active","action","unobserve","rootProp","$parent","getInputValue","checked","selected","FORMATTER_ARGS","FORMATTER_SPLIT","FN_CHECK","Binding","binder","arg","formatterObservers","subscribers","locked","listeners","observe","parseTarget","fnExpr","map","x","observer","formatterIndex","vm","ai","formattedValue","reduce","result","declaration","id","shift","formatter","read","eventHandler","lfn","constructor","function","routineFn","routine","callSubscribers","publish","reduceRight","getValue","bind","hasOwnProperty","unbind","fi","update","subscribe","listener","remove","item","lock","locking","kins","bindings","filter","kin","mappedType","find","textBinder","data","DECLARATION_SPLIT","binderPrefixes","parseNode","block","nodeType","text","document","createTextNode","parentNode","insertBefore","buildBinding","removeChild","traverse","childNodes","bindingComparator","a","b","aPriority","priority","bPriority","trimStr","str","View","els","jquery","build","pipes","forRE","forExp","elements","len","sort","nodeName","attributes","bindInfos","varBinders","mappedBinder","binderType","identifier","attribute","startWithBinder","attr","bindInfo","_bound","ComponentBinding","publishes","prefix","some","pre","has$","window","jQuery","on","$","addEventListener","off","removeEventListener","getString","toString","times","n","cb","createView","anchorEl","cloneNode","marker","createComment","iterated","collection","modelName","indexProp","getAttribute","previous","nextSibling","matchIndex","nextView","nextIndex","propertyName","style","elClass","className","replace","textContent","innerHTML","display","disabled","self","isRadio","tagName","event","attached","bound","nested","watch","not","negate","ARRAY_METHODS","adapter","counter","weakmap","weakReference","defineProperty","__rv","callbacks","cleanupWeakReference","ref","pointers","stubFunction","original","response","apply","observeMutations","unobserveMutations","idx","desc","getOwnPropertyDescriptor","configurable","enumerable","Component","setObservedAttributes","_comp","tag","__templateEl","createElement","propAttributeMap","__propAttributeMap","propName","propConfig","attrName","connectedCallback","nodes","content","__kickView","firstChild","appendChild","afterInit","disconnectedCallback","beforeExit","attributeChangedCallback","old","onInit","HTMLElement","elm","querySelector","includeFile","viewOptions","extensionType","create","define","init","component","scope","initialize","loadFile","file","xhttp","XMLHttpRequest","onreadystatechange","readyState","status","outerHTML","responseText","responseURL","send","z","elmnt","getElementsByTagName","children"],"mappings":";;;;;;EAAO,IAAMA,OAAO,GAAG;EAErB,oBAFqB,EAGrB,eAHqB,EAIrB,aAJqB,EAKrB,SALqB,CAAhB;EAQA,IAAMC,KAAK,GAAG,YAAd;EAEA,IAAMC,UAAU,GAAG,CACxB,SADwB,EAExB,YAFwB,EAGxBD,KAHwB,EAIxB,UAJwB,CAAnB;;ECVP,IAAME,SAAS,GAAG,CAAlB;EACA,IAAMC,OAAO,GAAG,CAAhB;EACA,IAAMC,IAAI,GAAG,CAAb;EACA,IAAMC,OAAO,GAAG,CAAhB;EAEA,IAAMC,UAAU,GAAG,eAAnB;EACA,IAAMC,WAAW,GAAG,UAAUC,KAAV,CAAgB,EAAhB,CAApB;;AAGA,EAAO,SAASC,SAAT,CAAmBC,MAAnB,EAA2B;EAChC,MAAIC,IAAI,GAAGT,SAAX;EACA,MAAIU,KAAK,GAAGF,MAAZ;;EAEA,MAAIJ,UAAU,CAACO,IAAX,CAAgBH,MAAhB,CAAJ,EAA6B;EAC3BE,IAAAA,KAAK,GAAGF,MAAM,CAACI,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAR;EACD,GAFD,MAEO,IAAIJ,MAAM,KAAK,MAAf,EAAuB;EAC5BE,IAAAA,KAAK,GAAG,IAAR;EACD,GAFM,MAEA,IAAIF,MAAM,KAAK,OAAf,EAAwB;EAC7BE,IAAAA,KAAK,GAAG,KAAR;EACD,GAFM,MAEA,IAAIF,MAAM,KAAK,MAAf,EAAuB;EAC5BE,IAAAA,KAAK,GAAG,IAAR;EACD,GAFM,MAEA,IAAIF,MAAM,KAAK,WAAf,EAA4B;EACjCE,IAAAA,KAAK,GAAGG,SAAR;EACD,GAFM,MAEA,IAAI,CAACC,KAAK,CAACN,MAAD,CAAV,EAAoB;EACzBE,IAAAA,KAAK,GAAGK,MAAM,CAACP,MAAD,CAAd;EACD,GAFM,MAEA;EACLC,IAAAA,IAAI,GAAGR,OAAP;EACD;;EAED,SAAO;EAAEQ,IAAAA,IAAI,EAAEA,IAAR;EAAcC,IAAAA,KAAK,EAAEA;EAArB,GAAP;EACD;EAGD;EACA;;AACA,EAAO,SAASM,aAAT,CAAuBC,QAAvB,EAAiCC,UAAjC,EAA6C;EAClD,MAAIC,MAAJ;EACA,MAAIC,MAAM,GAAGH,QAAQ,CAACG,MAAtB;EACA,MAAIC,KAAK,GAAG,CAAZ;EACA,MAAIC,SAAS,GAAG,CAAhB;EACA,MAAIC,IAAI,GAAGL,UAAU,CAAC,CAAD,CAArB;EAAA,MACEM,KAAK,GAAGN,UAAU,CAAC,CAAD,CADpB;;EAGA,SAAOI,SAAS,GAAGF,MAAnB,EAA2B;EACzBC,IAAAA,KAAK,GAAGJ,QAAQ,CAACQ,OAAT,CAAiBF,IAAjB,EAAuBD,SAAvB,CAAR;;EAEA,QAAID,KAAK,GAAG,CAAZ,EAAe;EACb,UAAIF,MAAJ,EAAY;EACVA,QAAAA,MAAM,CAACO,IAAP,CAAY;EACVjB,UAAAA,IAAI,EAAEP,IADI;EAEVQ,UAAAA,KAAK,EAAEO,QAAQ,CAACL,KAAT,CAAeU,SAAf;EAFG,SAAZ;EAID;;EAED;EACD,KATD,MASO;EACLH,MAAAA,MAAM,KAAKA,MAAM,GAAG,EAAd,CAAN;;EACA,UAAIE,KAAK,GAAG,CAAR,IAAaC,SAAS,GAAGD,KAA7B,EAAoC;EAClCF,QAAAA,MAAM,CAACO,IAAP,CAAY;EACVjB,UAAAA,IAAI,EAAEP,IADI;EAEVQ,UAAAA,KAAK,EAAEO,QAAQ,CAACL,KAAT,CAAeU,SAAf,EAA0BD,KAA1B;EAFG,SAAZ;EAID;;EAEDC,MAAAA,SAAS,GAAGD,KAAK,GAAGE,IAAI,CAACH,MAAzB;EACAC,MAAAA,KAAK,GAAGJ,QAAQ,CAACQ,OAAT,CAAiBD,KAAjB,EAAwBF,SAAxB,CAAR;;EAEA,UAAID,KAAK,GAAG,CAAZ,EAAe;EACb,YAAIM,SAAS,GAAGV,QAAQ,CAACL,KAAT,CAAeU,SAAS,GAAGE,KAAK,CAACJ,MAAjC,CAAhB;EACA,YAAIQ,SAAS,GAAGT,MAAM,CAACA,MAAM,CAACC,MAAP,GAAgB,CAAjB,CAAtB;;EAEA,YAAIQ,SAAS,IAAIA,SAAS,CAACnB,IAAV,KAAmBP,IAApC,EAA0C;EACxC0B,UAAAA,SAAS,CAAClB,KAAV,IAAmBiB,SAAnB;EACD,SAFD,MAEO;EACLR,UAAAA,MAAM,CAACO,IAAP,CAAY;EACVjB,YAAAA,IAAI,EAAEP,IADI;EAEVQ,YAAAA,KAAK,EAAEiB;EAFG,WAAZ;EAID;;EAED;EACD;;EAED,UAAIjB,KAAK,GAAGO,QAAQ,CAACL,KAAT,CAAeU,SAAf,EAA0BD,KAA1B,EAAiCQ,IAAjC,EAAZ;EAEAV,MAAAA,MAAM,CAACO,IAAP,CAAY;EACVjB,QAAAA,IAAI,EAAEN,OADI;EAEVO,QAAAA,KAAK,EAAEA;EAFG,OAAZ;EAKAY,MAAAA,SAAS,GAAGD,KAAK,GAAGG,KAAK,CAACJ,MAA1B;EACD;EACF;;EAED,SAAOD,MAAP;EACD;AAED,EAAO,SAASW,WAAT,CAAqBC,IAArB,EAA2B;EAChC,WAASC,QAAT,CAAkBC,SAAlB,EAA6B;EAC3B,QAAIC,KAAK,GAAG,IAAIC,MAAJ,CAAW,4BAAX,EAAyC,GAAzC,CAAZ;EACA,QAAIC,IAAI,GAAG;EAAEC,MAAAA,CAAC,EAAE;EAAL,KAAX;;EAEA,QAAIjC,UAAU,CAACO,IAAX,CAAgBsB,SAAhB,CAAJ,EAAgC;EAC9BG,MAAAA,IAAI,CAACC,CAAL,CAAOX,IAAP,CAAY;EAAEY,QAAAA,CAAC,EAAEL,SAAL;EAAgBM,QAAAA,CAAC,EAAE;EAAnB,OAAZ;;EACA,aAAOH,IAAP;EACD;;EAED,QAAII,CAAC,GAAGN,KAAK,CAACO,IAAN,CAAWR,SAAX,CAAR;;EACA,QAAI,CAACO,CAAD,IAAMA,CAAC,CAACpB,MAAF,GAAW,CAArB,EAAwB;EACtB,aAAOgB,IAAP;EACD;;EACD,QAAIM,UAAU,GAAGC,IAAI,CAACH,CAAC,CAAC,CAAD,CAAF,CAArB;EACA,QAAII,IAAI,GAAG;EAAEP,MAAAA,CAAC,EAAE;EAAL,KAAX;EACAK,IAAAA,UAAU,CAACG,OAAX,CAAmB,UAASC,CAAT,EAAY;EAC7B,UAAIA,CAAC,CAACC,CAAN,EAAS;EACP,YAAID,CAAC,CAACC,CAAF,CAAItB,OAAJ,CAAY,GAAZ,KAAoB,CAAC,CAAzB,EAA4B;EAC1BmB,UAAAA,IAAI,CAACP,CAAL,CAAOX,IAAP,CAAY;EAAEY,YAAAA,CAAC,EAAEQ,CAAC,CAACC,CAAP;EAAUR,YAAAA,CAAC,EAAE;EAAb,WAAZ;EACD,SAFD,MAEO;EACL,cAAIS,WAAW,GAAGhB,QAAQ,CAACc,CAAC,CAACC,CAAH,CAA1B;EAAA,cACET,CADF;;EAEA,eAAKA,CAAL,IAAUU,WAAV,EAAuB;EACrBJ,YAAAA,IAAI,CAACP,CAAL,CAAOX,IAAP,CAAYsB,WAAW,CAACV,CAAD,CAAX,CAAe,CAAf,CAAZ;EACD;EACF;EACF,OAVD;EAaD,KAdD,EAf2B;;EAgC3BF,IAAAA,IAAI,CAACC,CAAL,CAAOX,IAAP,CAAY;EAAEY,MAAAA,CAAC,EAAEE,CAAC,CAAC,CAAD,CAAN;EAAWD,MAAAA,CAAC,EAAE,GAAd;EAAmBF,MAAAA,CAAC,EAAEO,IAAI,CAACP;EAA3B,KAAZ,EAhC2B;;;EAkC3B,WAAOD,IAAP;EACD;;EAED,WAASO,IAAT,CAAcV,SAAd,EAAyB;EACvBA,IAAAA,SAAS,IAAI,GAAb,CADuB;;EAEvB,QAAIgB,OAAO,GAAG,EAAd;EACA,QAAIC,KAAK,GAAGjB,SAAS,CAAC3B,KAAV,CAAgB,EAAhB,CAAZ;EACA,QAAI6C,KAAK,GAAG,CAAZ,CAJuB;;EAKvB,QAAI9B,KAAK,GAAG,CAAZ,CALuB;;EAMvB,QAAI+B,IAAI,GAAG,EAAX;EAAA,QAAeC,KAAK,GAAG,EAAvB;EAAA,QAA2BC,KAAK,GAAG,EAAnC;EACAJ,IAAAA,KAAK,CAACL,OAAN,CAAc,UAASU,IAAT,EAAe;EAC3B,cAAQ,IAAR;EACE,aAAKA,IAAI,KAAK,GAAd;EACA,aAAKA,IAAI,KAAK,GAAd;EACE,cAAIF,KAAK,CAACjC,MAAN,IAAgBiC,KAAK,KAAKE,IAA9B,EAAoC;EAClCH,YAAAA,IAAI,IAAIC,KAAK,GAAGC,KAAR,GAAgBD,KAAxB;EACAJ,YAAAA,OAAO,CAAC5B,KAAD,CAAP,GAAiB;EAAEmC,cAAAA,CAAC,EAAEF;EAAL,aAAjB;EACAD,YAAAA,KAAK,GAAGC,KAAK,GAAG,EAAhB,CAHkC;EAKlC;;EACAjC,YAAAA,KAAK;EACN,WAPD,MAOO;EACLgC,YAAAA,KAAK,GAAGE,IAAR,CADK;EAGN,WAXH;;;EAaE;;EACF,aAAK,CAACF,KAAK,CAACjC,MAAP,IAAiBf,WAAW,CAACoB,OAAZ,CAAoB8B,IAApB,MAA8B,CAAC,CAArD;EACE;;EACF,aAAK,CAACF,KAAK,CAACjC,MAAP,IAAiBmC,IAAI,KAAK,GAA/B;EACEH,UAAAA,IAAI,IAAIG,IAAR;EACAJ,UAAAA,KAAK;EACL;;EACF,aAAK,CAACE,KAAK,CAACjC,MAAP,IAAiBmC,IAAI,KAAK,GAA/B;EACEH,UAAAA,IAAI,IAAIG,IAAR;EACAJ,UAAAA,KAAK;EACL;;EACF,aAAK,CAACE,KAAK,CAACjC,MAAP,IAAiBmC,IAAI,KAAK,GAA/B;EACE;EACA,cAAIJ,KAAK,KAAK,CAAd,EAAiB;EACfC,YAAAA,IAAI,IAAIG,IAAR;EACD,WAFD;EAAA,eAIK;EACHN,cAAAA,OAAO,CAAC5B,KAAD,CAAP,GAAiB;EAAE0B,gBAAAA,CAAC,EAAEK;EAAL,eAAjB;EACAA,cAAAA,IAAI,GAAG,EAAP;EACA/B,cAAAA,KAAK;EACN;;EACD;;EACF;EACE,cAAIgC,KAAK,CAACjC,MAAV,EAAkB;EAChBkC,YAAAA,KAAK,IAAIC,IAAT;EACD,WAFD,MAEO;EACLH,YAAAA,IAAI,IAAIG,IAAR;EACD;;EACD;EA5CJ;EA8CD,KA/CD;EAgDA,WAAON,OAAP;EACD,GA9F+B;;;EAiGhC,SAAOjB,QAAQ,CAACD,IAAD,CAAR,CAAeM,CAAf,CAAiB,CAAjB,KAAuB,IAA9B;EACD;;EChMD,IAAMoB,IAAI,GAAG;EACX;EACAC,EAAAA,OAAO,EAAE,EAFE;EAIX;EACAC,EAAAA,UAAU,EAAE,EALD;EAOX;EACAC,EAAAA,UAAU,EAAE,EARD;EAUX;EACAC,EAAAA,QAAQ,EAAE,EAXC;;EAaX;;;;;;;;;;;EAeA7C,EAAAA,aAAa,EAAEA,aA5BJ;EA8BXT,EAAAA,SAAS,EAAEA,SA9BA;EAgCX;EACAuD,EAAAA,kBAAkB,EAAE,CAAC,IAAD,EAAO,IAAP,CAjCT;EAmCX;EACA;EAEAC,EAAAA,SAAS,EAAE;EACT,SAAK,QADI;EAET,UAAM,WAFG;EAGT,UAAM,cAHG;EAIT,UAAM,SAJG;EAKT,UAAM,QALG;EAMT,UAAM,OANG;EAOT,SAAK,QAPI;EAQT,UAAM,UARG;EAST,WAAO,YATE;EAUT,SAAM,OAVG;EAWT,UAAO,OAXE;EAYT,SAAM,OAZG;EAaT,SAAK,OAbI;EAcT,SAAK,OAdI;EAeT,SAAK,WAfI;EAgBT,UAAM,UAhBG;EAiBT,UAAM;EAjBG,GAtCA;EAyDT;EACAC,EAAAA,YAAY,EAAE;EACZ,UAAM,UADM;EAEZ,WAAO,WAFK;EAGZ,WAAO,UAHK;EAIZ,YAAQ,WAJI;EAKZ,UAAM,SALM;EAMZ,WAAO;EANK,GA1DL;EAkEX;EACAC,EAAAA,aAAa,EAAE,GAnEJ;EAqEX;EACAC,EAAAA,WAAW,EAAE,IAtEF;EAwEX;EACAC,EAAAA,OAAO,EAAE,iBAASC,OAAT,EAAkBC,EAAlB,EAAsBC,OAAtB,EAA+B;EACtC;EACA;EACA,QAAMC,aAAa,GAAGD,OAAO,CAACE,uBAAR,CAAgCF,OAAO,CAACG,MAAxC,EAAgD,CAAhD,EAAmDJ,EAAnD,EAAuDC,OAAO,CAACI,IAAR,CAAaC,MAApE,CAAtB;EACA,QAAIC,GAAG,GAAG,KAAKC,IAAL,CAAUvE,KAAV,CAAgB,GAAhB,CAAV;EACA,QAAIwE,EAAE,GAAGF,GAAG,CAACA,GAAG,CAACxD,MAAJ,GAAa,CAAd,CAAZ;;EACA,QAAG,CAAC0D,EAAD,IAAOA,EAAE,KAAK,EAAjB,EAAoB;EAClB;EACA,WAAKC,IAAL,cAAUX,OAAV,mBAA0BG,aAA1B;EACD,KAHD,MAGO;EAAA;;EACL,UAAIS,GAAG,GAAGV,OAAO,CAACW,KAAlB;;EACA,iBAAAD,GAAG,CAACF,EAAD,CAAH,EAAQC,IAAR,iBAAaC,GAAb,mBAAyBT,aAAzB;EACD;EACF,GAtFU;EAwFX;EACA;EACAW,EAAAA,cAAc,EAAE,wBAASC,EAAT,EAAazE,KAAb,EAAoB;EAClC,QAAIA,KAAK,IAAI,IAAb,EAAmB;EACjB;EACA,UAAID,IAAI,GAAG,KAAKA,IAAhB;EACA,UAAI2E,IAAI,GAAGC,cAAc,CAACC,GAAf,CAAmBH,EAAE,CAACI,SAAtB,CAAX;;EACA,UAAG9E,IAAI,CAAC+E,MAAL,CAAY,CAAZ,EAAc,CAAd,MAAqB,GAAxB,EAA4B;EAAE/E,QAAAA,IAAI,GAAGA,IAAI,CAAC+E,MAAL,CAAY,CAAZ,CAAP;EAAwB;;EACtD,UAAGJ,IAAI,IAAIA,IAAI,CAACK,UAAb,IAA2BL,IAAI,CAACK,UAAL,CAAgBhF,IAAhB,MAA0BI,SAAxD,EAAkE;EAChE,YAAI6E,OAAO,GAAGN,IAAI,CAACK,UAAL,CAAgBhF,IAAhB,CAAd;EACA0E,QAAAA,EAAE,CAACO,OAAD,CAAF,GAAchF,KAAd;EACD,OAHD,MAGO;EACLyE,QAAAA,EAAE,CAACQ,YAAH,CAAgBlF,IAAhB,EAAsBC,KAAtB;EACD;EACF,KAXD,MAWO;EACLyE,MAAAA,EAAE,CAACS,eAAH,CAAmB,KAAKnF,IAAxB;EACD;EACF,GAzGU;EA2GX;EACAoF,EAAAA,SAAS,EAAE,mBAASC,OAAT,EAAkB;EAAA;;EAC3B,QAAI,CAACA,OAAL,EAAc;EACZ;EACD;;EACDC,IAAAA,MAAM,CAACC,IAAP,CAAYF,OAAZ,EAAqBjD,OAArB,CAA6B,UAAAoD,MAAM,EAAI;EACrC,UAAIvF,KAAK,GAAGoF,OAAO,CAACG,MAAD,CAAnB;;EAEA,UAAIlG,UAAU,CAAC0B,OAAX,CAAmBwE,MAAnB,IAA6B,CAAC,CAAlC,EAAqC;EACnCF,QAAAA,MAAM,CAACC,IAAP,CAAYtF,KAAZ,EAAmBmC,OAAnB,CAA2B,UAAAqD,GAAG,EAAI;EAChC,UAAA,KAAI,CAACD,MAAD,CAAJ,CAAaC,GAAb,IAAoBxF,KAAK,CAACwF,GAAD,CAAzB;EACD,SAFD;EAGD,OAJD,MAIO;EACL,QAAA,KAAI,CAACD,MAAD,CAAJ,GAAevF,KAAf;EACD;EACF,KAVD;EAWD,GA3HU;EA6HXyF,EAAAA,MAAM,EAAC;EA7HI,CAAb;;ECFA;EACA,SAASC,QAAT,CAAkBC,GAAlB,EAAuB;EACrB,SAAO,OAAOA,GAAP,KAAe,QAAf,IAA2BA,GAAG,KAAK,IAA1C;EACD;;;EAGD,SAASC,KAAT,CAAeC,OAAf,EAAwB;EACtB,QAAM,IAAIC,KAAJ,CAAU,gBAAgBD,OAA1B,CAAN;EACD;;EAED,IAAI1C,QAAJ;EACA,IAAI4C,UAAJ;EACA,IAAIxC,aAAJ;;EAGA,SAASyC,QAAT,CAAkBL,GAAlB,EAAuBM,OAAvB,EAAgCC,QAAhC,EAA0C;EACxC,OAAKD,OAAL,GAAeA,OAAf;EACA,OAAKC,QAAL,GAAgBA,QAAhB;EACA,OAAKC,UAAL,GAAkB,EAAlB;EACA,OAAKC,KAAL;EACA,OAAKT,GAAL,GAAW,KAAKU,aAAL,CAAmBV,GAAnB,CAAX;;EAEA,MAAID,QAAQ,CAAC,KAAKY,MAAL,GAAc,KAAKC,OAAL,EAAf,CAAZ,EAA4C;EAC1C,SAAKC,GAAL,CAAS,IAAT,EAAe,KAAKhB,GAApB,EAAyB,KAAKc,MAA9B,EAAsC,KAAKJ,QAA3C;EACD;EACF;;EAEDF,QAAQ,CAACS,aAAT,GAAyB,UAASrB,OAAT,EAAkB;EACzCjC,EAAAA,QAAQ,GAAGiC,OAAO,CAACjC,QAAnB;EACA4C,EAAAA,UAAU,GAAGV,MAAM,CAACC,IAAP,CAAYnC,QAAZ,CAAb;EACAI,EAAAA,aAAa,GAAG6B,OAAO,CAAC7B,aAAxB;EACD,CAJD;EAOA;;;EACAyC,QAAQ,CAACU,QAAT,GAAoB,UAAST,OAAT,EAAkBvE,IAAlB,EAAwB;EAC1C,MAAIjB,MAAM,GAAG,EAAb;EACA,MAAIkG,OAAO,GAAG;EAACC,IAAAA,CAAC,EAAElF,IAAJ;EAAUmF,IAAAA,IAAI,EAAE;EAAhB,GAAd;EACA,MAAIlG,KAAJ,EAAWmG,GAAX;;EAEA,OAAKnG,KAAK,GAAG,CAAb,EAAgBA,KAAK,GAAGsF,OAAO,CAACvF,MAAhC,EAAwCC,KAAK,EAA7C,EAAiD;EAC/CmG,IAAAA,GAAG,GAAGb,OAAO,CAACc,MAAR,CAAepG,KAAf,CAAN;;EAEA,QAAI,CAAC,CAAC,CAACoF,UAAU,CAAChF,OAAX,CAAmB+F,GAAnB,CAAP,EAAgC;EAC9BrG,MAAAA,MAAM,CAACO,IAAP,CAAY2F,OAAZ;EACAA,MAAAA,OAAO,GAAG;EAACC,QAAAA,CAAC,EAAEE,GAAJ;EAASD,QAAAA,IAAI,EAAE;EAAf,OAAV;EACD,KAHD,MAGO;EACLF,MAAAA,OAAO,CAACE,IAAR,IAAgBC,GAAhB;EACD;EACF;;EAEDrG,EAAAA,MAAM,CAACO,IAAP,CAAY2F,OAAZ;EACA,SAAOlG,MAAP;EACD,CAlBD;EAqBA;;;EACAuF,QAAQ,CAACgB,SAAT,CAAmBZ,KAAnB,GAA2B,YAAW;EACpC,MAAIS,IAAJ,EAAUnF,IAAV;;EAEA,MAAI,CAACqE,UAAU,CAACrF,MAAhB,EAAwB;EACtBkF,IAAAA,KAAK,CAAC,6CAAD,CAAL;EACD;;EAED,MAAI,CAAC,CAAC,CAACG,UAAU,CAAChF,OAAX,CAAmB,KAAKkF,OAAL,CAAa,CAAb,CAAnB,CAAP,EAA4C;EAC1CvE,IAAAA,IAAI,GAAG,KAAKuE,OAAL,CAAa,CAAb,CAAP;EACAY,IAAAA,IAAI,GAAG,KAAKZ,OAAL,CAAanB,MAAb,CAAoB,CAApB,CAAP;EACD,GAHD,MAGO;EACLpD,IAAAA,IAAI,GAAG6B,aAAP;EACAsD,IAAAA,IAAI,GAAG,KAAKZ,OAAZ;EACD;;EAED,OAAKxF,MAAL,GAAcuF,QAAQ,CAACU,QAAT,CAAkBG,IAAlB,EAAwBnF,IAAxB,CAAd;EACA,OAAK8D,GAAL,GAAW,KAAK/E,MAAL,CAAYwG,GAAZ,EAAX;EACD,CAjBD;EAoBA;;;EACAjB,QAAQ,CAACgB,SAAT,CAAmBT,OAAnB,GAA6B,YAAW;EACtC,MAAII,OAAO,GAAG,KAAKhB,GAAnB;EACA,MAAIuB,SAAS,GAAG,CAAC,CAAjB;EACA,MAAIC,IAAJ;EACA,MAAIC,KAAJ;;EAEA,OAAK,IAAIzG,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAKF,MAAL,CAAYC,MAAxC,EAAgDC,KAAK,EAArD,EAAyD;EACvDyG,IAAAA,KAAK,GAAG,KAAK3G,MAAL,CAAYE,KAAZ,CAAR;;EACA,QAAI+E,QAAQ,CAACiB,OAAD,CAAZ,EAAuB;EACrB,UAAI,OAAO,KAAKR,UAAL,CAAgBxF,KAAhB,CAAP,KAAkC,WAAtC,EAAmD;EACjD,YAAIgG,OAAO,MAAMQ,IAAI,GAAG,KAAKhB,UAAL,CAAgBxF,KAAhB,CAAb,CAAX,EAAiD;EAC/C,eAAK6F,GAAL,CAAS,KAAT,EAAgBY,KAAhB,EAAuBD,IAAvB,EAA6B,IAA7B;EACA,eAAKX,GAAL,CAAS,IAAT,EAAeY,KAAf,EAAsBT,OAAtB,EAA+B,IAA/B;EACA,eAAKR,UAAL,CAAgBxF,KAAhB,IAAyBgG,OAAzB;EACD;EACF,OAND,MAMO;EACL,aAAKH,GAAL,CAAS,IAAT,EAAeY,KAAf,EAAsBT,OAAtB,EAA+B,IAA/B;EACA,aAAKR,UAAL,CAAgBxF,KAAhB,IAAyBgG,OAAzB;EACD;;EAEDA,MAAAA,OAAO,GAAG,KAAK/B,GAAL,CAASwC,KAAT,EAAgBT,OAAhB,CAAV;EACD,KAbD,MAaO;EACL,UAAIO,SAAS,KAAK,CAAC,CAAnB,EAAsB;EACpBA,QAAAA,SAAS,GAAGvG,KAAZ;EACD;;EAED,UAAIwG,IAAI,GAAG,KAAKhB,UAAL,CAAgBxF,KAAhB,CAAX,EAAmC;EACjC,aAAK6F,GAAL,CAAS,KAAT,EAAgBY,KAAhB,EAAuBD,IAAvB,EAA6B,IAA7B;EACD;EACF;EACF;;EAED,MAAID,SAAS,KAAK,CAAC,CAAnB,EAAsB;EACpB,SAAKf,UAAL,CAAgBkB,MAAhB,CAAuBH,SAAvB;EACD;;EAED,SAAOP,OAAP;EACD,CArCD;;;EAwCAX,QAAQ,CAACgB,SAAT,CAAmBM,IAAnB,GAA0B,YAAW;EACnC,MAAIC,IAAJ,EAAUC,QAAV,EAAoBC,QAApB;;EAEA,MAAI,CAACF,IAAI,GAAG,KAAKhB,OAAL,EAAR,MAA4B,KAAKD,MAArC,EAA6C;EAC3C,QAAIZ,QAAQ,CAAC,KAAKY,MAAN,CAAZ,EAA2B;EACzB,WAAKE,GAAL,CAAS,KAAT,EAAgB,KAAKhB,GAArB,EAA0B,KAAKc,MAA/B,EAAuC,KAAKJ,QAA5C;EACD;;EAED,QAAIR,QAAQ,CAAC6B,IAAD,CAAZ,EAAoB;EAClB,WAAKf,GAAL,CAAS,IAAT,EAAe,KAAKhB,GAApB,EAAyB+B,IAAzB,EAA+B,KAAKrB,QAApC;EACD;;EAEDsB,IAAAA,QAAQ,GAAG,KAAKxH,KAAL,EAAX;EACA,SAAKsG,MAAL,GAAciB,IAAd;EACAE,IAAAA,QAAQ,GAAG,KAAKzH,KAAL,EAAX;EACA,QAAIyH,QAAQ,KAAKD,QAAb,IAAyBC,QAAQ,YAAYC,QAAjD,EAA2D,KAAKxB,QAAL,CAAcoB,IAAd;EAC5D,GAbD,MAaO,IAAIC,IAAI,YAAYI,KAApB,EAA2B;EAChC,SAAKzB,QAAL,CAAcoB,IAAd;EACD;EACF,CAnBD;EAsBA;;;EACAtB,QAAQ,CAACgB,SAAT,CAAmBhH,KAAnB,GAA2B,YAAW;EACpC,MAAI0F,QAAQ,CAAC,KAAKY,MAAN,CAAZ,EAA2B;EACzB,WAAO,KAAK1B,GAAL,CAAS,KAAKY,GAAd,EAAmB,KAAKc,MAAxB,CAAP;EACD;EACF,CAJD;EAOA;;;EACAN,QAAQ,CAACgB,SAAT,CAAmBY,QAAnB,GAA8B,UAAS5H,KAAT,EAAgB;EAC5C,MAAI0F,QAAQ,CAAC,KAAKY,MAAN,CAAZ,EAA2B;EACzBnD,IAAAA,QAAQ,CAAC,KAAKqC,GAAL,CAASoB,CAAV,CAAR,CAAqBJ,GAArB,CAAyB,KAAKF,MAA9B,EAAsC,KAAKd,GAAL,CAASqB,IAA/C,EAAqD7G,KAArD;EACD;EACF,CAJD;;;EAOAgG,QAAQ,CAACgB,SAAT,CAAmBpC,GAAnB,GAAyB,UAASY,GAAT,EAAcG,GAAd,EAAmB;EAC1C,SAAOxC,QAAQ,CAACqC,GAAG,CAACoB,CAAL,CAAR,CAAgBhC,GAAhB,CAAoBe,GAApB,EAAyBH,GAAG,CAACqB,IAA7B,CAAP;EACD,CAFD;;;EAKAb,QAAQ,CAACgB,SAAT,CAAmBR,GAAnB,GAAyB,UAASqB,MAAT,EAAiBrC,GAAjB,EAAsBG,GAAtB,EAA2BO,QAA3B,EAAqC;EAC5D,MAAI4B,MAAM,GAAGD,MAAM,GAAG,SAAH,GAAe,WAAlC;EACA1E,EAAAA,QAAQ,CAACqC,GAAG,CAACoB,CAAL,CAAR,CAAgBkB,MAAhB,EAAwBnC,GAAxB,EAA6BH,GAAG,CAACqB,IAAjC,EAAuCX,QAAvC;EACD,CAHD;;;EAOAF,QAAQ,CAACgB,SAAT,CAAmBe,SAAnB,GAA+B,YAAW;EACxC,MAAIpC,GAAJ;EACA,MAAIyB,KAAJ;;EAEA,OAAK,IAAIzG,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAKF,MAAL,CAAYC,MAAxC,EAAgDC,KAAK,EAArD,EAAyD;EACvDyG,IAAAA,KAAK,GAAG,KAAK3G,MAAL,CAAYE,KAAZ,CAAR;;EACA,QAAIgF,GAAG,GAAG,KAAKQ,UAAL,CAAgBxF,KAAhB,CAAV,EAAkC;EAChC,WAAK6F,GAAL,CAAS,KAAT,EAAgBY,KAAhB,EAAuBzB,GAAvB,EAA4B,IAA5B;EACD;EACF;;EAED,MAAID,QAAQ,CAAC,KAAKY,MAAN,CAAZ,EAA2B;EACzB,SAAKE,GAAL,CAAS,KAAT,EAAgB,KAAKhB,GAArB,EAA0B,KAAKc,MAA/B,EAAuC,KAAKJ,QAA5C;EACD;EACF,CAdD;EAgBA;;;EACAF,QAAQ,CAACgB,SAAT,CAAmBX,aAAnB,GAAmC,UAAUV,GAAV,EAAe;EAChD,MAAIqC,QAAJ,EAAcrB,OAAd;;EACA,MAAI,CAAChB,GAAG,CAACsC,OAAT,EAAkB;EAChB,WAAOtC,GAAP;EACD;;EAED,MAAI,KAAKlF,MAAL,CAAYC,MAAhB,EAAwB;EACtBsH,IAAAA,QAAQ,GAAG,KAAKvH,MAAL,CAAY,CAAZ,EAAeoG,IAA1B;EACD,GAFD,MAEO;EACLmB,IAAAA,QAAQ,GAAG,KAAKxC,GAAL,CAASqB,IAApB;EACD;;EAEDF,EAAAA,OAAO,GAAGhB,GAAV;;EACA,SAAOgB,OAAO,CAACsB,OAAR,IAAoBtB,OAAO,CAACqB,QAAD,CAAP,KAAsB7H,SAAjD,EAA6D;EAC3DwG,IAAAA,OAAO,GAAGA,OAAO,CAACsB,OAAlB;EACD;;EAED,SAAOtB,OAAP;EACD,CAlBD;;ECtLA,SAASuB,aAAT,CAAuBzD,EAAvB,EAA2B;EACzB,MAAIlC,OAAO,GAAG,EAAd;;EACA,MAAIkC,EAAE,CAAC1E,IAAH,KAAY,UAAhB,EAA4B;EAC1B,WAAO0E,EAAE,CAAC0D,OAAV;EACD,GAFD,MAEO,IAAI1D,EAAE,CAAC1E,IAAH,KAAY,iBAAhB,EAAmC;EACxC0E,IAAAA,EAAE,CAACW,OAAH,CAAWjD,OAAX,CAAmB,UAAAoD,MAAM,EAAI;EAC3B,UAAIA,MAAM,CAAC6C,QAAX,EAAqB;EACnB7F,QAAAA,OAAO,CAACvB,IAAR,CAAauE,MAAM,CAACvF,KAApB;EACD;EACF,KAJD;EAMA,WAAOuC,OAAP;EACD,GARM,MAQA;EACL,WAAOkC,EAAE,CAACzE,KAAV;EACD;EACF;;EAED,IAAMqI,cAAc,GAAG,4CAAvB;EACA,IAAMC,eAAe,GAAG,KAAxB;EACA,IAAMC,QAAQ,GAAG,QAAjB;;AAGA,MAAaC,OAAb;EAAA;EAAA;EACE;EACA;EACA;EACA,mBAAYxE,IAAZ,EAAkBS,EAAlB,EAAsB1E,IAAtB,EAA4BkG,OAA5B,EAAqCwC,MAArC,EAA6CC,GAA7C,EAAkDzF,UAAlD,EAA8D;EAC5D,SAAKe,IAAL,GAAYA,IAAZ;EACA,SAAKS,EAAL,GAAUA,EAAV;EACA,SAAK1E,IAAL,GAAYA,IAAZ;EACA,SAAKkG,OAAL,GAAeA,OAAf;EACA,SAAKwC,MAAL,GAAcA,MAAd;EACA,SAAKC,GAAL,GAAWA,GAAX;EACA,SAAKzF,UAAL,GAAkBA,UAAlB;EACA,SAAK0F,kBAAL,GAA0B,EAA1B;EACA,SAAKpE,KAAL,GAAapE,SAAb,CAT4D;;EAY5D,SAAK4D,MAAL,GAAc,EAAd,CAZ4D;;EAc5D,SAAK6E,WAAL,GAAmB,EAAnB,CAd4D;;EAgB5D,SAAKC,MAAL,GAAc,KAAd,CAhB4D;;EAkB5D,SAAKC,SAAL,GAAiB,EAAjB;EACD,GAvBH;;;EAAA;;EAAA,SA0BEC,OA1BF,GA0BE,iBAAQpD,GAAR,EAAaM,OAAb,EAAsB;EACpB,WAAO,IAAID,QAAJ,CAAaL,GAAb,EAAkBM,OAAlB,EAA2B,IAA3B,CAAP;EACD,GA5BH;;EAAA,SA8BE+C,WA9BF,GA8BE,uBAAc;EACZ,QAAI,KAAK/C,OAAT,EAAkB;EAChB,UAAImB,KAAK,GAAGvH,SAAS,CAAC,KAAKoG,OAAN,CAArB;;EAEA,UAAImB,KAAK,CAACrH,IAAN,KAAe,CAAnB,EAAsB;EACpB,aAAKC,KAAL,GAAaoH,KAAK,CAACpH,KAAnB;EACD,OAFD,MAEO;EACL,YAAIuI,QAAQ,CAACtI,IAAT,CAAc,KAAKgG,OAAnB,CAAJ,EAAiC;EAC/B,cAAIgD,MAAM,GAAG7H,WAAW,CAAC,KAAK6E,OAAN,CAAxB;;EACA,cAAIgD,MAAJ,EAAY;EACV,iBAAKhD,OAAL,GAAegD,MAAM,CAACrH,CAAtB;EACA,iBAAKmC,MAAL,GAAckF,MAAM,CAACtH,CAAP,CAASuH,GAAT,CAAa,UAAAC,CAAC;EAAA,qBAAIA,CAAC,CAACvH,CAAN;EAAA,aAAd,CAAd,CAFU;EAIV;EACD;EACF;;EACD,aAAKwH,QAAL,GAAgB,KAAKL,OAAL,CAAa,KAAK/E,IAAL,CAAUC,MAAvB,EAA+B,KAAKgC,OAApC,CAAhB;EACA,aAAK1B,KAAL,GAAa,KAAK6E,QAAL,CAAc9C,MAA3B;EACD;EACF,KAlBD,MAkBO;EACL,WAAKtG,KAAL,GAAaG,SAAb;EACD;EACF,GApDH;;EAAA,SAsDE2D,uBAtDF,GAsDE,iCAAwB7B,IAAxB,EAA8BoH,cAA9B,EAA8C1F,EAA9C,EAAkD2F,EAAlD,EAAsD;EAAA;;EACpD,WAAOrH,IAAI,CAACiH,GAAL,CAASrJ,SAAT,EAAoBqJ,GAApB,CAAwB,gBAAkBK,EAAlB,EAAyB;EAAA,UAAtBxJ,IAAsB,QAAtBA,IAAsB;EAAA,UAAhBC,KAAgB,QAAhBA,KAAgB;;EACtD,UAAID,IAAI,KAAK,CAAb,EAAgB;EACd,eAAOC,KAAP;EACD,OAFD,MAEO,IAAIA,KAAK,KAAK,KAAd,EAAqB;EAAE;EAC1B,eAAO2D,EAAP;EACH,OAFM,MAEA,IAAI3D,KAAK,KAAK,KAAd,EAAqB;EAAE;EAC1B,eAAOsJ,EAAP;EACH,OAFM,MAEA,IAAItJ,KAAK,KAAK,KAAd,EAAqB;EAAE;EAC1B,eAAO,KAAI,CAACyE,EAAZ;EACH,OAFM,MAEA;EACL,YAAI,CAAC,KAAI,CAACkE,kBAAL,CAAwBU,cAAxB,CAAL,EAA8C;EAC5C,UAAA,KAAI,CAACV,kBAAL,CAAwBU,cAAxB,IAA0C,EAA1C;EACD;;EAED,YAAID,QAAQ,GAAG,KAAI,CAACT,kBAAL,CAAwBU,cAAxB,EAAwCE,EAAxC,CAAf;;EAEA,YAAI,CAACH,QAAL,EAAe;EACbA,UAAAA,QAAQ,GAAG,KAAI,CAACL,OAAL,CAAa,KAAI,CAAC/E,IAAL,CAAUC,MAAvB,EAA+BjE,KAA/B,CAAX;EACA,UAAA,KAAI,CAAC2I,kBAAL,CAAwBU,cAAxB,EAAwCE,EAAxC,IAA8CH,QAA9C;EACD;;EAED,eAAOA,QAAQ,CAACpJ,KAAT,EAAP;EACD;EACF,KAvBM,CAAP;EAwBD,GA/EH;EAkFE;EAlFF;;EAAA,SAmFEwJ,cAnFF,GAmFE,wBAAexJ,KAAf,EAAsB;EAAA;;EACpB,WAAO,KAAKiD,UAAL,CAAgBwG,MAAhB,CAAuB,UAACC,MAAD,EAASC,WAAT,EAAsBhJ,KAAtB,EAAgC;EAC5D,UAAIsB,IAAI,GAAG0H,WAAW,CAAChH,KAAZ,CAAkB0F,cAAlB,CAAX;EACA,UAAIuB,EAAE,GAAG3H,IAAI,CAAC4H,KAAL,EAAT;EACA,UAAIC,SAAS,GAAG,MAAI,CAAC9F,IAAL,CAAUoB,OAAV,CAAkBnC,UAAlB,CAA6B2G,EAA7B,CAAhB;;EAEA,UAAM/F,aAAa,GAAG,MAAI,CAACC,uBAAL,CAA6B7B,IAA7B,EAAmCtB,KAAnC,EAA0C,IAA1C,EAAgD,MAAI,CAACqD,IAAL,CAAUC,MAA1D,CAAtB;;EAEA,UAAI6F,SAAS,IAAIA,SAAS,CAACC,IAAV,YAA0BrC,QAA3C,EAAqD;EACnDgC,QAAAA,MAAM,GAAGI,SAAS,CAACC,IAAV,OAAAD,SAAS,GAAMJ,MAAN,SAAiB7F,aAAjB,EAAlB;EACD,OAFD,MAEO,IAAIiG,SAAS,YAAYpC,QAAzB,EAAmC;EACxCgC,QAAAA,MAAM,GAAGI,SAAS,MAAT,UAAUJ,MAAV,SAAqB7F,aAArB,EAAT;EACD;;EACD,aAAO6F,MAAP;EACD,KAbM,EAaJ1J,KAbI,CAAP;EAcD,GAlGH;EAAA;;EAAA,SAqGEgK,YArGF,GAqGE,sBAAa5F,EAAb,EAAiB;EACf,QAAIR,OAAO,GAAG,IAAd;EACA,QAAIH,OAAO,GAAGG,OAAO,CAACI,IAAR,CAAaoB,OAAb,CAAqB3B,OAAnC;EACA,QAAIwG,GAAG,GAAG7F,EAAV;EAEA,QAAIrE,IAAI,GAAG,KAAKA,IAAhB;EACA,QAAI0E,EAAE,GAAG,KAAKA,EAAd;;EACA,QAAG1E,IAAI,CAAC+E,MAAL,CAAY,CAAZ,EAAc,CAAd,MAAqB,GAAxB,EAA4B;EAAE/E,MAAAA,IAAI,GAAGA,IAAI,CAAC+E,MAAL,CAAY,CAAZ,CAAP;EAAwB;;EACtD,QAAGL,EAAE,CAACyF,WAAH,IAAkBzF,EAAE,CAACyF,WAAH,CAAenF,UAAjC,IAA+CN,EAAE,CAACyF,WAAH,CAAenF,UAAf,CAA0BhF,IAA1B,MAAoCI,SAAtF,EAAgG;EAC9F,UAAI6E,OAAO,GAAGP,EAAE,CAACyF,WAAH,CAAenF,UAAf,CAA0BhF,IAA1B,CAAd;EACA0E,MAAAA,EAAE,CAACO,OAAD,CAAF,GAAciF,GAAd;EACD,KAHD,MAGO;EACL,aAAO,UAAStG,EAAT,EAAa;EAClBsG,QAAAA,GAAG,IAAIxG,OAAO,CAACY,IAAR,CAAa4F,GAAb,EAAkB,IAAlB,EAAwBtG,EAAxB,EAA4BC,OAA5B,CAAP;EACD,OAFD;EAGD;EACF,GArHH;EAwHE;EAxHF;;EAAA,SAyHE4C,GAzHF,GAyHE,aAAIxG,KAAJ,EAAW;EACT,QAAIA,KAAK,YAAY0H,QAAjB,IAA6B,CAAC,KAAKe,MAAL,CAAY0B,QAA9C,EAAwD;EAAA;;EACtD;EACA,UAAMtG,aAAa,GAAG,KAAKC,uBAAL,CAA6B,KAAKC,MAAlC,EAA0C,CAA1C,EAA6C,IAA7C,EAAmD,KAAKC,IAAL,CAAUC,MAA7D,CAAtB;EACAjE,MAAAA,KAAK,GAAG,KAAKwJ,cAAL,CACN,UAAAxJ,KAAK,EAACqE,IAAN,gBAAW,KAAKE,KAAhB,mBAA8BV,aAA9B,GADM,CAAR,CAHsD;EAOvD,KAPD,MAOO;EACL7D,MAAAA,KAAK,GAAG,KAAKwJ,cAAL,CAAoBxJ,KAApB,CAAR;EACD;;EAED,QAAIoK,SAAS,GAAG,KAAK3B,MAAL,CAAY4B,OAAZ,IAAuB,KAAK5B,MAA5C;;EAEA,QAAI2B,SAAS,YAAY1C,QAAzB,EAAmC;EACjC0C,MAAAA,SAAS,CAAC/F,IAAV,CAAe,IAAf,EAAqB,KAAKI,EAA1B,EAA8BzE,KAA9B;EACA,WAAKsK,eAAL,CAAqBtK,KAArB;EACD;EACF,GA3IH;EAAA;;EAAA,SA8IEsH,IA9IF,GA8IE,gBAAO;EACL,QAAI,KAAK8B,QAAT,EAAmB;EACjB,WAAK7E,KAAL,GAAa,KAAK6E,QAAL,CAAc9C,MAA3B;EACA,WAAKE,GAAL,CAAS,KAAK4C,QAAL,CAAcpJ,KAAd,EAAT;EACD,KAHD,MAGO;EACL,WAAKwG,GAAL,CAAS,KAAKxG,KAAd;EACD;EACF,GArJH;EAAA;;EAAA,SAwJEuK,OAxJF,GAwJE,mBAAU;EAAA;;EACR,QAAI,KAAKnB,QAAT,EAAmB;EACjB,UAAIpJ,KAAK,GAAG,KAAKiD,UAAL,CAAgBuH,WAAhB,CAA4B,UAACd,MAAD,EAASC,WAAT,EAAsBhJ,KAAtB,EAAgC;EACtE,YAAMsB,IAAI,GAAG0H,WAAW,CAAC/J,KAAZ,CAAkB0I,eAAlB,CAAb;EACA,YAAMsB,EAAE,GAAG3H,IAAI,CAAC4H,KAAL,EAAX;EACA,YAAMC,SAAS,GAAG,MAAI,CAAC9F,IAAL,CAAUoB,OAAV,CAAkBnC,UAAlB,CAA6B2G,EAA7B,CAAlB;;EACA,YAAM/F,aAAa,GAAG,MAAI,CAACC,uBAAL,CAA6B7B,IAA7B,EAAmCtB,KAAnC,EAA0C,IAA1C,EAAgD,MAAI,CAACqD,IAAL,CAAUC,MAA1D,CAAtB;;EAEA,YAAI6F,SAAS,IAAIA,SAAS,CAACS,OAA3B,EAAoC;EAClCb,UAAAA,MAAM,GAAGI,SAAS,CAACS,OAAV,OAAAT,SAAS,GAASJ,MAAT,SAAoB7F,aAApB,EAAlB;EACD;;EACD,eAAO6F,MAAP;EACD,OAVW,EAUT,KAAKe,QAAL,CAAc,KAAKhG,EAAnB,CAVS,CAAZ;EAYA,WAAK2E,QAAL,CAAcxB,QAAd,CAAuB5H,KAAvB;EACD;EACF,GAxKH;EA2KE;EACA;EA5KF;;EAAA,SA6KE0K,IA7KF,GA6KE,gBAAO;EACL,SAAK1B,WAAL;;EAEA,QAAI,KAAKP,MAAL,CAAYkC,cAAZ,CAA2B,MAA3B,CAAJ,EAAwC;EACtC,WAAKlC,MAAL,CAAYiC,IAAZ,CAAiBrG,IAAjB,CAAsB,IAAtB,EAA4B,KAAKI,EAAjC;EACD;;EAED,QAAI,KAAKT,IAAL,CAAUoB,OAAV,CAAkB5B,WAAtB,EAAmC;EACjC,WAAK8D,IAAL;EACD;EACF,GAvLH;EAAA;;EAAA,SA0LEsD,MA1LF,GA0LE,kBAAS;EAAA;;EACP,QAAI,KAAKnC,MAAL,CAAYmC,MAAhB,EAAwB;EACtB,WAAKnC,MAAL,CAAYmC,MAAZ,CAAmBvG,IAAnB,CAAwB,IAAxB,EAA8B,KAAKI,EAAnC;EACD;;EAED,QAAI,KAAK2E,QAAT,EAAmB;EACjB,WAAKA,QAAL,CAAcrB,SAAd;EACD;;EAED1C,IAAAA,MAAM,CAACC,IAAP,CAAY,KAAKqD,kBAAjB,EAAqCxG,OAArC,CAA6C,UAAA0I,EAAE,EAAI;EACjD,UAAI5I,IAAI,GAAG,MAAI,CAAC0G,kBAAL,CAAwBkC,EAAxB,CAAX;EAEAxF,MAAAA,MAAM,CAACC,IAAP,CAAYrD,IAAZ,EAAkBE,OAAlB,CAA0B,UAAAoH,EAAE,EAAI;EAC9BtH,QAAAA,IAAI,CAACsH,EAAD,CAAJ,CAASxB,SAAT;EACD,OAFD;EAGD,KAND;EAQA,SAAKY,kBAAL,GAA0B,EAA1B;EACD,GA5MH;EA+ME;EA/MF;;EAAA,SAgNEmC,MAhNF,GAgNE,gBAAO7G,MAAP,EAAoB;EAAA,QAAbA,MAAa;EAAbA,MAAAA,MAAa,GAAJ,EAAI;EAAA;;EAClB,QAAI,KAAKmF,QAAT,EAAmB;EACjB,WAAK7E,KAAL,GAAa,KAAK6E,QAAL,CAAc9C,MAA3B;EACD;;EAED,QAAI,KAAKmC,MAAL,CAAYqC,MAAhB,EAAwB;EACtB,WAAKrC,MAAL,CAAYqC,MAAZ,CAAmBzG,IAAnB,CAAwB,IAAxB,EAA8BJ,MAA9B;EACD;EACF,GAxNH;EAAA;;EAAA,SA2NEwG,QA3NF,GA2NE,kBAAShG,EAAT,EAAa;EACX,QAAI,KAAKgE,MAAL,IAAe,KAAKA,MAAL,CAAYgC,QAA/B,EAAyC;EACvC,aAAO,KAAKhC,MAAL,CAAYgC,QAAZ,CAAqBpG,IAArB,CAA0B,IAA1B,EAAgCI,EAAhC,CAAP;EACD,KAFD,MAEO;EACL,aAAOyD,aAAa,CAACzD,EAAD,CAApB;EACD;EACF,GAjOH;EAAA;;EAAA,SAoOEsG,SApOF,GAoOE,mBAAUC,QAAV,EAAoB;EAClB,QAAIrK,KAAK,GAAG,KAAKiI,WAAL,CAAiB5H,IAAjB,CAAsBgK,QAAtB,IAAiC,CAA7C,CADkB;;EAIlB,WAAO;EACLC,MAAAA,MAAM,EAAE,kBAAW;EACjB,eAAO,KAAKrC,WAAL,CAAiBjI,KAAjB,CAAP;EACD;EAHI,KAAP;EAKD,GA7OH;EAAA;;EAAA,SAgPE2J,eAhPF,GAgPE,yBAAgBtK,KAAhB,EAAsB;EAClB;EACA,SAAK4I,WAAL,CAAiBzG,OAAjB,CAAyB,UAAS+I,IAAT,EAAe;EACtCA,MAAAA,IAAI,CAAClL,KAAD,CAAJ;EACH,KAFC;EAGH,GArPH;EAAA;;EAAA,SAwPEmL,IAxPF,GAwPE,cAAKC,OAAL,EAAa;EACX;EACA,QAAGA,OAAO,KAAKjL,SAAf,EAA0B;EACxB,aAAO,KAAK0I,MAAZ;EACD,KAFD,MAEQ,IAAG,KAAKA,MAAL,KAAgB,IAAhB,IAAwBuC,OAAO,KAAK,IAAvC,EAA6C;EACnD;EACA,aAAO,KAAP;EACD;;EAED,WAAO,KAAKvC,MAAL,GAAcuC,OAArB;EACD,GAlQH;EAAA;;EAAA,SAqQEC,IArQF,GAqQE,gBAAM;EAAA;;EACJ,WAAO,KAAKrH,IAAL,CAAUsH,QAAV,CAAmBC,MAAnB,CAA0B,UAACpC,CAAD,EAAM;EAAC,aAAOA,CAAC,CAAC1E,EAAF,KAAS,MAAI,CAACA,EAArB;EAAwB,KAAzD,CAAP;EACD,GAvQH;EAAA;;EAAA,SAyQE+G,GAzQF,GAyQE,aAAIzL,IAAJ,EAAS;EACP,QAAI0L,UAAU,GAAG1I,IAAI,CAACM,SAAL,CAAetD,IAAf,KAAwBA,IAAzC;EAEA,WAAO,KAAKsL,IAAL,GAAYK,IAAZ,CAAiB,UAACvC,CAAD,EAAM;EAAC,aAAOA,CAAC,CAACpJ,IAAF,KAAW0L,UAAlB;EAA8B,KAAtD,CAAP;EACD,GA7QH;;EAAA;EAAA;;ECrBA,IAAME,UAAU,GAAG;EACjBtB,EAAAA,OAAO,EAAE,iBAACnI,IAAD,EAAOlC,KAAP,EAAiB;EACxBkC,IAAAA,IAAI,CAAC0J,IAAL,GAAa5L,KAAK,IAAI,IAAV,GAAkBA,KAAlB,GAA0B,EAAtC;EACD;EAHgB,CAAnB;EAMA,IAAM6L,iBAAiB,GAAG,8DAA1B;AACA,EAEA,IAAMC,cAAc,GAAG,eAAelM,KAAf,CAAqB,EAArB,CAAvB;;EAGA,IAAMmM,SAAS,GAAG,SAAZA,SAAY,CAAC/H,IAAD,EAAO9B,IAAP,EAAgB;EAChC,MAAI8J,KAAK,GAAG,KAAZ;;EAEA,MAAI9J,IAAI,CAAC+J,QAAL,KAAkB,CAAtB,EAAyB;EACvB,QAAIxL,MAAM,GAAGH,aAAa,CAAC4B,IAAI,CAAC0J,IAAN,EAAY7I,IAAI,CAACK,kBAAjB,CAA1B;;EAEA,QAAI3C,MAAJ,EAAY;EACV,WAAK,IAAImG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnG,MAAM,CAACC,MAA3B,EAAmCkG,CAAC,EAApC,EAAwC;EACtC,YAAIQ,KAAK,GAAG3G,MAAM,CAACmG,CAAD,CAAlB;EACA,YAAIsF,IAAI,GAAGC,QAAQ,CAACC,cAAT,CAAwBhF,KAAK,CAACpH,KAA9B,CAAX;EACAkC,QAAAA,IAAI,CAACmK,UAAL,CAAgBC,YAAhB,CAA6BJ,IAA7B,EAAmChK,IAAnC;;EAEA,YAAIkF,KAAK,CAACrH,IAAN,KAAe,CAAnB,EAAsB;EACpBiE,UAAAA,IAAI,CAACuI,YAAL,CAAkBL,IAAlB,EAAwB,IAAxB,EAA8B9E,KAAK,CAACpH,KAApC,EAA2C2L,UAA3C,EAAuD,IAAvD;EACD;EACF;;EAEDzJ,MAAAA,IAAI,CAACmK,UAAL,CAAgBG,WAAhB,CAA4BtK,IAA5B;EACD;;EACD8J,IAAAA,KAAK,GAAG,IAAR;EACD,GAjBD,MAiBO,IAAI9J,IAAI,CAAC+J,QAAL,KAAkB,CAAtB,EAAyB;EAC9BD,IAAAA,KAAK,GAAGhI,IAAI,CAACyI,QAAL,CAAcvK,IAAd,CAAR;EACD;;EAED,MAAI,CAAC8J,KAAL,EAAY;EACV,SAAK,IAAIpF,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAG1E,IAAI,CAACwK,UAAL,CAAgBhM,MAApC,EAA4CkG,EAAC,EAA7C,EAAiD;EAC/CmF,MAAAA,SAAS,CAAC/H,IAAD,EAAO9B,IAAI,CAACwK,UAAL,CAAgB9F,EAAhB,CAAP,CAAT;EACD;EACF;EACF,CA7BD;;EA+BA,IAAM+F,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,CAAD,EAAIC,CAAJ,EAAU;EAClC,MAAIC,SAAS,GAAGF,CAAC,CAACnE,MAAF,GAAYmE,CAAC,CAACnE,MAAF,CAASsE,QAAT,IAAqB,CAAjC,GAAsC,CAAtD;EACA,MAAIC,SAAS,GAAGH,CAAC,CAACpE,MAAF,GAAYoE,CAAC,CAACpE,MAAF,CAASsE,QAAT,IAAqB,CAAjC,GAAsC,CAAtD;EACA,SAAOC,SAAS,GAAGF,SAAnB;EACD,CAJD;;EAMA,IAAMG,OAAO,GAAG,SAAVA,OAAU,CAACC,GAAD,EAAS;EACvB,SAAOA,GAAG,CAAC/L,IAAJ,EAAP;EACD,CAFD;;;MAKqBgM;;;EACnB;EACA;EACA;EACA,gBAAYC,GAAZ,EAAiBnJ,MAAjB,EAAyBmB,OAAzB,EAAkC;EAChC,QAAIgI,GAAG,CAACC,MAAJ,IAAcD,GAAG,YAAYzF,KAAjC,EAAwC;EACtC,WAAKyF,GAAL,GAAWA,GAAX;EACD,KAFD,MAEO;EACL,WAAKA,GAAL,GAAW,CAACA,GAAD,CAAX;EACD;;EAED,SAAKnJ,MAAL,GAAcA,MAAd;EACA,SAAKmB,OAAL,GAAeA,OAAf;EAEA,SAAKkI,KAAL;EACD;;;;WAGDf,eAAA,sBAAarK,IAAb,EAAmBnC,IAAnB,EAAyB4J,WAAzB,EAAsClB,MAAtC,EAA8CC,GAA9C,EAAmD;EACjD,QAAI6E,KAAK,GAAG5D,WAAW,CAAChH,KAAZ,CAAkBkJ,iBAAlB,EAAqC3C,GAArC,CAAyC+D,OAAzC,CAAZ;EAEA,QAAIhH,OAAO,GAAGsH,KAAK,CAAC1D,KAAN,EAAd;;EAEA,QAAGnB,GAAG,KAAK,EAAR,IAAc3I,IAAI,KAAK,GAA1B,EAA8B;EAC5B;EACA,UAAMyN,KAAK,GAAG,IAAI/L,MAAJ,CAAW,gCAAX,CAAd;EACA,UAAIgM,MAAM,GAAGD,KAAK,CAACzL,IAAN,CAAWkE,OAAX,CAAb,CAH4B;;EAK5B,UAAGwH,MAAM,IAAIA,MAAM,CAAC/M,MAAP,GAAgB,CAA7B,EAA+B;EAC7BgI,QAAAA,GAAG,GAAG+E,MAAM,CAAC,CAAD,CAAN,IAAa/E,GAAnB;EACAzC,QAAAA,OAAO,GAAGwH,MAAM,CAAC,CAAD,CAAN,IAAaxH,OAAvB;EACD,OAR2B;;EAU7B;;EAED,SAAKqF,QAAL,CAActK,IAAd,CAAmB,IAAIwH,OAAJ,CAAY,IAAZ,EAAkBtG,IAAlB,EAAwBnC,IAAxB,EAA8BkG,OAA9B,EAAuCwC,MAAvC,EAA+CC,GAA/C,EAAoD6E,KAApD,CAAnB;EACD;EAGD;;;WACAD,QAAA,iBAAQ;EACN,SAAKhC,QAAL,GAAgB,EAAhB;EAEA,QAAIoC,QAAQ,GAAG,KAAKN,GAApB;EAAA,QAAyBxG,CAAzB;EAAA,QAA4B+G,GAA5B;;EACA,SAAK/G,CAAC,GAAG,CAAJ,EAAO+G,GAAG,GAAGD,QAAQ,CAAChN,MAA3B,EAAmCkG,CAAC,GAAG+G,GAAvC,EAA4C/G,CAAC,EAA7C,EAAiD;EAC/CmF,MAAAA,SAAS,CAAC,IAAD,EAAO2B,QAAQ,CAAC9G,CAAD,CAAf,CAAT;EACD;;EAED,SAAK0E,QAAL,CAAcsC,IAAd,CAAmBjB,iBAAnB;EACD;;WAEDF,WAAA,kBAASvK,IAAT,EAAe;EACb;EACA,QAAI8J,KAAK,GAAG9J,IAAI,CAAC2L,QAAL,KAAkB,QAAlB,IAA8B3L,IAAI,CAAC2L,QAAL,KAAkB,OAA5D;EACA,QAAIC,UAAU,GAAG5L,IAAI,CAAC4L,UAAtB;EACA,QAAIC,SAAS,GAAG,EAAhB;EACA,QAAIC,UAAU,GAAG,KAAK5I,OAAL,CAAa4I,UAA9B;EACA,QAAIC,YAAJ;EACA,QAAIC,UAAJ,EAAgBzF,MAAhB,EAAwB0F,UAAxB,EAAoCzF,GAApC;;EAEA,SAAK,IAAI9B,CAAC,GAAG,CAAR,EAAW+G,GAAG,GAAGG,UAAU,CAACpN,MAAjC,EAAyCkG,CAAC,GAAG+G,GAA7C,EAAkD/G,CAAC,EAAnD,EAAuD;EACrD,UAAIwH,SAAS,GAAGN,UAAU,CAAClH,CAAD,CAA1B,CADqD;;EAGrD,UAAI,KAAKyH,eAAL,CAAqBD,SAAS,CAACjK,IAA/B,CAAJ,EAA0C;EACtC;EACA8J,QAAAA,YAAY,GAAGlL,IAAI,CAACM,SAAL,CAAe+K,SAAS,CAACjK,IAAzB,CAAf;EACA+J,QAAAA,UAAU,GAAGD,YAAY,IAAIG,SAAS,CAACjK,IAAvC,CAHsC;;EAMxCsE,QAAAA,MAAM,GAAG,KAAKrD,OAAL,CAAapC,OAAb,CAAqBkL,UAArB,CAAT;EACAxF,QAAAA,GAAG,GAAGvI,SAAN;;EAEA,YAAI,CAACsI,MAAL,EAAa;EACX,eAAK,IAAI7G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoM,UAAU,CAACtN,MAA/B,EAAuCkB,CAAC,EAAxC,EAA4C;EAC1CuM,YAAAA,UAAU,GAAGH,UAAU,CAACpM,CAAD,CAAvB;;EACA,gBAAIsM,UAAU,CAAChO,KAAX,CAAiB,CAAjB,EAAoBiO,UAAU,CAACzN,MAAX,GAAoB,CAAxC,MAA+CyN,UAAU,CAACjO,KAAX,CAAiB,CAAjB,EAAoB,CAAC,CAArB,CAAnD,EAA4E;EAC1EuI,cAAAA,MAAM,GAAG,KAAKrD,OAAL,CAAapC,OAAb,CAAqBmL,UAArB,CAAT;EACAzF,cAAAA,GAAG,GAAGwF,UAAU,CAAChO,KAAX,CAAiBiO,UAAU,CAACzN,MAAX,GAAoB,CAArC,CAAN;EACA;EACD;EACF;EACF;;EAED,YAAI,CAAC+H,MAAL,EAAa;EACXA,UAAAA,MAAM,GAAG1F,IAAI,CAACyB,cAAd;EACD;;EAED,YAAIiE,MAAM,CAACuD,KAAX,EAAkB;EAChB,eAAKO,YAAL,CAAkBrK,IAAlB,EAAwBgM,UAAxB,EAAoCE,SAAS,CAACpO,KAA9C,EAAqDyI,MAArD,EAA6DC,GAA7D;EACAxG,UAAAA,IAAI,CAACgD,eAAL,CAAqBkJ,SAAS,CAACjK,IAA/B;EACA,iBAAO,IAAP;EACD;;EAED4J,QAAAA,SAAS,CAAC/M,IAAV,CAAe;EAACsN,UAAAA,IAAI,EAAEF,SAAP;EAAkB3F,UAAAA,MAAM,EAAEA,MAA1B;EAAkC1I,UAAAA,IAAI,EAAEmO,UAAxC;EAAoDxF,UAAAA,GAAG,EAAEA;EAAzD,SAAf;EACD;EACF;;EAED,SAAK,IAAI9B,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGmH,SAAS,CAACrN,MAA9B,EAAsCkG,GAAC,EAAvC,EAA2C;EACzC,UAAI2H,QAAQ,GAAGR,SAAS,CAACnH,GAAD,CAAxB;EACA,WAAK2F,YAAL,CAAkBrK,IAAlB,EAAwBqM,QAAQ,CAACxO,IAAjC,EAAuCwO,QAAQ,CAACD,IAAT,CAActO,KAArD,EAA4DuO,QAAQ,CAAC9F,MAArE,EAA6E8F,QAAQ,CAAC7F,GAAtF;EACAxG,MAAAA,IAAI,CAACgD,eAAL,CAAqBqJ,QAAQ,CAACD,IAAT,CAAcnK,IAAnC;EACD;;EAED,QAAIpB,IAAI,CAACG,UAAL,CAAgBgL,UAAhB,KAA+B,CAAChM,IAAI,CAACsM,MAAzC,EAAiD;EAC9C,WAAKlD,QAAL,CAActK,IAAd,CAAmB,IAAIyN,gBAAJ,CAAqB,IAArB,EAA2BvM,IAA3B,EAAiCgM,UAAjC,CAAnB;EACAlC,MAAAA,KAAK,GAAG,IAAR;EACF;;EAED,WAAOA,KAAP;EACD;;;WAGDtB,OAAA,gBAAO;EACL,SAAKY,QAAL,CAAcnJ,OAAd,CAAsB,UAAAyB,OAAO,EAAI;EAC/BA,MAAAA,OAAO,CAAC8G,IAAR;EACD,KAFD;EAGD;;;WAGDE,SAAA,kBAAS;EACP,SAAKU,QAAL,CAAcnJ,OAAd,CAAsB,UAAAyB,OAAO,EAAI;EAC/BA,MAAAA,OAAO,CAACgH,MAAR;EACD,KAFD;EAGD;;;WAGDtD,OAAA,gBAAO;EACL,SAAKgE,QAAL,CAAcnJ,OAAd,CAAsB,UAAAyB,OAAO,EAAI;EAC/BA,MAAAA,OAAO,CAAC0D,IAAR;EACD,KAFD;EAGD;;;WAGDiD,UAAA,mBAAU;EACR,SAAKe,QAAL,CAAcnJ,OAAd,CAAsB,UAAAyB,OAAO,EAAI;EAC/B,UAAIA,OAAO,CAAC6E,MAAR,IAAkB7E,OAAO,CAAC6E,MAAR,CAAeiG,SAArC,EAAgD;EAC9C9K,QAAAA,OAAO,CAAC2G,OAAR;EACD;EACF,KAJD;EAKD;;;WAGDO,SAAA,gBAAO7G,MAAP,EAAoB;EAAA;;EAAA,QAAbA,MAAa;EAAbA,MAAAA,MAAa,GAAJ,EAAI;EAAA;;EAClBoB,IAAAA,MAAM,CAACC,IAAP,CAAYrB,MAAZ,EAAoB9B,OAApB,CAA4B,UAAAqD,GAAG,EAAI;EACjC,MAAA,KAAI,CAACvB,MAAL,CAAYuB,GAAZ,IAAmBvB,MAAM,CAACuB,GAAD,CAAzB;EACD,KAFD;EAIA,SAAK8F,QAAL,CAAcnJ,OAAd,CAAsB,UAAAyB,OAAO,EAAI;EAC/B,UAAIA,OAAO,CAACkH,MAAZ,EAAoB;EAClBlH,QAAAA,OAAO,CAACkH,MAAR,CAAe7G,MAAf;EACD;EACF,KAJD;EAKD;;;WAGDoK,kBAAA,yBAAgBlK,IAAhB,EAAsB;EACpB,QAAMwK,MAAM,GAAGxK,IAAI,CAACW,MAAL,CAAY,CAAZ,EAAe,CAAf,CAAf;EACA,WAAOgH,cAAc,CAAC8C,IAAf,CAAoB,UAACC,GAAD;EAAA,aAASA,GAAG,KAAKF,MAAjB;EAAA,KAApB,CAAP;EACD;;;;;ECrNH,IAAMG,IAAI,GAAIC,MAAM,CAACC,MAAP,GAAgB,IAAhB,GAAuB,KAArC;;EACA,IAAMC,EAAE,GAAG,SAALA,EAAK,CAACxK,EAAD,EAAKiE,GAAL,EAAUjF,OAAV,EAAsB;EAACqL,EAAAA,IAAI,GAAGI,CAAC,CAACzK,EAAD,CAAD,CAAMwK,EAAN,CAASvG,GAAT,EAAcjF,OAAd,CAAH,GAA4BgB,EAAE,CAAC0K,gBAAH,CAAoBzG,GAApB,EAAyBjF,OAAzB,CAAhC;EAAkE,CAApG;;EACA,IAAM2L,GAAG,GAAG,SAANA,GAAM,CAAC3K,EAAD,EAAKiE,GAAL,EAAUjF,OAAV,EAAsB;EAACqL,EAAAA,IAAI,GAAGI,CAAC,CAACzK,EAAD,CAAD,CAAM2K,GAAN,CAAU1G,GAAV,EAAejF,OAAf,CAAH,GAA6BgB,EAAE,CAAC4K,mBAAH,CAAuB3G,GAAvB,EAA4BjF,OAA5B,CAAjC;EAAsE,CAAzG;;EAEA,IAAM6L,SAAS,GAAG,SAAZA,SAAY,CAACtP,KAAD,EAAW;EAC3B,SAAOA,KAAK,IAAI,IAAT,GAAgBA,KAAK,CAACuP,QAAN,EAAhB,GAAmCpP,SAA1C;EACD,CAFD;;EAIA,IAAMqP,KAAK,GAAG,SAARA,KAAQ,CAACC,CAAD,EAAIC,EAAJ,EAAW;EACvB,OAAK,IAAI9I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6I,CAApB,EAAuB7I,CAAC,EAAxB;EAA4B8I,IAAAA,EAAE;EAA9B;EACD,CAFD;;EAIA,SAASC,UAAT,CAAoB/L,OAApB,EAA6BgI,IAA7B,EAAmCgE,QAAnC,EAA6C;EAC3C,MAAIrP,QAAQ,GAAGqD,OAAO,CAACa,EAAR,CAAWoL,SAAX,CAAqB,IAArB,CAAf;EACA,MAAI7L,IAAI,GAAG,IAAImJ,IAAJ,CAAS5M,QAAT,EAAmBqL,IAAnB,EAAyBhI,OAAO,CAACI,IAAR,CAAaoB,OAAtC,CAAX;EACApB,EAAAA,IAAI,CAAC0G,IAAL;EACA9G,EAAAA,OAAO,CAACkM,MAAR,CAAezD,UAAf,CAA0BC,YAA1B,CAAuC/L,QAAvC,EAAiDqP,QAAjD;EACA,SAAO5L,IAAP;EACD;;EAED,IAAMhB,OAAO,GAAG;EACd;EACA,QAAM;EACJmH,IAAAA,QAAQ,EAAE,IADN;EAEJ4C,IAAAA,QAAQ,EAAE,IAFN;EAIJnC,IAAAA,MAAM,EAAE,gBAASnG,EAAT,EAAa;EACnB,UAAI,KAAKhB,OAAT,EAAkB;EAChB2L,QAAAA,GAAG,CAAC3K,EAAD,EAAK,KAAKiE,GAAV,EAAe,KAAKjF,OAApB,CAAH;EACD;EACF,KARG;EAUJ4G,IAAAA,OAAO,EAAE,iBAAS5F,EAAT,EAAazE,KAAb,EAAoB;EAC3B,UAAI,KAAKyD,OAAT,EAAkB;EAChB2L,QAAAA,GAAG,CAAC3K,EAAD,EAAK,KAAKiE,GAAV,EAAe,KAAKjF,OAApB,CAAH;EACD;;EAED,WAAKA,OAAL,GAAe,KAAKuG,YAAL,CAAkBhK,KAAlB,CAAf;EACAiP,MAAAA,EAAE,CAACxK,EAAD,EAAK,KAAKiE,GAAV,EAAe,KAAKjF,OAApB,CAAF;EACD;EAjBG,GAFQ;EAsBd;EACA,QAAM;EACJuI,IAAAA,KAAK,EAAE,IADH;EAGJe,IAAAA,QAAQ,EAAE,IAHN;EAKJrC,IAAAA,IAAI,EAAE,cAASjG,EAAT,EAAa;EACjB,UAAI,CAAC,KAAKqL,MAAV,EAAkB;EAChB,aAAKA,MAAL,GAAc3D,QAAQ,CAAC4D,aAAT,aAAiC,KAAKhQ,IAAtC,OAAd;EACA,aAAKiQ,QAAL,GAAgB,EAAhB;EAEAvL,QAAAA,EAAE,CAAC4H,UAAH,CAAcC,YAAd,CAA2B,KAAKwD,MAAhC,EAAwCrL,EAAxC;EACAA,QAAAA,EAAE,CAAC4H,UAAH,CAAcG,WAAd,CAA0B/H,EAA1B;EACD,OAND,MAMO;EACL,aAAKuL,QAAL,CAAc7N,OAAd,CAAsB,UAAA6B,IAAI,EAAI;EAC5BA,UAAAA,IAAI,CAAC0G,IAAL;EACD,SAFD;EAGD;EACF,KAjBG;EAmBJE,IAAAA,MAAM,EAAE,gBAASnG,EAAT,EAAa;EACnB,UAAI,KAAKuL,QAAT,EAAmB;EACjB,aAAKA,QAAL,CAAc7N,OAAd,CAAsB,UAAA6B,IAAI,EAAI;EAC5BA,UAAAA,IAAI,CAAC4G,MAAL;EACD,SAFD;EAGD;EACF,KAzBG;EA2BJP,IAAAA,OAAO,EAAE,iBAAS5F,EAAT,EAAawL,UAAb,EAAyB;EAAA;;EAChC,UAAIC,SAAS,GAAG,KAAKxH,GAAL,IAAY,OAA5B;EACAuH,MAAAA,UAAU,GAAGA,UAAU,IAAI,EAA3B;EACA,UAAIE,SAAS,GAAG1L,EAAE,CAAC2L,YAAH,CAAgB,QAAhB,KAA6B3L,EAAE,CAAC2L,YAAH,CAAgB,gBAAhB,CAA7B,IAAkE,QAAlF;EAEAH,MAAAA,UAAU,CAAC9N,OAAX,CAAmB,UAACoC,KAAD,EAAQ5D,KAAR,EAAkB;EACnC,YAAIiL,IAAI,GAAG;EAAC3D,UAAAA,OAAO,EAAE,KAAI,CAACjE,IAAL,CAAUC;EAApB,SAAX;EACA2H,QAAAA,IAAI,CAACuE,SAAD,CAAJ,GAAkBxP,KAAlB;EACAiL,QAAAA,IAAI,CAACsE,SAAD,CAAJ,GAAkB3L,KAAlB;EACA,YAAIP,IAAI,GAAG,KAAI,CAACgM,QAAL,CAAcrP,KAAd,CAAX;;EAEA,YAAI,CAACqD,IAAL,EAAW;EAET,cAAIqM,QAAQ,GAAG,KAAI,CAACP,MAApB;;EAEA,cAAI,KAAI,CAACE,QAAL,CAActP,MAAlB,EAA0B;EACxB2P,YAAAA,QAAQ,GAAG,KAAI,CAACL,QAAL,CAAc,KAAI,CAACA,QAAL,CAActP,MAAd,GAAuB,CAArC,EAAwC0M,GAAxC,CAA4C,CAA5C,CAAX;EACD;;EAEDpJ,UAAAA,IAAI,GAAG2L,UAAU,CAAC,KAAD,EAAO/D,IAAP,EAAayE,QAAQ,CAACC,WAAtB,CAAjB;;EACA,UAAA,KAAI,CAACN,QAAL,CAAchP,IAAd,CAAmBgD,IAAnB;EACD,SAVD,MAUO;EACL,cAAIA,IAAI,CAACC,MAAL,CAAYiM,SAAZ,MAA2B3L,KAA/B,EAAsC;EACpC;EACA,gBAAIgM,UAAJ,EAAgBC,QAAhB;;EACA,iBAAK,IAAIC,SAAS,GAAG9P,KAAK,GAAG,CAA7B,EAAgC8P,SAAS,GAAG,KAAI,CAACT,QAAL,CAActP,MAA1D,EAAkE+P,SAAS,EAA3E,EAA+E;EAC7ED,cAAAA,QAAQ,GAAG,KAAI,CAACR,QAAL,CAAcS,SAAd,CAAX;;EACA,kBAAID,QAAQ,CAACvM,MAAT,CAAgBiM,SAAhB,MAA+B3L,KAAnC,EAA0C;EACxCgM,gBAAAA,UAAU,GAAGE,SAAb;EACA;EACD;EACF;;EACD,gBAAIF,UAAU,KAAKpQ,SAAnB,EAA8B;EAC5B;EACA;EACA;EACA,cAAA,KAAI,CAAC6P,QAAL,CAAc3I,MAAd,CAAqBkJ,UAArB,EAAiC,CAAjC;;EACA,cAAA,KAAI,CAACT,MAAL,CAAYzD,UAAZ,CAAuBC,YAAvB,CAAoCkE,QAAQ,CAACpD,GAAT,CAAa,CAAb,CAApC,EAAqDpJ,IAAI,CAACoJ,GAAL,CAAS,CAAT,CAArD;;EACAoD,cAAAA,QAAQ,CAACvM,MAAT,CAAgBkM,SAAhB,IAA6BxP,KAA7B;EACD,aAPD,MAOO;EACL;EACA6P,cAAAA,QAAQ,GAAGb,UAAU,CAAC,KAAD,EAAO/D,IAAP,EAAa5H,IAAI,CAACoJ,GAAL,CAAS,CAAT,CAAb,CAArB;EACD;;EACD,YAAA,KAAI,CAAC4C,QAAL,CAAc3I,MAAd,CAAqB1G,KAArB,EAA4B,CAA5B,EAA+B6P,QAA/B;EACD,WAtBD,MAsBO;EACLxM,YAAAA,IAAI,CAACC,MAAL,CAAYkM,SAAZ,IAAyBxP,KAAzB;EACD;EACF;EACF,OA3CD;;EA6CA,UAAI,KAAKqP,QAAL,CAActP,MAAd,GAAuBuP,UAAU,CAACvP,MAAtC,EAA8C;EAC5C8O,QAAAA,KAAK,CAAC,KAAKQ,QAAL,CAActP,MAAd,GAAuBuP,UAAU,CAACvP,MAAnC,EAA2C,YAAM;EACpD,cAAIsD,IAAI,GAAG,KAAI,CAACgM,QAAL,CAAc/I,GAAd,EAAX;;EACAjD,UAAAA,IAAI,CAAC4G,MAAL;;EACA,UAAA,KAAI,CAACkF,MAAL,CAAYzD,UAAZ,CAAuBG,WAAvB,CAAmCxI,IAAI,CAACoJ,GAAL,CAAS,CAAT,CAAnC;EACD,SAJI,CAAL;EAKD;;EAED,UAAI3I,EAAE,CAACoJ,QAAH,KAAgB,QAApB,EAA8B;EAC5B,aAAK7J,IAAL,CAAUsH,QAAV,CAAmBnJ,OAAnB,CAA2B,UAAAyB,OAAO,EAAI;EACpC,cAAIA,OAAO,CAACa,EAAR,KAAe,KAAI,CAACqL,MAAL,CAAYzD,UAA3B,IAAyCzI,OAAO,CAAC7D,IAAR,KAAiB,OAA9D,EAAuE;EACrE6D,YAAAA,OAAO,CAAC0D,IAAR;EACD;EACF,SAJD;EAKD;EACF,KA5FG;EA8FJwD,IAAAA,MAAM,EAAE,gBAAS7G,MAAT,EAAiB;EAAA;;EACvB,UAAI2H,IAAI,GAAG,EAAX,CADuB;;EAIvBvG,MAAAA,MAAM,CAACC,IAAP,CAAYrB,MAAZ,EAAoB9B,OAApB,CAA4B,UAAAqD,GAAG,EAAI;EACjC,YAAIA,GAAG,KAAK,MAAI,CAACkD,GAAjB,EAAsB;EACpBkD,UAAAA,IAAI,CAACpG,GAAD,CAAJ,GAAYvB,MAAM,CAACuB,GAAD,CAAlB;EACD;EACF,OAJD;EAMA,WAAKwK,QAAL,CAAc7N,OAAd,CAAsB,UAAA6B,IAAI,EAAI;EAC5BA,QAAAA,IAAI,CAAC8G,MAAL,CAAYc,IAAZ;EACD,OAFD;EAGD;EA3GG,GAvBQ;EAqId;EACA;EACA,UAAQ,WAASnH,EAAT,EAAazE,KAAb,EAAoB;EAC1B,QAAM0Q,YAAY,GAAG,KAAKhI,GAA1B;;EACA,QAAI1I,KAAJ,EAAW;EACTyE,MAAAA,EAAE,CAACkM,KAAH,CAASD,YAAT,IAAyB,EAAzB;EACD,KAFD;EAMD,GA/Ia;EAiJd;EACA;EACA,SAAO,WAASjM,EAAT,EAAazE,KAAb,EAAoB;EACzB,QAAM0Q,YAAY,GAAG,KAAKhI,GAA1B;;EACA,QAAI1I,KAAJ,EAAW;EACTyE,MAAAA,EAAE,CAACkM,KAAH,CAASD,YAAT,IAAyB1Q,KAAzB;EACD,KAFD,MAEO;EACLyE,MAAAA,EAAE,CAACkM,KAAH,CAASD,YAAT,IAAyB,EAAzB;EACD;EACF,GA1Ja;EA4Jd;EACA,SAAO,WAASjM,EAAT,EAAazE,KAAb,EAAoB;EACzB,QAAI4Q,OAAO,SAAOnM,EAAE,CAACoM,SAAV,MAAX;;EAEA,QAAI7Q,KAAK,KAAM4Q,OAAO,CAAC7P,OAAR,OAAoB,KAAK2H,GAAzB,UAAmC,CAAC,CAAnD,EAAuD;EACrD,UAAI1I,KAAJ,EAAW;EACTyE,QAAAA,EAAE,CAACoM,SAAH,GAAeD,OAAO,CAACE,OAAR,OAAoB,KAAKpI,GAAzB,QAAiC,GAAjC,EAAsCvH,IAAtC,EAAf;EACD,OAFD,MAEO;EACLsD,QAAAA,EAAE,CAACoM,SAAH,GAAkBpM,EAAE,CAACoM,SAArB,SAAkC,KAAKnI,GAAvC;EACD;EACF;EACF,GAvKa;EAyKd;EACA,QAAM,WAASjE,EAAT,EAAazE,KAAb,EAAoB;EACxB,QAAI4Q,OAAO,SAAOnM,EAAE,CAACoM,SAAV,MAAX;;EAEA,QAAI,CAAC7Q,KAAD,KAAY4Q,OAAO,CAAC7P,OAAR,OAAoB,KAAK2H,GAAzB,UAAmC,CAAC,CAApD,EAAwD;EACtD,UAAI1I,KAAJ,EAAW;EACTyE,QAAAA,EAAE,CAACoM,SAAH,GAAkBpM,EAAE,CAACoM,SAArB,SAAkC,KAAKnI,GAAvC;EACD,OAFD,MAEO;EACLjE,QAAAA,EAAE,CAACoM,SAAH,GAAeD,OAAO,CAACE,OAAR,OAAoB,KAAKpI,GAAzB,QAAiC,GAAjC,EAAsCvH,IAAtC,EAAf;EACD;EACF;EACF,GApLa;EAsLd;EACA,WAAS,cAACsD,EAAD,EAAKzE,KAAL,EAAe;EACtByE,IAAAA,EAAE,CAACsM,WAAH,GAAiB/Q,KAAK,IAAI,IAAT,GAAgBA,KAAhB,GAAwB,EAAzC;EACD,GAzLa;EA2Ld;EACA,WAAS,cAACyE,EAAD,EAAKzE,KAAL,EAAe;EACtByE,IAAAA,EAAE,CAACuM,SAAH,GAAehR,KAAK,IAAI,IAAT,GAAgBA,KAAhB,GAAwB,EAAvC;EACD,GA9La;EAgMd;EACA,WAAS,cAACyE,EAAD,EAAKzE,KAAL,EAAe;EACtByE,IAAAA,EAAE,CAACkM,KAAH,CAASM,OAAT,GAAmBjR,KAAK,GAAG,EAAH,GAAQ,MAAhC;EACD,GAnMa;EAqMd;EACA,WAAS,cAACyE,EAAD,EAAKzE,KAAL,EAAe;EACtByE,IAAAA,EAAE,CAACkM,KAAH,CAASM,OAAT,GAAmBjR,KAAK,GAAG,MAAH,GAAY,EAApC;EACD,GAxMa;EA0Md;EACA,cAAY,iBAACyE,EAAD,EAAKzE,KAAL,EAAe;EACzByE,IAAAA,EAAE,CAACyM,QAAH,GAAc,CAAClR,KAAf;EACD,GA7Ma;EA+Md;EACA,eAAa,kBAACyE,EAAD,EAAKzE,KAAL,EAAe;EAC1ByE,IAAAA,EAAE,CAACyM,QAAH,GAAc,CAAC,CAAClR,KAAhB;EACD,GAlNa;EAoNd;EACA;EACA;EACA,cAAY;EACV0O,IAAAA,SAAS,EAAE,IADD;EAEV3B,IAAAA,QAAQ,EAAE,IAFA;EAIVrC,IAAAA,IAAI,EAAE,cAASjG,EAAT,EAAa;EACjB,UAAI0M,IAAI,GAAG,IAAX;;EACA,UAAI,CAAC,KAAKjL,QAAV,EAAoB;EAClB,aAAKA,QAAL,GAAgB,YAAY;EAC1BiL,UAAAA,IAAI,CAAC5G,OAAL;EACD,SAFD;EAGD;;EACD9F,MAAAA,EAAE,CAAC0K,gBAAH,CAAoB,QAApB,EAA8B,KAAKjJ,QAAnC;EACD,KAZS;EAcV0E,IAAAA,MAAM,EAAE,gBAASnG,EAAT,EAAa;EACnBA,MAAAA,EAAE,CAAC4K,mBAAH,CAAuB,QAAvB,EAAiC,KAAKnJ,QAAtC;EACD,KAhBS;EAkBVmE,IAAAA,OAAO,EAAE,iBAAS5F,EAAT,EAAazE,KAAb,EAAoB;EAC3B,UAAIyE,EAAE,CAAC1E,IAAH,KAAY,OAAhB,EAAyB;EACvB0E,QAAAA,EAAE,CAAC0D,OAAH,GAAamH,SAAS,CAAC7K,EAAE,CAACzE,KAAJ,CAAT,KAAwBsP,SAAS,CAACtP,KAAD,CAA9C;EACD,OAFD,MAEO;EACLyE,QAAAA,EAAE,CAAC0D,OAAH,GAAa,CAAC,CAACnI,KAAf;EACD;EACF;EAxBS,GAvNE;EAiPd;EACA;EACA;EACA,gBAAc;EACZ0O,IAAAA,SAAS,EAAE,IADC;EAEZ3B,IAAAA,QAAQ,EAAE,IAFE;EAIZrC,IAAAA,IAAI,EAAE,cAASjG,EAAT,EAAa;EACjB,UAAI0M,IAAI,GAAG,IAAX;;EACA,UAAI,CAAC,KAAKjL,QAAV,EAAoB;EAClB,aAAKA,QAAL,GAAgB,YAAY;EAC1BiL,UAAAA,IAAI,CAAC5G,OAAL;EACD,SAFD;EAGD;;EACD9F,MAAAA,EAAE,CAAC0K,gBAAH,CAAoB,QAApB,EAA8B,KAAKjJ,QAAnC;EACD,KAZW;EAcZ0E,IAAAA,MAAM,EAAE,gBAASnG,EAAT,EAAa;EACnBA,MAAAA,EAAE,CAAC4K,mBAAH,CAAuB,QAAvB,EAAiC,KAAKnJ,QAAtC;EACD,KAhBW;EAkBZmE,IAAAA,OAAO,EAAE,iBAAS5F,EAAT,EAAazE,KAAb,EAAoB;EAC3B,UAAIyE,EAAE,CAAC1E,IAAH,KAAY,OAAhB,EAAyB;EACvB0E,QAAAA,EAAE,CAAC0D,OAAH,GAAa,EAAEmH,SAAS,CAAC7K,EAAE,CAACzE,KAAJ,CAAT,KAAwBsP,SAAS,CAACtP,KAAD,CAAnC,CAAb;EACD,OAFD,MAEO;EACLyE,QAAAA,EAAE,CAAC0D,OAAH,GAAa,CAAE,CAAC,CAACnI,KAAjB;EACD;EACF;EAxBW,GApPA;EA+Qd;EACA;EACA,YAAU;EACR0O,IAAAA,SAAS,EAAE,IADH;EAER3B,IAAAA,QAAQ,EAAE,IAFF;EAIRrC,IAAAA,IAAI,EAAE,cAASjG,EAAT,EAAa;EACjB,WAAK2M,OAAL,GAAe3M,EAAE,CAAC4M,OAAH,KAAe,OAAf,IAA0B5M,EAAE,CAAC1E,IAAH,KAAY,OAArD;;EACA,UAAI,CAAC,KAAKqR,OAAV,EAAmB;EACjB,aAAKE,KAAL,GAAa7M,EAAE,CAAC2L,YAAH,CAAgB,YAAhB,MAAkC3L,EAAE,CAAC4M,OAAH,KAAe,QAAf,GAA0B,QAA1B,GAAqC,OAAvE,CAAb;EAEA,YAAIF,IAAI,GAAG,IAAX;;EACA,YAAI,CAAC,KAAKjL,QAAV,EAAoB;EAClB,eAAKA,QAAL,GAAgB,YAAY;EAC1BiL,YAAAA,IAAI,CAAC5G,OAAL;EACD,WAFD;EAGD;;EAED9F,QAAAA,EAAE,CAAC0K,gBAAH,CAAoB,KAAKmC,KAAzB,EAAgC,KAAKpL,QAArC;EACD;EACF,KAlBO;EAoBR0E,IAAAA,MAAM,EAAE,gBAASnG,EAAT,EAAa;EACnB,UAAI,CAAC,KAAK2M,OAAV,EAAmB;EACjB3M,QAAAA,EAAE,CAAC4K,mBAAH,CAAuB,KAAKiC,KAA5B,EAAmC,KAAKpL,QAAxC;EACD;EACF,KAxBO;EA0BRmE,IAAAA,OAAO,EAAE,iBAAS5F,EAAT,EAAazE,KAAb,EAAoB;EAC3B,UAAI,KAAKoR,OAAT,EAAkB;EAChB3M,QAAAA,EAAE,CAACQ,YAAH,CAAgB,OAAhB,EAAyBjF,KAAzB;EACD,OAFD,MAEO;EACL,YAAIyE,EAAE,CAAC1E,IAAH,KAAY,iBAAhB,EAAmC;EACjC,cAAIC,KAAK,YAAY2H,KAArB,EAA4B;EAC1B,iBAAK,IAAIf,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnC,EAAE,CAAC/D,MAAvB,EAA+BkG,CAAC,EAAhC,EAAoC;EAClC,kBAAIrB,MAAM,GAAGd,EAAE,CAACmC,CAAD,CAAf;EACArB,cAAAA,MAAM,CAAC6C,QAAP,GAAkBpI,KAAK,CAACe,OAAN,CAAcwE,MAAM,CAACvF,KAArB,IAA8B,CAAC,CAAjD;EACD;EACF;EACF,SAPD,MAOO,IAAIsP,SAAS,CAACtP,KAAD,CAAT,KAAqBsP,SAAS,CAAC7K,EAAE,CAACzE,KAAJ,CAAlC,EAA8C;EACnDyE,UAAAA,EAAE,CAACzE,KAAH,GAAWA,KAAK,IAAI,IAAT,GAAgBA,KAAhB,GAAwB,EAAnC;EACD;EACF;EACF;EAzCO,GAjRI;EA6Td;EACA,OAAK;EACHgM,IAAAA,KAAK,EAAE,IADJ;EAEHe,IAAAA,QAAQ,EAAE,IAFP;EAIHrC,IAAAA,IAAI,EAAE,cAASjG,EAAT,EAAa;EACjB,UAAI,CAAC,KAAKqL,MAAV,EAAkB;EAChB,aAAKA,MAAL,GAAc3D,QAAQ,CAAC4D,aAAT,CAAuB,YAAY,KAAKhQ,IAAjB,GAAwB,GAAxB,GAA8B,KAAKkG,OAAnC,GAA6C,GAApE,CAAd;EACA,aAAKsL,QAAL,GAAgB,KAAhB;EAEA9M,QAAAA,EAAE,CAAC4H,UAAH,CAAcC,YAAd,CAA2B,KAAKwD,MAAhC,EAAwCrL,EAAxC;EACAA,QAAAA,EAAE,CAAC4H,UAAH,CAAcG,WAAd,CAA0B/H,EAA1B;EACD,OAND,MAMO,IAAI,KAAK+M,KAAL,KAAe,KAAf,IAAwB,KAAKC,MAAjC,EAAyC;EAC9C,aAAKA,MAAL,CAAY/G,IAAZ;EACD;;EACD,WAAK8G,KAAL,GAAa,IAAb;EACD,KAfE;EAiBH5G,IAAAA,MAAM,EAAE,kBAAW;EACjB,UAAI,KAAK6G,MAAT,EAAiB;EACf,aAAKA,MAAL,CAAY7G,MAAZ;EACA,aAAK4G,KAAL,GAAa,KAAb;EACD;EACF,KAtBE;EAwBHnH,IAAAA,OAAO,EAAE,iBAAS5F,EAAT,EAAazE,KAAb,EAAoB;EAC3B,UAAI,CAAC,CAACA,KAAF,KAAY,KAAKuR,QAArB,EAA+B;EAC7B,YAAIvR,KAAJ,EAAW;EAET,cAAI,CAAC,KAAKyR,MAAV,EAAkB;EAChB,iBAAKA,MAAL,GAAc,IAAItE,IAAJ,CAAS1I,EAAT,EAAa,KAAKT,IAAL,CAAUC,MAAvB,EAA+B,KAAKD,IAAL,CAAUoB,OAAzC,CAAd;EACA,iBAAKqM,MAAL,CAAY/G,IAAZ;EACD;;EAED,eAAKoF,MAAL,CAAYzD,UAAZ,CAAuBC,YAAvB,CAAoC7H,EAApC,EAAwC,KAAKqL,MAAL,CAAYQ,WAApD;EACA,eAAKiB,QAAL,GAAgB,IAAhB;EACD,SATD,MASO;EACL9M,UAAAA,EAAE,CAAC4H,UAAH,CAAcG,WAAd,CAA0B/H,EAA1B;EACA,eAAK8M,QAAL,GAAgB,KAAhB;EACD;EACF;EACF,KAxCE;EA0CHzG,IAAAA,MAAM,EAAE,gBAAS7G,MAAT,EAAiB;EACvB,UAAI,KAAKwN,MAAT,EAAiB;EACf,aAAKA,MAAL,CAAY3G,MAAZ,CAAmB7G,MAAnB;EACD;EACF;EA9CE,GA9TS;EA+Wd;EACA,QAAM;EACJ+H,IAAAA,KAAK,EAAE,IADH;EAEJe,IAAAA,QAAQ,EAAE,IAFN;EAIJrC,IAAAA,IAAI,EAAE,cAASjG,EAAT,EAAa;EACjB,UAAI,CAAC,KAAKqL,MAAV,EAAkB;EAChB,aAAKA,MAAL,GAAc3D,QAAQ,CAAC4D,aAAT,CAAuB,YAAY,KAAKhQ,IAAjB,GAAwB,GAAxB,GAA8B,KAAKkG,OAAnC,GAA6C,GAApE,CAAd;EACA,aAAKsL,QAAL,GAAgB,KAAhB;EAEA9M,QAAAA,EAAE,CAAC4H,UAAH,CAAcC,YAAd,CAA2B,KAAKwD,MAAhC,EAAwCrL,EAAxC;EACAA,QAAAA,EAAE,CAAC4H,UAAH,CAAcG,WAAd,CAA0B/H,EAA1B;EACD,OAND,MAMO,IAAI,KAAK+M,KAAL,KAAe,KAAf,IAAwB,KAAKC,MAAjC,EAAyC;EAC9C,aAAKA,MAAL,CAAY/G,IAAZ;EACD;;EACD,WAAK8G,KAAL,GAAa,IAAb;EACD,KAfG;EAiBJ5G,IAAAA,MAAM,EAAE,kBAAW;EACjB,UAAI,KAAK6G,MAAT,EAAiB;EACf,aAAKA,MAAL,CAAY7G,MAAZ;EACA,aAAK4G,KAAL,GAAa,KAAb;EACD;EACF,KAtBG;EAwBJnH,IAAAA,OAAO,EAAE,iBAAS5F,EAAT,EAAazE,KAAb,EAAoB;EAC3B,UAAI,CAAC,CAACA,KAAF,KAAY,KAAKuR,QAArB,EAA+B;EAC7B,YAAI,CAACvR,KAAL,EAAY;EAEV,cAAI,CAAC,KAAKyR,MAAV,EAAkB;EAChB,iBAAKA,MAAL,GAAc,IAAItE,IAAJ,CAAS1I,EAAT,EAAa,KAAKT,IAAL,CAAUC,MAAvB,EAA+B,KAAKD,IAAL,CAAUoB,OAAzC,CAAd;EACA,iBAAKqM,MAAL,CAAY/G,IAAZ;EACD;;EAED,eAAKoF,MAAL,CAAYzD,UAAZ,CAAuBC,YAAvB,CAAoC7H,EAApC,EAAwC,KAAKqL,MAAL,CAAYQ,WAApD;EACA,eAAKiB,QAAL,GAAgB,IAAhB;EACD,SATD,MASO;EACL9M,UAAAA,EAAE,CAAC4H,UAAH,CAAcG,WAAd,CAA0B/H,EAA1B;EACA,eAAK8M,QAAL,GAAgB,KAAhB;EACD;EACF;EACF,KAxCG;EA0CJzG,IAAAA,MAAM,EAAE,gBAAS7G,MAAT,EAAiB;EACvB,UAAI,KAAKwN,MAAT,EAAiB;EACf,aAAKA,MAAL,CAAY3G,MAAZ,CAAmB7G,MAAnB;EACD;EACF;EA9CG,GAhXQ;EAkad,QAAM,WAASQ,EAAT,EAAazE,KAAb,EAAoB;EACxB,QAAIA,KAAK,IAAI,IAAb,EAAmB;EACjByE,MAAAA,EAAE,CAACQ,YAAH,CAAgB,KAAKyD,GAArB,EAA0B1I,KAA1B;EACD,KAFD,MAEO;EACLyE,MAAAA,EAAE,CAACS,eAAH,CAAmB,KAAKwD,GAAxB;EACD;EACF,GAxaa;EAyad,SAAO,WAASjE,EAAT,EAAazE,KAAb,EAAoB;EACzB,QAAIA,KAAK,IAAI,IAAb,EAAmB;EACjByE,MAAAA,EAAE,CAACS,eAAH,CAAmB,KAAKwD,GAAxB;EACD,KAFD;EAMD;EAhba,CAAhB;;ECxBA,IAAMzF,UAAU,GAAG;EACfyO,EAAAA,KAAK,EAAE,eAAS1R,KAAT,EAAgB;EACrB,WAAOA,KAAP;EACD,GAHc;EAKf2R,EAAAA,GAAG,EAAE,aAAS3R,KAAT,EAAgB;EACnB,WAAO,CAACA,KAAR;EACD,GAPc;EASf4R,EAAAA,MAAM,EAAE,gBAAS5R,KAAT,EAAgB;EACtB,WAAO,CAACA,KAAR;EACD;EAXc,CAAnB;;ECAA;EACA;EACA;EAEA,IAAM6R,aAAa,GAAG,CACpB,MADoB,EAEpB,KAFoB,EAGpB,OAHoB,EAIpB,SAJoB,EAKpB,MALoB,EAMpB,SANoB,EAOpB,QAPoB,CAAtB;EAUA,IAAMC,OAAO,GAAG;EACdC,EAAAA,OAAO,EAAE,CADK;EAEdC,EAAAA,OAAO,EAAE,EAFK;EAIdC,EAAAA,aAAa,EAAE,uBAAStM,GAAT,EAAc;EAC3B,QAAI,CAACA,GAAG,CAACgF,cAAJ,CAAmB,MAAnB,CAAL,EAAiC;EAC/B,UAAIf,EAAE,GAAG,KAAKmI,OAAL,EAAT;EAEA1M,MAAAA,MAAM,CAAC6M,cAAP,CAAsBvM,GAAtB,EAA2B,MAA3B,EAAmC;EACjC3F,QAAAA,KAAK,EAAE4J;EAD0B,OAAnC;EAGD;;EAED,QAAI,CAAC,KAAKoI,OAAL,CAAarM,GAAG,CAACwM,IAAjB,CAAL,EAA6B;EAC3B,WAAKH,OAAL,CAAarM,GAAG,CAACwM,IAAjB,IAAyB;EACvBC,QAAAA,SAAS,EAAE;EADY,OAAzB;EAGD;;EAED,WAAO,KAAKJ,OAAL,CAAarM,GAAG,CAACwM,IAAjB,CAAP;EACD,GApBa;EAsBdE,EAAAA,oBAAoB,EAAE,8BAASC,GAAT,EAAc1I,EAAd,EAAkB;EACtC,QAAI,CAACvE,MAAM,CAACC,IAAP,CAAYgN,GAAG,CAACF,SAAhB,EAA2B1R,MAAhC,EAAwC;EACtC,UAAI,EAAE4R,GAAG,CAACC,QAAJ,IAAgBlN,MAAM,CAACC,IAAP,CAAYgN,GAAG,CAACC,QAAhB,EAA0B7R,MAA5C,CAAJ,EAAyD;EACvD,eAAO,KAAKsR,OAAL,CAAapI,EAAb,CAAP;EACD;EACF;EACF,GA5Ba;EA8Bd4I,EAAAA,YAAY,EAAE,sBAAS7M,GAAT,EAAcvB,EAAd,EAAkB;EAC9B,QAAIqO,QAAQ,GAAG9M,GAAG,CAACvB,EAAD,CAAlB;EACA,QAAI8E,GAAG,GAAG,KAAK+I,aAAL,CAAmBtM,GAAnB,CAAV;EACA,QAAIqM,OAAO,GAAG,KAAKA,OAAnB;;EAEArM,IAAAA,GAAG,CAACvB,EAAD,CAAH,GAAU,YAAa;EAAA,wCAATnC,IAAS;EAATA,QAAAA,IAAS;EAAA;;EACrB,UAAIyQ,QAAQ,GAAGD,QAAQ,CAACE,KAAT,CAAehN,GAAf,EAAoB1D,IAApB,CAAf;EAEAoD,MAAAA,MAAM,CAACC,IAAP,CAAY4D,GAAG,CAACqJ,QAAhB,EAA0BpQ,OAA1B,CAAkC,UAAAL,CAAC,EAAI;EACrC,YAAIF,CAAC,GAAGsH,GAAG,CAACqJ,QAAJ,CAAazQ,CAAb,CAAR;;EAEA,YAAIkQ,OAAO,CAAClQ,CAAD,CAAX,EAAgB;EACd,cAAIkQ,OAAO,CAAClQ,CAAD,CAAP,CAAWsQ,SAAX,CAAqBxQ,CAArB,aAAmC+F,KAAvC,EAA8C;EAC5CqK,YAAAA,OAAO,CAAClQ,CAAD,CAAP,CAAWsQ,SAAX,CAAqBxQ,CAArB,EAAwBO,OAAxB,CAAgC,UAAA+D,QAAQ,EAAI;EAC1CA,cAAAA,QAAQ,CAACoB,IAAT;EACD,aAFD;EAGD;EACF;EACF,OAVD;EAYA,aAAOoL,QAAP;EACD,KAhBD;EAiBD,GApDa;EAsDdE,EAAAA,gBAAgB,EAAE,0BAASjN,GAAT,EAAc2M,GAAd,EAAmBrM,OAAnB,EAA4B;EAAA;;EAC5C,QAAIN,GAAG,YAAYgC,KAAnB,EAA0B;EACxB,UAAIuB,GAAG,GAAG,KAAK+I,aAAL,CAAmBtM,GAAnB,CAAV;;EAEA,UAAI,CAACuD,GAAG,CAACqJ,QAAT,EAAmB;EACjBrJ,QAAAA,GAAG,CAACqJ,QAAJ,GAAe,EAAf;EAEAV,QAAAA,aAAa,CAAC1P,OAAd,CAAsB,UAAAiC,EAAE,EAAI;EAC1B,UAAA,KAAI,CAACoO,YAAL,CAAkB7M,GAAlB,EAAuBvB,EAAvB;EACD,SAFD;EAGD;;EAED,UAAI,CAAC8E,GAAG,CAACqJ,QAAJ,CAAaD,GAAb,CAAL,EAAwB;EACtBpJ,QAAAA,GAAG,CAACqJ,QAAJ,CAAaD,GAAb,IAAoB,EAApB;EACD;;EAED,UAAIpJ,GAAG,CAACqJ,QAAJ,CAAaD,GAAb,EAAkBvR,OAAlB,CAA0BkF,OAA1B,MAAuC,CAAC,CAA5C,EAA+C;EAC7CiD,QAAAA,GAAG,CAACqJ,QAAJ,CAAaD,GAAb,EAAkBtR,IAAlB,CAAuBiF,OAAvB;EACD;EACF;EACF,GA1Ea;EA4Ed4M,EAAAA,kBAAkB,EAAE,4BAASlN,GAAT,EAAc2M,GAAd,EAAmBrM,OAAnB,EAA4B;EAC9C,QAAKN,GAAG,YAAYgC,KAAhB,IAA2BhC,GAAG,CAACwM,IAAJ,IAAY,IAA3C,EAAkD;EAChD,UAAIjJ,GAAG,GAAG,KAAK8I,OAAL,CAAarM,GAAG,CAACwM,IAAjB,CAAV;;EAEA,UAAIjJ,GAAJ,EAAS;EACP,YAAIqJ,QAAQ,GAAGrJ,GAAG,CAACqJ,QAAJ,CAAaD,GAAb,CAAf;;EAEA,YAAIC,QAAJ,EAAc;EACZ,cAAIO,GAAG,GAAGP,QAAQ,CAACxR,OAAT,CAAiBkF,OAAjB,CAAV;;EAEA,cAAI6M,GAAG,GAAG,CAAC,CAAX,EAAc;EACZP,YAAAA,QAAQ,CAAClL,MAAT,CAAgByL,GAAhB,EAAqB,CAArB;EACD;;EAED,cAAI,CAACP,QAAQ,CAAC7R,MAAd,EAAsB;EACpB,mBAAOwI,GAAG,CAACqJ,QAAJ,CAAaD,GAAb,CAAP;EACD;;EAED,eAAKD,oBAAL,CAA0BnJ,GAA1B,EAA+BvD,GAAG,CAACwM,IAAnC;EACD;EACF;EACF;EACF,GAlGa;EAoGdpJ,EAAAA,OAAO,EAAE,iBAASpD,GAAT,EAAcM,OAAd,EAAuBC,QAAvB,EAAiC;EAAA;;EACxC,QAAIlG,KAAJ;EACA,QAAIoS,SAAS,GAAG,KAAKH,aAAL,CAAmBtM,GAAnB,EAAwByM,SAAxC;;EAEA,QAAI,CAACA,SAAS,CAACnM,OAAD,CAAd,EAAyB;EACvBmM,MAAAA,SAAS,CAACnM,OAAD,CAAT,GAAqB,EAArB;EACA,UAAI8M,IAAI,GAAG1N,MAAM,CAAC2N,wBAAP,CAAgCrN,GAAhC,EAAqCM,OAArC,CAAX;;EAEA,UAAI,CAAC8M,IAAD,IAAS,EAAEA,IAAI,CAACnO,GAAL,IAAYmO,IAAI,CAACvM,GAAjB,IAAwB,CAACuM,IAAI,CAACE,YAAhC,CAAb,EAA4D;EAC1DjT,QAAAA,KAAK,GAAG2F,GAAG,CAACM,OAAD,CAAX;EAEAZ,QAAAA,MAAM,CAAC6M,cAAP,CAAsBvM,GAAtB,EAA2BM,OAA3B,EAAoC;EAClCiN,UAAAA,UAAU,EAAE,IADsB;EAGlCtO,UAAAA,GAAG,EAAE,eAAM;EACT,mBAAO5E,KAAP;EACD,WALiC;EAOlCwG,UAAAA,GAAG,EAAE,aAAAiB,QAAQ,EAAI;EACf,gBAAIA,QAAQ,KAAKzH,KAAjB,EAAwB;EACtB,cAAA,MAAI,CAAC6S,kBAAL,CAAwB7S,KAAxB,EAA+B2F,GAAG,CAACwM,IAAnC,EAAyClM,OAAzC;;EACAjG,cAAAA,KAAK,GAAGyH,QAAR;EACA,kBAAIyB,GAAG,GAAG,MAAI,CAAC8I,OAAL,CAAarM,GAAG,CAACwM,IAAjB,CAAV;;EAEA,kBAAIjJ,GAAJ,EAAS;EACP,oBAAIkJ,UAAS,GAAGlJ,GAAG,CAACkJ,SAAJ,CAAcnM,OAAd,CAAhB;;EAEA,oBAAImM,UAAJ,EAAe;EACbA,kBAAAA,UAAS,CAACjQ,OAAV,CAAkB,UAAAuN,EAAE,EAAI;EACpBA,oBAAAA,EAAE,CAACpI,IAAH;EACH,mBAFD;EAGD;;EAED,gBAAA,MAAI,CAACsL,gBAAL,CAAsBnL,QAAtB,EAAgC9B,GAAG,CAACwM,IAApC,EAA0ClM,OAA1C;EACD;EACF;EACF;EAzBiC,SAApC;EA2BD;EACF;;EAED,QAAImM,SAAS,CAACnM,OAAD,CAAT,CAAmBlF,OAAnB,CAA2BmF,QAA3B,MAAyC,CAAC,CAA9C,EAAiD;EAC/CkM,MAAAA,SAAS,CAACnM,OAAD,CAAT,CAAmBjF,IAAnB,CAAwBkF,QAAxB;EACD;;EAED,SAAK0M,gBAAL,CAAsBjN,GAAG,CAACM,OAAD,CAAzB,EAAoCN,GAAG,CAACwM,IAAxC,EAA8ClM,OAA9C;EACD,GAlJa;EAoJd8B,EAAAA,SAAS,EAAE,mBAASpC,GAAT,EAAcM,OAAd,EAAuBC,QAAvB,EAAiC;EAC1C,QAAIgD,GAAG,GAAG,KAAK8I,OAAL,CAAarM,GAAG,CAACwM,IAAjB,CAAV;;EAEA,QAAIjJ,GAAJ,EAAS;EACP,UAAIkJ,SAAS,GAAGlJ,GAAG,CAACkJ,SAAJ,CAAcnM,OAAd,CAAhB;;EAEA,UAAImM,SAAJ,EAAe;EACb,YAAIU,GAAG,GAAGV,SAAS,CAACrR,OAAV,CAAkBmF,QAAlB,CAAV;;EAEA,YAAI4M,GAAG,GAAG,CAAC,CAAX,EAAc;EACZV,UAAAA,SAAS,CAAC/K,MAAV,CAAiByL,GAAjB,EAAsB,CAAtB;;EAEA,cAAI,CAACV,SAAS,CAAC1R,MAAf,EAAuB;EACrB,mBAAOwI,GAAG,CAACkJ,SAAJ,CAAcnM,OAAd,CAAP;EACA,iBAAK4M,kBAAL,CAAwBlN,GAAG,CAACM,OAAD,CAA3B,EAAsCN,GAAG,CAACwM,IAA1C,EAAgDlM,OAAhD;EACD;EACF;;EAED,aAAKoM,oBAAL,CAA0BnJ,GAA1B,EAA+BvD,GAAG,CAACwM,IAAnC;EACD;EACF;EACF,GAzKa;EA2KdvN,EAAAA,GAAG,EAAE,aAASe,GAAT,EAAcM,OAAd,EAAuB;EAC1B,WAAON,GAAG,CAACM,OAAD,CAAV;EACD,GA7Ka;EA+KdO,EAAAA,GAAG,EAAE,aAACb,GAAD,EAAMM,OAAN,EAAejG,KAAf,EAAyB;EAC5B2F,IAAAA,GAAG,CAACM,OAAD,CAAH,GAAejG,KAAf;EACD;EAjLa,CAAhB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCZMmT;;;;;cACGC,wBAAP,+BAA6BC,KAA7B,EAAoC;EAClC,QAAM9S,QAAQ,GAAG8S,KAAK,CAAC9S,QAAvB;EACA,QAAM+S,GAAG,GAAGD,KAAK,CAACC,GAAlB;;EACA,QAAI,CAAC/S,QAAD,IAAa,CAAC+S,GAAlB,EAAuB;EACrB,YAAM,IAAIxN,KAAJ,sCAA6C,KAAK3B,IAAlD,CAAN;EACD;;EAEDkP,IAAAA,KAAK,CAACE,YAAN,GAAqBpH,QAAQ,CAACqH,aAAT,CAAuB,UAAvB,CAArB;EACAH,IAAAA,KAAK,CAACE,YAAN,CAAmBvC,SAAnB,GAA+BzQ,QAA/B;EAEA,QAAMkT,gBAAgB,GAAGJ,KAAK,CAACK,kBAAN,GAA2B,EAApD;EACA,QAAM5F,UAAU,GAAG,EAAnB;EACA,QAAM/I,UAAU,GAAGsO,KAAK,CAACtO,UAAzB;;EAEA,QAAIA,UAAJ,EAAgB;EACdM,MAAAA,MAAM,CAACC,IAAP,CAAYP,UAAZ,EAAwB5C,OAAxB,CAAgC,UAAAwR,QAAQ,EAAI;EAC1C,YAAMC,UAAU,GAAG7O,UAAU,CAAC4O,QAAD,CAA7B;EACA,YAAME,QAAQ,GAAG,OAAOD,UAAP,KAAsB,QAAtB,GAAiCA,UAAjC,GAA8CD,QAA/D;EACAF,QAAAA,gBAAgB,CAACI,QAAD,CAAhB,GAA6BF,QAA7B;EACA7F,QAAAA,UAAU,CAAC9M,IAAX,CAAgB6S,QAAhB,EAJ0C;EAO3C,OAPD;EAQD;;EACD,WAAO/F,UAAP;EACD;;;;WAMDgG,oBAAA,6BAAoB;EAClB,QAAMC,KAAK,GAAG,KAAK7J,WAAL,CAAiBqJ,YAAjB,CAA8BS,OAA9B,CAAsCnE,SAAtC,CAAgD,IAAhD,CAAd;;EACA,SAAKoE,UAAL,GAAkBlR,IAAI,CAAC2H,IAAL,CAAUqJ,KAAV,EAAiB,IAAjB,CAAlB;;EACA,WAAO,KAAKG,UAAZ,EAAwB;EACtB,WAAK1H,WAAL,CAAiB,KAAK0H,UAAtB;EACD;;EACD,SAAKD,UAAL,CAAgB3M,IAAhB;;EACA,SAAK6M,WAAL,CAAiBJ,KAAjB;;EACA,SAAKE,UAAL,CAAgB3M,IAAhB;;EACA,SAAK8M,SAAL;EACD;;WAEDC,uBAAA,gCAAuB;EACrB,SAAKC,UAAL;;EACA,SAAKL,UAAL,CAAgBrJ,MAAhB;EACD;;WAED2J,2BAAA,kCAAyBpQ,IAAzB,EAA+BqQ,GAA/B,EAAoCxU,KAApC,EAA2C;EACzC,QAAIwU,GAAG,KAAKxU,KAAZ,EAAmB;EACjB,UAAM2T,QAAQ,GAAG,KAAKzJ,WAAL,CAAiBwJ,kBAAjB,CAAoCvP,IAApC,CAAjB;EACA,WAAKwP,QAAL,IAAiB3T,KAAjB;EACD;EACF;;;;0BA3B+B;EAC9B,aAAO,KAAKoT,qBAAL,CAA2B,IAA3B,CAAP;EACD;;;EA0BD,uBAAoB;EAAA;;EAAA,sCAALnR,IAAK;EAALA,MAAAA,IAAK;EAAA;;EAClB,QAAMkP,IAAI,WAAG,oDAASlP,IAAT,EAAH,QAAV,CADkB;EAGlB;EACA;EAEA;;;EAGA,UAAKwS,MAAL;;EACA,WAAOtD,IAAP;EACD;;WACDsD,SAAA,kBAAQ;;WACRL,YAAA,qBAAW;;WACXE,aAAA,sBAAY;;;qBArEUI;;ECSxB3R,IAAI,CAACC,OAAL,GAAeA,OAAf;EACAD,IAAI,CAACE,UAAL,GAAkBA,UAAlB;EACAF,IAAI,CAACI,QAAL,CAAc,GAAd,IAAqB2O,OAArB;EACA/O,IAAI,CAACoQ,SAAL,GAAiBA,SAAjB;EAGA;;EACApQ,IAAI,CAAC2H,IAAL,GAAY,UAACiK,GAAD,EAAM1Q,MAAN,EAAcmB,OAAd,EAA4B;EACtC;EACAuP,EAAAA,GAAG,GAAGA,GAAG,IAAI,YAAb;EACA,MAAIlQ,EAAE,GAAIkQ,GAAG,CAAC1I,QAAJ,IAAgB0I,GAAG,CAAC1I,QAAJ,GAAe,CAAhC,GAAqC0I,GAArC,GAA2CxI,QAAQ,CAACyI,aAAT,CAAuBD,GAAvB,CAApD;EACA5R,EAAAA,IAAI,CAAC8R,WAAL,CAAiBpQ,EAAjB,EAJsC;;EAOtCA,EAAAA,EAAE,GAAIkQ,GAAG,CAAC1I,QAAJ,IAAgB0I,GAAG,CAAC1I,QAAJ,GAAe,CAAhC,GAAqC0I,GAArC,GAA2CxI,QAAQ,CAACyI,aAAT,CAAuBD,GAAvB,CAAhD;EAGA,MAAIG,WAAW,GAAG,EAAlB;EACA7Q,EAAAA,MAAM,GAAGA,MAAM,IAAI,EAAnB;EACAmB,EAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;EAEA/F,EAAAA,UAAU,CAAC8C,OAAX,CAAmB,UAAA4S,aAAa,EAAI;EAClCD,IAAAA,WAAW,CAACC,aAAD,CAAX,GAA6B1P,MAAM,CAAC2P,MAAP,CAAc,IAAd,CAA7B;;EAEA,QAAI5P,OAAO,CAAC2P,aAAD,CAAX,EAA4B;EAC1B1P,MAAAA,MAAM,CAACC,IAAP,CAAYF,OAAO,CAAC2P,aAAD,CAAnB,EAAoC5S,OAApC,CAA4C,UAAAqD,GAAG,EAAI;EACjDsP,QAAAA,WAAW,CAACC,aAAD,CAAX,CAA2BvP,GAA3B,IAAkCJ,OAAO,CAAC2P,aAAD,CAAP,CAAuBvP,GAAvB,CAAlC;EACD,OAFD;EAGD;;EAEDH,IAAAA,MAAM,CAACC,IAAP,CAAYvC,IAAI,CAACgS,aAAD,CAAhB,EAAiC5S,OAAjC,CAAyC,UAAAqD,GAAG,EAAI;EAC9C,UAAI,CAACsP,WAAW,CAACC,aAAD,CAAX,CAA2BvP,GAA3B,CAAL,EAAsC;EACpCsP,QAAAA,WAAW,CAACC,aAAD,CAAX,CAA2BvP,GAA3B,IAAkCzC,IAAI,CAACgS,aAAD,CAAJ,CAAoBvP,GAApB,CAAlC;EACD;EACF,KAJD;EAKD,GAdD;;EAgBA,MAAGsP,WAAW,CAAC1V,KAAD,CAAd,EAAsB;EACpBiG,IAAAA,MAAM,CAACC,IAAP,CAAYwP,WAAW,CAAC1V,KAAD,CAAvB,EAAgC+C,OAAhC,CAAwC,UAAAqD,GAAG,EAAI;EAC7C,UAAId,IAAI,GAAGoQ,WAAW,CAAC1V,KAAD,CAAX,CAAmBoG,GAAnB,CAAX,CAD6C;;EAG7C,UAAGd,IAAI,CAAC4O,GAAL,IAAY,CAAC3O,cAAc,CAACC,GAAf,CAAmBF,IAAI,CAAC4O,GAAxB,CAAhB,EAA6C;EAC3C3O,QAAAA,cAAc,CAACsQ,MAAf,CAAsBvQ,IAAI,CAAC4O,GAA3B,EAAgC5O,IAAhC;EACD;EACF,KAND;EAOD;;EAEDvF,EAAAA,OAAO,CAACgD,OAAR,CAAgB,UAAAoD,MAAM,EAAI;EACxB,QAAIvF,KAAK,GAAGoF,OAAO,CAACG,MAAD,CAAnB;EACAuP,IAAAA,WAAW,CAACvP,MAAD,CAAX,GAAsBvF,KAAK,IAAI,IAAT,GAAgBA,KAAhB,GAAwB+C,IAAI,CAACwC,MAAD,CAAlD;EACD,GAHD;EAKAuP,EAAAA,WAAW,CAAC9G,UAAZ,GAAyB3I,MAAM,CAACC,IAAP,CAAYwP,WAAW,CAAC9R,OAAxB,EAAiCuI,MAAjC,CAAwC,UAAU/F,GAAV,EAAe;EAC9E,WAAOA,GAAG,CAACzE,OAAJ,CAAY,GAAZ,IAAmB,CAA1B;EACD,GAFwB,CAAzB;EAIAiF,EAAAA,QAAQ,CAACS,aAAT,CAAuBqO,WAAvB;EAEA,MAAI9Q,IAAI,GAAG,IAAImJ,IAAJ,CAAS1I,EAAT,EAAaR,MAAb,EAAqB6Q,WAArB,CAAX;EACA9Q,EAAAA,IAAI,CAAC0G,IAAL;EACA,SAAO1G,IAAP;EACD,CAtDD;EAyDA;;;EACAjB,IAAI,CAACmS,IAAL,GAAY,UAACC,SAAD,EAAY1Q,EAAZ,EAAgBmH,IAAhB,EAA8B;EAAA,MAAdA,IAAc;EAAdA,IAAAA,IAAc,GAAP,EAAO;EAAA;;EACxC,MAAInH,EAAE,IAAI,IAAV,EAAgB;EAAEA,IAAAA,EAAE,GAAG0H,QAAQ,CAACqH,aAAT,CAAuB,KAAvB,CAAL;EAAqC;;EACvD2B,EAAAA,SAAS,GAAGpS,IAAI,CAACG,UAAL,CAAgBiS,SAAhB,CAAZ;EACA,MAAI5U,QAAQ,GAAG4U,SAAS,CAAC5U,QAAV,CAAmB8D,IAAnB,CAAwBtB,IAAxB,EAA8B0B,EAA9B,CAAf;;EACA,MAAIlE,QAAQ,YAAYmU,WAAxB,EAAqC;EACnC,WAAOjQ,EAAE,CAACyP,UAAV,EAAsB;EACpBzP,MAAAA,EAAE,CAAC+H,WAAH,CAAe/H,EAAE,CAACyP,UAAlB;EACD;;EACDzP,IAAAA,EAAE,CAAC0P,WAAH,CAAe5T,QAAf;EACD,GALD,MAKO;EACLkE,IAAAA,EAAE,CAACuM,SAAH,GAAezQ,QAAf;EACD;;EACD,MAAM6U,KAAK,GAAGD,SAAS,CAACE,UAAV,CAAqBhR,IAArB,CAA0BtB,IAA1B,EAAgC0B,EAAhC,EAAoCmH,IAApC,CAAd;EAEA,MAAI5H,IAAI,GAAG,IAAImJ,IAAJ,CAAS1I,EAAT,EAAa2Q,KAAb,CAAX;EACApR,EAAAA,IAAI,CAAC0G,IAAL;EACA,SAAO1G,IAAP;EACD,CAjBD;;EAoBAjB,IAAI,CAACE,UAAL,CAAgB2O,MAAhB,GAAyB7O,IAAI,CAACE,UAAL,CAAgB0O,GAAhB,GAAsB,UAAC3R,KAAD,EAAW;EACxD,SAAO,CAACA,KAAR;EACD,CAFD;;EAIA+C,IAAI,CAACE,UAAL,CAAgBoB,IAAhB,GAAuB,UAACrE,KAAD,EAAoB;EAAA,oCAATiC,IAAS;EAATA,IAAAA,IAAS;EAAA;;EACzC,MAAG,CAACA,IAAI,CAACvB,MAAT,EAAiB;EAAC;EAAQ;;EAC1B,MAAI0D,EAAE,GAAGnC,IAAI,CAAC,CAAD,CAAb;EACAA,EAAAA,IAAI,GAAG0F,KAAK,CAACX,SAAN,CAAgB9G,KAAhB,CAAsBmE,IAAtB,CAA2BpC,IAA3B,EAAiC,CAAjC,CAAP,CAHyC;;EAKzC,SAAOmC,EAAE,CAACC,IAAH,OAAAD,EAAE,GAAMpE,KAAN,SAAgBiC,IAAhB,EAAT;EACA;;;;;EAKD,CAXD;;EAaAc,IAAI,CAACuS,QAAL,GAAgB,UAAC7Q,EAAD,EAAK8Q,IAAL,EAAc;EAC5B;EACA,MAAI;EACF,QAAIC,KAAK,GAAG,IAAIC,cAAJ,EAAZ;;EACAD,IAAAA,KAAK,CAACE,kBAAN,GAA2B,YAAW;EACpC,UAAI,KAAKC,UAAL,IAAmB,CAAvB,EAA0B;EACxB,YAAI,KAAKC,MAAL,IAAe,GAAnB,EAAwB;EACtB;EACA,cAAGnR,EAAE,CAAC4M,OAAH,KAAe,QAAlB,EAA2B;EACzB;EACA5M,YAAAA,EAAE,CAACoR,SAAH,GAAe,KAAKC,YAApB,CAFyB;EAIzB;EACD,WALD,MAKO;EACLrR,YAAAA,EAAE,CAACS,eAAH,CAAmB,OAAnB;EACAT,YAAAA,EAAE,CAACuM,SAAH,GAAe,KAAK8E,YAApB;EACA/S,YAAAA,IAAI,CAAC8R,WAAL,CAAiBpQ,EAAjB;EACD;EACF,SAZD,MAaK,IAAI,KAAKmR,MAAL,IAAe,GAAnB,EAAwB;EAACnR,UAAAA,EAAE,CAACuM,SAAH,GAAe,UAAU,KAAK+E,WAAf,GAA6B,iBAA5C;EAA+D,SAAxF,MACA;EAACtR,UAAAA,EAAE,CAACuM,SAAH,GAAe,UAAU,KAAK8E,YAAf,GAA8B,MAA7C;EAAqD;EAC5D;EACF,KAlBD;;EAmBAN,IAAAA,KAAK,CAAC3U,IAAN,CAAW,KAAX,EAAkB0U,IAAlB,EAAwB,KAAxB;EACAC,IAAAA,KAAK,CAACQ,IAAN;EACD,GAvBD,CAuBE,OAAO3T,CAAP,EAAU;EACVoC,IAAAA,EAAE,CAACuM,SAAH,GAAe,sCAAf;EACD;EACF,CA5BD;;;EA+BAjO,IAAI,CAAC8R,WAAL,GAAmB,UAACpQ,EAAD,EAAQ;EACzB,MAAIwR,CAAJ,EAAOrP,CAAP,EAAUsP,KAAV,EAAiBX,IAAjB;;EACA,MAAG,CAAC9Q,EAAE,CAAC0R,oBAAP,EAA4B;EAC1B,QAAG1R,EAAE,CAAC2R,QAAH,CAAY1V,MAAf,EAAsB;EACpBuV,MAAAA,CAAC,GAAGxR,EAAE,CAAC2R,QAAP;EACD,KAFD,MAEO;EACL;EACD;EACF,GAND,MAMM;EACJ;EACAH,IAAAA,CAAC,GAAIxR,EAAE,CAAC0R,oBAAH,CAAwB,GAAxB,CAAL;EACD;;EAED,OAAKvP,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGqP,CAAC,CAACvV,MAAlB,EAA0BkG,CAAC,EAA3B,EAA+B;EAC7BsP,IAAAA,KAAK,GAAGD,CAAC,CAACrP,CAAD,CAAT;EACA;;EACA2O,IAAAA,IAAI,GAAGW,KAAK,CAAC9F,YAAN,CAAmB,OAAnB,CAAP;;EACA,QAAImF,IAAJ,EAAU;EACRxS,MAAAA,IAAI,CAACuS,QAAL,CAAcY,KAAd,EAAqBX,IAArB;EACD;EACF;EACF,CArBD;;;;;;;;"}